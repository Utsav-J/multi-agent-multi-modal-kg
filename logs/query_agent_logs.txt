2025-12-18 16:56:13,969 - __main__ - INFO - Initializing resources...
2025-12-18 16:56:13,970 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-18 16:56:13,972 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-18 16:56:13,972 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-18 16:56:20,440 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-18 16:56:20,441 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-18 16:56:20,447 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-18 16:56:20,474 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-18 16:56:20,486 - __main__ - INFO - User query received: what is attention?
2025-12-18 16:56:20,487 - __main__ - INFO - Starting Query Agent with query: 'what is attention?'
2025-12-18 16:56:20,487 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-18 16:56:20,488 - __main__ - INFO - RAG Tool invoked with user query: what is attention?
2025-12-18 16:56:20,774 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-18 16:56:20,793 - __main__ - INFO - Generated 3 RAG subqueries:
2025-12-18 16:56:20,794 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-18 16:56:20,795 - __main__ - INFO -   Subquery 2: definition of attention in deep learning
2025-12-18 16:56:20,795 - __main__ - INFO -   Subquery 3: what is attention in neural networks
2025-12-18 16:56:20,796 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-18 16:56:20,957 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-18 16:56:20,957 - __main__ - INFO - RAG internal retrieval query: definition of attention in deep learning
2025-12-18 16:56:21,043 - __main__ - INFO - RAG retrieved 3 documents for subquery 'definition of attention in deep learning'
2025-12-18 16:56:21,043 - __main__ - INFO - RAG internal retrieval query: what is attention in neural networks
2025-12-18 16:56:21,136 - __main__ - INFO - RAG retrieved 3 documents for subquery 'what is attention in neural networks'
2025-12-18 16:56:21,136 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 7
2025-12-18 16:56:21,136 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-18 16:56:21,136 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-18 16:56:21,136 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-18 16:56:21,136 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-18 16:56:21,137 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_5
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-18 16:56:21,137 - __main__ - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-18 16:56:21,137 - __main__ - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-18 16:56:21,137 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=47824
2025-12-18 16:56:21,137 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-18 16:56:21,138 - __main__ - INFO - Graph Tool invoked with user query: what is attention?
2025-12-18 16:56:21,138 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-18 16:56:23,321 - __main__ - INFO - Resolving entities from graph for query: what is attention?
2025-12-18 16:56:23,519 - __main__ - WARNING - No matching entities found.
2025-12-18 16:56:23,521 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-18 16:56:33,528 - __main__ - INFO - Final Answer: Attention is a mechanism that allows models to focus on the most relevant observations within sequential data, thereby improving representation learning. It addresses limitations of traditional recurrent neural networks (RNNs), such as vanishing gradients and difficulties with irregularly sampled data, by treating all time steps equally.

Fundamentally, an attention function maps a query and a set of key-value pairs to an output. This output is calculated as a weighted sum of the values, where the weight assigned to each value is determined by a compatibility function between the query and its corresponding key.

Key types and concepts of attention include:

*   **Scaled Dot-Product Attention:** This common form computes the dot products of queries with all keys, scales them by the key dimension, and then applies a softmax function to obtain the weights for the values. The formula is `Attention(Q, K, V) = softmax(QK^T / sqrt(dk))V`.
*   **Multi-Head Attention (MHA):** This extends single attention by allowing the model to attend to different representation subspaces in parallel. It achieves this by linearly projecting queries, keys, and values multiple times, performing attention functions in parallel on these projected versions, concatenating the outputs, and then projecting them again.
*   **Self-Attention:** In this variant, all queries, keys, and values originate from the same source (e.g., the output of a previous layer), enabling each position in a sequence to attend to all other positions within that sequence.
*   **Continuous-time Attention (CTA) and Neuronal Attention Circuit (NAC):** These are more recent advancements that integrate continuous-time dynamics, often using Ordinary Differential Equations (ODEs), to model attention. NAC, for instance, computes attention logits as the solution to a first-order ODE, modulated by nonlinear, interlinked gates inspired by biological neuronal circuits.

Attention mechanisms are integral to models like the Transformer, and their individual "attention heads" have been shown to exhibit functional specialization in Large Language Models (LLMs) and Vision-Language Models (VLMs), performing tasks such as pattern induction, information retrieval, and visual grounding.
2025-12-20 19:34:37,885 - __main__ - INFO - Initializing resources...
2025-12-20 19:34:37,885 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:34:37,887 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:34:37,887 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:34:47,715 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:34:47,716 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:34:47,756 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:34:48,401 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:34:48,445 - __main__ - INFO - User query received: how does attention mechanism relate to multi head attention?
2025-12-20 19:34:48,445 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism relate to multi head attention?'
2025-12-20 19:34:48,445 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:34:48,446 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 19:34:49,309 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:34:49,344 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 19:34:49,345 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-20 19:34:49,345 - __main__ - INFO -   Subquery 2: multi-head attention
2025-12-20 19:34:49,345 - __main__ - INFO -   Subquery 3: attention mechanism vs multi-head attention
2025-12-20 19:34:49,346 - __main__ - INFO -   Subquery 4: transformer multi-head attention
2025-12-20 19:34:49,346 - __main__ - INFO -   Subquery 5: self-attention mechanism
2025-12-20 19:34:49,346 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-20 19:34:52,016 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-20 19:34:52,016 - __main__ - INFO - RAG internal retrieval query: multi-head attention
2025-12-20 19:34:52,090 - __main__ - INFO - RAG retrieved 3 documents for subquery 'multi-head attention'
2025-12-20 19:34:52,091 - __main__ - INFO - RAG internal retrieval query: attention mechanism vs multi-head attention
2025-12-20 19:34:52,166 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism vs multi-head attention'
2025-12-20 19:34:52,166 - __main__ - INFO - RAG internal retrieval query: transformer multi-head attention
2025-12-20 19:34:52,241 - __main__ - INFO - RAG retrieved 3 documents for subquery 'transformer multi-head attention'
2025-12-20 19:34:52,241 - __main__ - INFO - RAG internal retrieval query: self-attention mechanism
2025-12-20 19:34:52,313 - __main__ - INFO - RAG retrieved 3 documents for subquery 'self-attention mechanism'
2025-12-20 19:34:52,313 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 19:34:52,313 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:34:52,313 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:34:52,313 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:34:52,314 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:34:52,314 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:34:52,314 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:34:52,314 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:34:52,314 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:34:52,315 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=59688
2025-12-20 19:34:52,315 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:34:52,316 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 19:34:52,316 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:34:54,382 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism relate to multi head attention?
2025-12-20 19:34:54,606 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- None (Concept)
- None (Concept)
- None (Concept)
- None (Concept)
- None (Concept)
2025-12-20 19:34:54,608 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:35:03,945 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:35:03,945 - __main__ - INFO - None
2025-12-20 19:35:03,945 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 19:35:03,946 - __main__ - INFO - Graph context returned to LLM:
I don't know the answer.
2025-12-20 19:35:03,957 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:35:07,802 - __main__ - INFO - Final Answer: The attention mechanism is a core component that allows models to focus on the most relevant observations by computing the similarity between queries and keys. It treats all time steps equally and scales the similarity by the key dimension to maintain stable gradients.

Multi-Head Attention (MHA) is an extension of this fundamental attention mechanism. Instead of performing a single attention function, MHA linearly projects the queries, keys, and values multiple times (e.g., `h` times) into different, learned representation subspaces. It then performs the attention function on each of these projected versions in parallel, effectively running several attention layers simultaneously. The outputs from these parallel "heads" are concatenated and then projected again to produce the final values. This parallel processing allows the model to jointly attend to information from different representation subspaces at various positions, which a single attention head might inhibit due to averaging.
2025-12-20 19:39:11,933 - __main__ - INFO - Initializing resources...
2025-12-20 19:39:11,934 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:39:11,936 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:39:11,936 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:39:18,613 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:39:18,613 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:39:18,619 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:39:18,642 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:39:18,652 - __main__ - INFO - User query received: how does attention mechanism relate to multi head attention?
2025-12-20 19:39:18,653 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism relate to multi head attention?'
2025-12-20 19:39:18,653 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:39:18,654 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 19:39:18,972 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:39:19,008 - __main__ - INFO - Generated 3 RAG subqueries:
2025-12-20 19:39:19,008 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-20 19:39:19,009 - __main__ - INFO -   Subquery 2: multi-head attention
2025-12-20 19:39:19,009 - __main__ - INFO -   Subquery 3: relation between attention mechanism and multi-head attention
2025-12-20 19:39:19,009 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-20 19:39:19,129 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-20 19:39:19,130 - __main__ - INFO - RAG internal retrieval query: multi-head attention
2025-12-20 19:39:19,201 - __main__ - INFO - RAG retrieved 3 documents for subquery 'multi-head attention'
2025-12-20 19:39:19,201 - __main__ - INFO - RAG internal retrieval query: relation between attention mechanism and multi-head attention
2025-12-20 19:39:19,286 - __main__ - INFO - RAG retrieved 3 documents for subquery 'relation between attention mechanism and multi-head attention'
2025-12-20 19:39:19,287 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 5
2025-12-20 19:39:19,287 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:39:19,287 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:39:19,287 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:39:19,287 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:39:19,288 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:39:19,288 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=37882
2025-12-20 19:39:19,288 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:39:19,289 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 19:39:19,289 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:39:21,281 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism relate to multi head attention?
2025-12-20 19:39:21,472 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Multi-head attention (Concept)
- Multi-Head Attention (Concept)
- Masked Multi-Head Attention (Concept)
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
2025-12-20 19:39:21,473 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:39:26,724 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:39:26,724 - __main__ - INFO - cypher
MATCH (c1:Concept {id: "Attention mechanism"})-[r]->(c2:Concept)
WHERE c2.id IN ["Multi-head attention", "Multi-Head Attention"]
RETURN c1, r, c2
UNION ALL
MATCH (c1:Concept {id: "Multi-head attention"})-[r]->(c2:Concept {id: "Attention mechanism"})
RETURN c1, r, c2
UNION ALL
MATCH (c1:Concept {id: "Multi-Head Attention"})-[r]->(c2:Concept {id: "Attention mechanism"})
RETURN c1, r, c2

2025-12-20 19:39:26,725 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 19:39:26,725 - __main__ - INFO - Graph context returned to LLM:
I don't know the answer.
2025-12-20 19:39:26,726 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:39:30,868 - __main__ - INFO - Final Answer: The attention mechanism allows models to focus on the most relevant observations by computing the similarity between queries and keys. Multi-Head Attention (MHA) is an extension of this basic attention mechanism.

Specifically, Multi-Head Attention enhances the attention mechanism by:
1.  **Parallel Processing**: Instead of performing a single attention function, MHA linearly projects the queries, keys, and values multiple times (e.g., `h` times) into different, learned subspaces.
2.  **Multiple "Heads"**: It then performs the attention function in parallel on each of these projected versions, creating `h` "attention heads."
3.  **Concatenation and Projection**: The outputs from these parallel attention heads are concatenated and then linearly projected again to produce the final output.

This parallel processing allows the model to jointly attend to information from different representation subspaces and at different positions, which a single attention head might inhibit due to averaging. The total computational cost of MHA can be similar to single-head attention if the dimensions of each head are reduced proportionally.
2025-12-20 19:40:31,721 - __main__ - INFO - Initializing resources...
2025-12-20 19:40:31,722 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:40:31,724 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:40:31,724 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:40:38,179 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:40:38,179 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:40:38,186 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:40:38,210 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:40:38,220 - __main__ - INFO - User query received: how does attention mechanism help in anaphora resolution?
2025-12-20 19:40:38,221 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism help in anaphora resolution?'
2025-12-20 19:40:38,221 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:40:38,222 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:40:38,604 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:40:38,623 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 19:40:38,623 - __main__ - INFO -   Subquery 1: attention mechanism anaphora resolution
2025-12-20 19:40:38,624 - __main__ - INFO -   Subquery 2: anaphora resolution using attention in NLP
2025-12-20 19:40:38,624 - __main__ - INFO -   Subquery 3: role of attention in coreference resolution
2025-12-20 19:40:38,624 - __main__ - INFO -   Subquery 4: attention-based models for anaphora resolution
2025-12-20 19:40:38,624 - __main__ - INFO -   Subquery 5: coreference resolution with attention mechanisms
2025-12-20 19:40:38,624 - __main__ - INFO - RAG internal retrieval query: attention mechanism anaphora resolution
2025-12-20 19:40:38,750 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism anaphora resolution'
2025-12-20 19:40:38,750 - __main__ - INFO - RAG internal retrieval query: anaphora resolution using attention in NLP
2025-12-20 19:40:38,846 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution using attention in NLP'
2025-12-20 19:40:38,846 - __main__ - INFO - RAG internal retrieval query: role of attention in coreference resolution
2025-12-20 19:40:38,917 - __main__ - INFO - RAG retrieved 3 documents for subquery 'role of attention in coreference resolution'
2025-12-20 19:40:38,918 - __main__ - INFO - RAG internal retrieval query: attention-based models for anaphora resolution
2025-12-20 19:40:38,994 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based models for anaphora resolution'
2025-12-20 19:40:38,994 - __main__ - INFO - RAG internal retrieval query: coreference resolution with attention mechanisms
2025-12-20 19:40:39,070 - __main__ - INFO - RAG retrieved 3 documents for subquery 'coreference resolution with attention mechanisms'
2025-12-20 19:40:39,070 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 19:40:39,071 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:40:39,071 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:40:39,071 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:40:39,071 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_6
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:40:39,072 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:40:39,072 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:40:39,072 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:40:39,072 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:40:39,072 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=57739
2025-12-20 19:40:39,073 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:40:39,073 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:40:39,074 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:40:41,018 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:40:41,202 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- anaphora resolution (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 19:40:41,203 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:40:47,822 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:40:47,823 - __main__ - INFO - cypher
MATCH (c1:Concept {id: "Attention mechanism"})-[:ADDRESSES|MITIGATES]->(c2:Concept {id: "anaphora resolution"})
RETURN c1, c2

2025-12-20 19:40:47,824 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 19:40:47,825 - __main__ - INFO - Graph context returned to LLM:
I don't know the answer.
2025-12-20 19:40:47,828 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:40:55,080 - __main__ - INFO - Final Answer: While the provided text context does not explicitly mention "anaphora resolution," it details how attention mechanisms, particularly self-attention, offer capabilities that are highly beneficial for tasks requiring the identification of long-range dependencies and semantic relationships, which are crucial for anaphora resolution. The graph context does not provide an answer.

Based on the text, attention mechanisms help by:

1.  **Focusing on Relevant Observations:** Attention allows models to "focus on the most relevant observations," which in anaphora resolution would mean identifying potential antecedents for a given anaphor.
2.  **Modeling Long-Range Dependencies:** Attention mechanisms "model dependencies without regard to their distance in the input or output sequences." This is a critical advantage for anaphora resolution, as anaphors and their antecedents can be far apart in a text. Self-attention, in particular, connects all positions with a constant number of sequential operations, making it "easier to learn long-range dependencies" compared to recurrent layers.
3.  **Understanding Syntactic and Semantic Structure:** Attention heads have been observed to "exhibit behavior related to the syntactic and semantic structure of the sentences," which is fundamental for correctly linking pronouns or other anaphors to their referents.
4.  **Applications in Related Tasks:** Self-attention has been successfully applied in tasks like reading comprehension and textual entailment, which often involve resolving references and understanding relationships between different parts of a text. An example provided shows attention heads attending to "a distant dependency of the verb ‘making’," illustrating its ability to connect related words across a sentence.

In essence, attention mechanisms provide the ability to efficiently identify and weigh the importance of different words in a sequence, regardless of their position, thereby enabling the model to effectively link anaphors to their antecedents by capturing the necessary long-range syntactic and semantic relationships.
2025-12-20 19:45:40,088 - __main__ - INFO - Initializing resources...
2025-12-20 19:45:40,088 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:45:40,090 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:45:40,090 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:45:46,565 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:45:46,566 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:45:46,569 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:45:46,594 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:45:46,607 - __main__ - INFO - User query received: how does attention mechanism help in anaphora resolution?
2025-12-20 19:45:46,607 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism help in anaphora resolution?'
2025-12-20 19:45:46,607 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:45:46,608 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:45:47,687 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:45:47,712 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 19:45:47,712 - __main__ - INFO -   Subquery 1: attention mechanism anaphora resolution
2025-12-20 19:45:47,712 - __main__ - INFO -   Subquery 2: anaphora resolution with attention in NLP
2025-12-20 19:45:47,712 - __main__ - INFO -   Subquery 3: role of attention in coreference resolution
2025-12-20 19:45:47,712 - __main__ - INFO -   Subquery 4: attention-based models for anaphora resolution
2025-12-20 19:45:47,712 - __main__ - INFO -   Subquery 5: coreference resolution using attention mechanisms
2025-12-20 19:45:47,712 - __main__ - INFO - RAG internal retrieval query: attention mechanism anaphora resolution
2025-12-20 19:45:47,855 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism anaphora resolution'
2025-12-20 19:45:47,855 - __main__ - INFO - RAG internal retrieval query: anaphora resolution with attention in NLP
2025-12-20 19:45:47,946 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution with attention in NLP'
2025-12-20 19:45:47,946 - __main__ - INFO - RAG internal retrieval query: role of attention in coreference resolution
2025-12-20 19:45:48,043 - __main__ - INFO - RAG retrieved 3 documents for subquery 'role of attention in coreference resolution'
2025-12-20 19:45:48,043 - __main__ - INFO - RAG internal retrieval query: attention-based models for anaphora resolution
2025-12-20 19:45:48,154 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based models for anaphora resolution'
2025-12-20 19:45:48,154 - __main__ - INFO - RAG internal retrieval query: coreference resolution using attention mechanisms
2025-12-20 19:45:48,237 - __main__ - INFO - RAG retrieved 3 documents for subquery 'coreference resolution using attention mechanisms'
2025-12-20 19:45:48,237 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_6
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:45:48,237 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=57739
2025-12-20 19:45:48,237 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:45:48,238 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:45:48,238 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:45:50,177 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:45:50,377 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- anaphora resolution (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 19:45:50,377 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:45:57,034 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:45:57,035 - __main__ - INFO - cypher
MATCH (c1:Concept {id: "Attention mechanism"})-[:ADDRESSES|MITIGATES]->(c2:Concept {id: "anaphora resolution"})
RETURN c1, c2

2025-12-20 19:45:57,035 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 19:45:57,035 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 19:45:57,598 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Statement.CartesianProduct} {category: PERFORMANCE} {title: This query builds a cartesian product between disconnected patterns.} {description: If a part of a query contains multiple disconnected patterns, this will build a cartesian product between all those parts. This may produce a large amount of data and slow down query processing. While occasionally intended, it may often be possible to reformulate the query that avoids the use of this cross product, perhaps by adding a relationship between the different parts or by using OPTIONAL MATCH (identifier is: (b))} {position: line: 2, column: 21, offset: 21} for query: '\n                    MATCH (a:Concept {id:$a}), (b:Concept {id:$b})\n                    MATCH p = shortestPath((a)-[*..4]-(b))\n                    RETURN p\n                    LIMIT 5\n                    '
2025-12-20 19:45:57,874 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Co-mention via Document evidence:
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_type': 'chunk', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_index': '0', 'markdown_source': None}
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_type': 'markdown', 'chunk_file': None, 'chunk_id': None, 'chunk_index': None, 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}

Shortest paths (<=4 hops):
{'p': [{'id': 'Attention mechanism'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'c35df05545627694d3b4bbf52619a5da', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Self-attention mechanism'}]}

Neighborhood of Concept 'Attention mechanism':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'c35df05545627694d3b4bbf52619a5da'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '888d0bd62e26d30498c9f50b218a6001'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_12_0'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Transformer'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Encoder-decoder architectures'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'Active memory'}
{'rel': 'EXTENDS', 'n_labels': ['Model'], 'n_id': 'Transformer'}
2025-12-20 19:45:57,875 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:46:06,190 - __main__ - INFO - Final Answer: While neither the provided text nor graph context explicitly mentions "anaphora resolution," the text offers strong indirect evidence for how attention mechanisms would be beneficial for this task.

Anaphora resolution requires identifying the relationship between a pronoun or noun phrase and its antecedent, which often involves understanding long-range dependencies and the syntactic and semantic structure of sentences. The text highlights that attention mechanisms:

1.  **Capture Long-Range Dependencies:** Attention mechanisms "mitigate this limitation by treating all time steps equally and allowing models to focus on the most relevant observations," and are effective at "capturing long-term dependencies" and "long-range dependencies." This is crucial for linking an anaphor to an antecedent that might appear much earlier in a text.
2.  **Understand Syntactic and Semantic Structure:** Attention heads "clearly learn to perform different tasks, many appear to exhibit behavior related to the syntactic and semantic structure of the sentences." This ability to discern grammatical and meaning-based relationships is fundamental for correctly resolving anaphora.
3.  **Focus on Relevant Information:** Attention allows models to "focus on the most relevant observations," which would enable a model to identify the correct antecedent among many potential candidates.
4.  **Success in Related Tasks:** Self-attention has been successfully applied in tasks like "reading comprehension" and "textual entailment," which often implicitly involve anaphora resolution to understand the full meaning of a text.

In summary, attention mechanisms help by enabling models to effectively identify and link words across long distances within a sequence, understand the underlying grammatical and semantic relationships, and focus on the most pertinent information, all of which are critical for accurate anaphora resolution. The graph context confirms the existence of "Attention mechanism" and its relation to "Self-attention mechanism" and "Transformer" models, which are known to leverage these capabilities.
2025-12-20 19:46:59,170 - __main__ - INFO - Initializing resources...
2025-12-20 19:46:59,170 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:46:59,172 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:46:59,172 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:47:05,572 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:47:05,573 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:47:05,578 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:47:05,605 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:47:05,616 - __main__ - INFO - User query received: how does attention mechanism help in anaphora resolution?
2025-12-20 19:47:05,617 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism help in anaphora resolution?'
2025-12-20 19:47:05,617 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:47:05,617 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:47:05,942 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:47:05,963 - __main__ - INFO - Generated 4 RAG subqueries:
2025-12-20 19:47:05,964 - __main__ - INFO -   Subquery 1: attention mechanism anaphora resolution
2025-12-20 19:47:05,964 - __main__ - INFO -   Subquery 2: anaphora resolution using attention in NLP
2025-12-20 19:47:05,964 - __main__ - INFO -   Subquery 3: role of attention in coreference resolution
2025-12-20 19:47:05,964 - __main__ - INFO -   Subquery 4: attention-based models for anaphora resolution
2025-12-20 19:47:05,964 - __main__ - INFO - RAG internal retrieval query: attention mechanism anaphora resolution
2025-12-20 19:47:06,104 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism anaphora resolution'
2025-12-20 19:47:06,104 - __main__ - INFO - RAG internal retrieval query: anaphora resolution using attention in NLP
2025-12-20 19:47:06,185 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution using attention in NLP'
2025-12-20 19:47:06,185 - __main__ - INFO - RAG internal retrieval query: role of attention in coreference resolution
2025-12-20 19:47:06,270 - __main__ - INFO - RAG retrieved 3 documents for subquery 'role of attention in coreference resolution'
2025-12-20 19:47:06,270 - __main__ - INFO - RAG internal retrieval query: attention-based models for anaphora resolution
2025-12-20 19:47:06,348 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based models for anaphora resolution'
2025-12-20 19:47:06,348 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 19:47:06,348 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:47:06,348 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:47:06,348 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:47:06,348 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_6
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:47:06,348 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:47:06,349 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:47:06,349 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:47:06,349 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:47:06,349 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=57739
2025-12-20 19:47:06,349 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:47:06,350 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:47:06,350 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:47:10,659 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:47:10,864 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- anaphora resolution (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 19:47:10,865 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:47:18,166 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:47:18,166 - __main__ - INFO - MATCH (c1:Concept {id: 'Attention mechanism'})-[r:ADDRESSES|MITIGATES]->(c2:Concept {id: 'anaphora resolution'})
RETURN c1, r, c2
2025-12-20 19:47:18,166 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 19:47:18,166 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 19:47:18,997 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Co-mention via Document evidence:
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_type': 'chunk', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_index': '0', 'markdown_source': None}
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_type': 'markdown', 'chunk_file': None, 'chunk_id': None, 'chunk_index': None, 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}

Shortest paths (<=4 hops):
{'p': [{'id': 'Attention mechanism'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'c35df05545627694d3b4bbf52619a5da', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Self-attention mechanism'}]}

Neighborhood of Concept 'Attention mechanism':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'c35df05545627694d3b4bbf52619a5da'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '888d0bd62e26d30498c9f50b218a6001'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_12_0'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Transformer'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Encoder-decoder architectures'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'Active memory'}
{'rel': 'EXTENDS', 'n_labels': ['Model'], 'n_id': 'Transformer'}
2025-12-20 19:47:19,000 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:47:26,210 - __main__ - INFO - Final Answer: While neither the provided text nor graph context explicitly mentions "anaphora resolution," the text offers strong indirect evidence for how attention mechanisms would be beneficial for this task.

Anaphora resolution requires identifying the relationship between a pronoun or noun phrase and its antecedent, which often involves understanding long-range dependencies and the syntactic and semantic structure of sentences. The text highlights that attention mechanisms:

1.  **Capture Long-Range Dependencies:** Attention mechanisms "mitigate this limitation by treating all time steps equally and allowing models to focus on the most relevant observations," and are effective at "capturing long-term dependencies" and "long-range dependencies." This is crucial for linking an anaphor to an antecedent that might appear much earlier in a text.
2.  **Understand Syntactic and Semantic Structure:** Attention heads "clearly learn to perform different tasks, many appear to exhibit behavior related to the syntactic and semantic structure of the sentences." This ability to discern grammatical and meaning-based relationships is fundamental for correctly resolving anaphora.
3.  **Focus on Relevant Information:** Attention allows models to "focus on the most relevant observations," which would enable a model to identify the correct antecedent among many potential candidates.
4.  **Success in Related Tasks:** Self-attention has been successfully applied in tasks like "reading comprehension" and "textual entailment," which often implicitly involve anaphora resolution to understand the full meaning of a text.

In summary, attention mechanisms help by enabling models to effectively identify and link words across long distances within a sequence, understand the underlying grammatical and semantic relationships, and focus on the most pertinent information, all of which are critical for accurate anaphora resolution. The graph context confirms the existence of "Attention mechanism" and its relation to "Self-attention mechanism" and "Transformer" models, which are known to leverage these capabilities.
2025-12-20 19:48:15,008 - __main__ - INFO - Initializing resources...
2025-12-20 19:48:15,009 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:48:15,011 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:48:15,011 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:48:21,814 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:48:21,814 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:48:21,819 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:48:21,842 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:48:21,853 - __main__ - INFO - User query received: how does attention mechanism help in anaphora resolution?
2025-12-20 19:48:21,854 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism help in anaphora resolution?'
2025-12-20 19:48:21,854 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:48:21,854 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:48:22,213 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:48:22,237 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 19:48:22,238 - __main__ - INFO -   Subquery 1: attention mechanism anaphora resolution
2025-12-20 19:48:22,238 - __main__ - INFO -   Subquery 2: anaphora resolution using attention
2025-12-20 19:48:22,238 - __main__ - INFO -   Subquery 3: neural attention models for anaphora resolution
2025-12-20 19:48:22,238 - __main__ - INFO -   Subquery 4: role of attention in coreference resolution
2025-12-20 19:48:22,238 - __main__ - INFO -   Subquery 5: attention-based approaches for anaphora resolution
2025-12-20 19:48:22,238 - __main__ - INFO - RAG internal retrieval query: attention mechanism anaphora resolution
2025-12-20 19:48:22,375 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism anaphora resolution'
2025-12-20 19:48:22,375 - __main__ - INFO - RAG internal retrieval query: anaphora resolution using attention
2025-12-20 19:48:22,458 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution using attention'
2025-12-20 19:48:22,459 - __main__ - INFO - RAG internal retrieval query: neural attention models for anaphora resolution
2025-12-20 19:48:22,549 - __main__ - INFO - RAG retrieved 3 documents for subquery 'neural attention models for anaphora resolution'
2025-12-20 19:48:22,550 - __main__ - INFO - RAG internal retrieval query: role of attention in coreference resolution
2025-12-20 19:48:22,627 - __main__ - INFO - RAG retrieved 3 documents for subquery 'role of attention in coreference resolution'
2025-12-20 19:48:22,627 - __main__ - INFO - RAG internal retrieval query: attention-based approaches for anaphora resolution
2025-12-20 19:48:22,722 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based approaches for anaphora resolution'
2025-12-20 19:48:22,722 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 10
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 9:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG Unique Doc 10:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:48:22,723 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=10, total_chars=73320
2025-12-20 19:48:22,723 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:48:22,724 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:48:22,724 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:48:27,330 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:48:27,674 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- anaphora resolution (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 19:48:27,674 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:48:40,367 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:48:40,367 - __main__ - INFO - MATCH (c1:Concept {id: 'Attention mechanism'})-[r:ADDRESSES|MITIGATES]->(c2:Concept {id: 'anaphora resolution'})
RETURN c1, r, c2
2025-12-20 19:48:40,367 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 19:48:40,367 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 19:48:41,498 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Co-mention via Document evidence:
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_type': 'chunk', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_index': '0', 'markdown_source': None}
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_type': 'markdown', 'chunk_file': None, 'chunk_id': None, 'chunk_index': None, 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}

Shortest paths (<=4 hops):
{'p': [{'id': 'Attention mechanism'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'c35df05545627694d3b4bbf52619a5da', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Self-attention mechanism'}]}

Neighborhood of Concept 'Attention mechanism':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'c35df05545627694d3b4bbf52619a5da'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '888d0bd62e26d30498c9f50b218a6001'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_12_0'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Transformer'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Encoder-decoder architectures'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'Active memory'}
{'rel': 'EXTENDS', 'n_labels': ['Model'], 'n_id': 'Transformer'}
2025-12-20 19:48:41,499 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:48:48,622 - __main__ - INFO - Final Answer: While neither the provided text nor graph context explicitly mentions "anaphora resolution," the descriptions of how attention mechanisms function strongly suggest their utility for this task.

Attention mechanisms help in tasks like anaphora resolution by:

1.  **Capturing Long-Range Dependencies:** Attention mechanisms, particularly self-attention, allow models to "model dependencies without regard to their distance in the input or output sequences." This is crucial for anaphora resolution, as the antecedent of a pronoun or noun phrase can often be far from the anaphor in a text. Self-attention layers connect all positions with a constant number of sequentially executed operations, making it easier to learn these long-range dependencies compared to recurrent layers.
2.  **Focusing on Relevant Information:** Attention enables models to "focus on the most relevant observations" when processing a sequence. For anaphora resolution, this means the model can identify and weigh the importance of potential antecedents for a given anaphor, rather than being limited by sequential processing.
3.  **Understanding Syntactic and Semantic Structure:** The text notes that "individual attention heads clearly learn to perform different tasks, many appear to exhibit behavior related to the syntactic and semantic structure of the sentences." This ability to discern syntactic and semantic relationships is fundamental for correctly linking anaphors to their antecedents. Multi-Head Attention further enhances this by allowing the model to "jointly attend to information from different representation subspaces at different positions," which can capture various facets of the anaphor-antecedent relationship.
2025-12-20 19:50:06,966 - __main__ - INFO - Initializing resources...
2025-12-20 19:50:06,966 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:50:06,969 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:50:06,969 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:50:13,573 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:50:13,573 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:50:13,579 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:50:13,603 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:50:13,611 - __main__ - INFO - User query received: how does attention mechanism help in anaphora resolution?
2025-12-20 19:50:13,612 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism help in anaphora resolution?'
2025-12-20 19:50:13,612 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:50:13,612 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:50:14,029 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:50:14,055 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 19:50:14,056 - __main__ - INFO -   Subquery 1: attention mechanism anaphora resolution
2025-12-20 19:50:14,056 - __main__ - INFO -   Subquery 2: anaphora resolution using attention
2025-12-20 19:50:14,056 - __main__ - INFO -   Subquery 3: attention-based models for anaphora resolution
2025-12-20 19:50:14,056 - __main__ - INFO -   Subquery 4: role of attention in anaphora resolution
2025-12-20 19:50:14,056 - __main__ - INFO -   Subquery 5: anaphora resolution techniques with attention mechanism
2025-12-20 19:50:14,056 - __main__ - INFO - RAG internal retrieval query: attention mechanism anaphora resolution
2025-12-20 19:50:14,194 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism anaphora resolution'
2025-12-20 19:50:14,194 - __main__ - INFO - RAG internal retrieval query: anaphora resolution using attention
2025-12-20 19:50:14,278 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution using attention'
2025-12-20 19:50:14,278 - __main__ - INFO - RAG internal retrieval query: attention-based models for anaphora resolution
2025-12-20 19:50:14,360 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based models for anaphora resolution'
2025-12-20 19:50:14,361 - __main__ - INFO - RAG internal retrieval query: role of attention in anaphora resolution
2025-12-20 19:50:14,443 - __main__ - INFO - RAG retrieved 3 documents for subquery 'role of attention in anaphora resolution'
2025-12-20 19:50:14,443 - __main__ - INFO - RAG internal retrieval query: anaphora resolution techniques with attention mechanism
2025-12-20 19:50:14,539 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution techniques with attention mechanism'
2025-12-20 19:50:14,539 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 5
2025-12-20 19:50:14,539 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:50:14,539 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:50:14,539 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:50:14,539 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:50:14,539 - __main__ - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:50:14,539 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=37265
2025-12-20 19:50:14,539 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:50:14,540 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:50:14,540 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:50:20,873 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:50:22,296 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- anaphora resolution (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 19:50:24,771 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:50:44,173 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:50:44,174 - __main__ - INFO - MATCH (c1:Concept {id: "Attention mechanism"})
MATCH (c2:Concept {id: "anaphora resolution"})
MATCH (c1)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(c2)
RETURN d.id, d.text, d.source_type, d.source_id
LIMIT 10
2025-12-20 19:50:44,174 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[{'d.id': '36f927c2ec5951b1af0611a9728d214b', 'd.text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'd.source_type': 'markdown', 'd.source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}]
2025-12-20 19:50:44,175 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 19:50:47,951 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Co-mention via Document evidence:
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_type': 'chunk', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_index': '0', 'markdown_source': None}
{'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_type': 'markdown', 'chunk_file': None, 'chunk_id': None, 'chunk_index': None, 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}

Shortest paths (<=4 hops):
{'p': [{'id': 'Attention mechanism'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'c35df05545627694d3b4bbf52619a5da', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Self-attention mechanism'}]}

Neighborhood of Concept 'Attention mechanism':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'c35df05545627694d3b4bbf52619a5da'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '888d0bd62e26d30498c9f50b218a6001'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_12_0'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Transformer'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Encoder-decoder architectures'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'Active memory'}
{'rel': 'EXTENDS', 'n_labels': ['Model'], 'n_id': 'Transformer'}
2025-12-20 19:50:47,952 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:50:55,385 - __main__ - INFO - Final Answer: Neither the provided text nor the graph context directly discusses how attention mechanisms specifically help in anaphora resolution.

However, based on the general capabilities of attention mechanisms described in the text, we can infer their utility for such a task:

1.  **Modeling Long-Range Dependencies:** Anaphora resolution often requires linking a pronoun or anaphoric expression to an antecedent that may appear much earlier in a sentence or document. The text states that "attention mechanisms... allow modeling of dependencies without regard to their distance in the input or output sequences" and mitigate the limitations of recurrent neural networks in capturing "long-term dependencies." This ability to connect distant parts of a sequence is crucial for identifying the correct antecedent.
2.  **Focusing on Relevant Information:** Attention allows models to "focus on the most relevant observations." In anaphora resolution, this means the model can learn to weigh the importance of different words in the context when trying to resolve an anaphor, effectively highlighting potential antecedents.
3.  **Self-Attention for Contextual Understanding:** Self-attention layers, as used in the Transformer model (which builds on attention mechanisms according to the graph), enable "each position in the encoder [to] attend to all positions in the previous layer." This means that when processing a pronoun, the model can simultaneously consider all preceding words in the sequence to find its referent, without being limited by sequential processing.
4.  **Multi-Head Attention for Diverse Relationships:** Multi-Head Attention allows the model to "jointly attend to information from different representation subspaces at different positions." This could be beneficial for anaphora resolution by allowing the model to simultaneously consider various linguistic cues (e.g., grammatical agreement, semantic compatibility, syntactic roles) when determining the correct antecedent.

While anaphora resolution is not explicitly mentioned, the text notes that self-attention has been successfully applied in tasks like "reading comprehension" and "textual entailment," which often involve understanding coreference and dependencies within text.
2025-12-20 19:51:36,949 - __main__ - INFO - Initializing resources...
2025-12-20 19:51:36,949 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 19:51:36,952 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 19:51:36,952 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 19:51:43,826 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 19:51:43,826 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 19:51:43,831 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 19:51:43,853 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 19:51:43,862 - __main__ - INFO - User query received: how does attention mechanism help in anaphora resolution?
2025-12-20 19:51:43,862 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism help in anaphora resolution?'
2025-12-20 19:51:43,862 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 19:51:43,863 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:51:44,226 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 19:51:44,260 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 19:51:44,260 - __main__ - INFO -   Subquery 1: attention mechanism anaphora resolution
2025-12-20 19:51:44,260 - __main__ - INFO -   Subquery 2: anaphora resolution using attention in NLP
2025-12-20 19:51:44,261 - __main__ - INFO -   Subquery 3: role of attention in coreference resolution
2025-12-20 19:51:44,261 - __main__ - INFO -   Subquery 4: attention-based models for anaphora resolution
2025-12-20 19:51:44,261 - __main__ - INFO -   Subquery 5: coreference resolution with attention mechanisms
2025-12-20 19:51:44,261 - __main__ - INFO - RAG internal retrieval query: attention mechanism anaphora resolution
2025-12-20 19:51:44,410 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism anaphora resolution'
2025-12-20 19:51:44,410 - __main__ - INFO - RAG internal retrieval query: anaphora resolution using attention in NLP
2025-12-20 19:51:44,504 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution using attention in NLP'
2025-12-20 19:51:44,505 - __main__ - INFO - RAG internal retrieval query: role of attention in coreference resolution
2025-12-20 19:51:44,587 - __main__ - INFO - RAG retrieved 3 documents for subquery 'role of attention in coreference resolution'
2025-12-20 19:51:44,587 - __main__ - INFO - RAG internal retrieval query: attention-based models for anaphora resolution
2025-12-20 19:51:44,667 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based models for anaphora resolution'
2025-12-20 19:51:44,667 - __main__ - INFO - RAG internal retrieval query: coreference resolution with attention mechanisms
2025-12-20 19:51:44,749 - __main__ - INFO - RAG retrieved 3 documents for subquery 'coreference resolution with attention mechanisms'
2025-12-20 19:51:44,749 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 19:51:44,749 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 19:51:44,749 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:51:44,749 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:51:44,749 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_6
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:51:44,750 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 19:51:44,750 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:51:44,750 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:51:44,750 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 19:51:44,750 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=57739
2025-12-20 19:51:44,750 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 19:51:44,750 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:51:44,750 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 19:51:46,765 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism help in anaphora resolution?
2025-12-20 19:51:46,945 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- anaphora resolution (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 19:51:47,121 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 19:52:04,520 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 19:52:04,520 - __main__ - INFO - MATCH (c1:Concept {id: "Attention mechanism"})
MATCH (c2:Concept {id: "anaphora resolution"})
MATCH (c1)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(c2)
RETURN d.id, d.text, d.source_type, d.source_id
LIMIT 10
2025-12-20 19:52:04,521 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[{'d.id': '36f927c2ec5951b1af0611a9728d214b', 'd.text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'd.source_type': 'markdown', 'd.source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}]
2025-12-20 19:52:04,521 - __main__ - INFO - Graph context returned to LLM:
Raw graph rows:
{'d.id': '36f927c2ec5951b1af0611a9728d214b', 'd.text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'd.source_type': 'markdown', 'd.source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}
2025-12-20 19:52:04,522 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 19:52:11,230 - __main__ - INFO - Final Answer: The attention mechanism, particularly self-attention, significantly aids in anaphora resolution by:

1.  **Modeling Long-Range Dependencies:** Attention allows models to capture dependencies between words regardless of their distance in a sequence. This is crucial for anaphora resolution, as pronouns (anaphors) and their antecedents can be far apart in a text. By treating all time steps equally, attention enables the model to focus on the most relevant observations for resolving these distant relationships.
2.  **Shortening Path Lengths:** Self-attention connects all positions in a sequence with a constant number of sequential operations. This reduces the path length between any two input and output positions, making it easier for the network to learn long-range dependencies, which is essential for linking anaphors to their correct antecedents.
3.  **Learning Syntactic and Semantic Structure:** Individual attention heads can learn to perform different tasks and exhibit behavior related to the syntactic and semantic structure of sentences. This specialization helps in identifying the grammatical and meaningful connections between anaphors and their antecedents.
4.  **Application in Reading Comprehension:** Self-attention has been successfully applied in tasks like reading comprehension, which inherently requires effective anaphora resolution to understand the text.

The graph context primarily points to the source document "attention_is_all_you_need_raw_with_image_ids_with_captions.md" but does not provide additional details on anaphora resolution.
2025-12-20 22:15:04,883 - __main__ - INFO - Initializing resources...
2025-12-20 22:15:04,884 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:15:04,912 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:15:04,912 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:15:16,637 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:15:16,638 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:15:16,687 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:15:17,817 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:15:18,014 - __main__ - INFO - User query received: show me images related to attention mechanism
2025-12-20 22:15:18,015 - __main__ - INFO - Starting Query Agent with query: 'show me images related to attention mechanism'
2025-12-20 22:15:18,015 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:15:18,027 - __main__ - INFO - RAG Tool invoked with user query: show me images related to attention mechanism
2025-12-20 22:15:18,847 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:15:18,984 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 22:15:18,984 - __main__ - INFO -   Subquery 1: attention mechanism illustrations
2025-12-20 22:15:18,984 - __main__ - INFO -   Subquery 2: visual representations of attention mechanism
2025-12-20 22:15:18,984 - __main__ - INFO -   Subquery 3: attention mechanism diagrams
2025-12-20 22:15:18,984 - __main__ - INFO -   Subquery 4: images of attention mechanism in deep learning
2025-12-20 22:15:18,984 - __main__ - INFO -   Subquery 5: attention mechanism figures
2025-12-20 22:15:18,985 - __main__ - INFO - RAG internal retrieval query: attention mechanism illustrations
2025-12-20 22:15:22,426 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism illustrations'
2025-12-20 22:15:22,426 - __main__ - INFO - RAG internal retrieval query: visual representations of attention mechanism
2025-12-20 22:15:22,532 - __main__ - INFO - RAG retrieved 3 documents for subquery 'visual representations of attention mechanism'
2025-12-20 22:15:22,532 - __main__ - INFO - RAG internal retrieval query: attention mechanism diagrams
2025-12-20 22:15:22,630 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism diagrams'
2025-12-20 22:15:22,630 - __main__ - INFO - RAG internal retrieval query: images of attention mechanism in deep learning
2025-12-20 22:15:22,729 - __main__ - INFO - RAG retrieved 3 documents for subquery 'images of attention mechanism in deep learning'
2025-12-20 22:15:22,729 - __main__ - INFO - RAG internal retrieval query: attention mechanism figures
2025-12-20 22:15:22,823 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism figures'
2025-12-20 22:15:22,824 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 6
2025-12-20 22:15:22,824 - __main__ - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:15:22,824 - __main__ - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:15:22,824 - __main__ - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_15
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:15:22,824 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:15:22,824 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:15:22,824 - __main__ - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:15:22,824 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=40409
2025-12-20 22:15:22,824 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:15:22,825 - __main__ - INFO - Graph Tool invoked with user query: show me images related to attention mechanism
2025-12-20 22:15:22,825 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:15:25,026 - __main__ - INFO - Resolving entities from graph for query: show me images related to attention mechanism
2025-12-20 22:15:25,210 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- Sequence to sequence learning (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 22:15:25,379 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:15:29,961 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:15:29,962 - __main__ - INFO - MATCH (c:Concept {id:'Attention mechanism'})<-[:DEPICTS]-(i:Image) RETURN i.source_path LIMIT 10
2025-12-20 22:15:29,962 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[{'i.source_path': 'E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png'}]
2025-12-20 22:15:30,163 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: path)} {position: line: 13, column: 45, offset: 539} for query: '\n                UNWIND $concept_ids AS cid\n                MATCH (c:Concept {id: cid})\n                OPTIONAL MATCH (i1:Image)-[:DEPICTS]->(c)\n                OPTIONAL MATCH (c)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(i2:Image)\n                WITH cid,\n                     collect(DISTINCT i1) + collect(DISTINCT i2) AS imgs\n                UNWIND imgs AS i\n                WITH cid, i\n                WHERE i IS NOT NULL\n                RETURN DISTINCT\n                  i.id AS image_id,\n                  coalesce(i.source_path, i.path) AS image_path,\n                  cid AS related_concept\n                LIMIT $limit\n                '
2025-12-20 22:15:30,236 - __main__ - INFO - Graph context returned to LLM:
Raw graph rows:
{'i.source_path': 'E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png'}

Images (from graph):
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Self-attention mechanism
2025-12-20 22:15:30,250 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:15:39,980 - __main__ - INFO - Final Answer: The following images are related to the attention mechanism:

**Image paths:**
- img_attention_is_all_you_need_12_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
- img_attention_is_all_you_need_2_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
- img_attention_is_all_you_need_3_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
- img_attention_is_all_you_need_3_1: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
- img_attention_is_all_you_need_13_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
- img_attention_is_all_you_need_14_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png
- img_attention_functional_roles_1_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png
- img_attention_functional_roles_1_1: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png
- img_attention_functional_roles_1_2: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png
- img_attention_functional_roles_1_3: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png
- img_attention_functional_roles_1_4: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png
- img_attention_functional_roles_1_5: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png
- img_attention_functional_roles_1_6: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png
- img_attention_functional_roles_1_7: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png
- img_attention_functional_roles_1_8: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png
- img_attention_functional_roles_1_11: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png
- img_neuronal_attention_circuits_15_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png
- img_neuronal_attention_circuits_15_1: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png

The text context describes some of these images:
*   **Figure 1** (e.g., `attention_is_all_you_need.pdf-2-0.png`) illustrates the Transformer model architecture, which uses stacked self-attention and point-wise, fully connected layers for both the encoder and decoder.
*   **Figure 2** (e.g., `attention_is_all_you_need.pdf-3-0.png`, `attention_is_all_you_need.pdf-3-1.png`) depicts Scaled Dot-Product Attention and Multi-Head Attention, showing how multiple attention layers run in parallel.
*   Another **Figure 1** (e.g., `attention_functional_roles.pdf-1-0.png` to `attention_functional_roles.pdf-1-11.png`) from a different source illustrates how the human brain engages multiple regions for distinct cognitive functions to answer complex questions, drawing an analogy to whether specific attention heads in large vision-language models play similar functional roles.
*   **Figure 5** (`neuronal_attention_circuits.pdf-15-0.png`) and **Figure 6** (`neuronal_attention_circuits.pdf-15-1.png`) present saliency maps for OpenAI CarRacing and Udacity Simulator, respectively, demonstrating the Neuronal Attention Circuit's (NAC) ability to maintain focus on relevant regions like the road's horizon.
2025-12-20 22:16:51,271 - __main__ - INFO - Initializing resources...
2025-12-20 22:16:51,271 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:16:51,274 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:16:51,274 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:16:58,800 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:16:58,801 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:16:58,813 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:16:58,893 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:16:58,933 - __main__ - INFO - User query received: show me images related to attention mechanism
2025-12-20 22:16:58,934 - __main__ - INFO - Starting Query Agent with query: 'show me images related to attention mechanism'
2025-12-20 22:16:58,934 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:16:58,936 - __main__ - INFO - RAG Tool invoked with user query: show me images related to attention mechanism
2025-12-20 22:16:59,350 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:16:59,415 - __main__ - INFO - Generated 3 RAG subqueries:
2025-12-20 22:16:59,416 - __main__ - INFO -   Subquery 1: attention mechanism illustrations
2025-12-20 22:16:59,416 - __main__ - INFO -   Subquery 2: visual representations of attention in deep learning
2025-12-20 22:16:59,416 - __main__ - INFO -   Subquery 3: attention mechanism diagrams
2025-12-20 22:16:59,417 - __main__ - INFO - RAG internal retrieval query: attention mechanism illustrations
2025-12-20 22:16:59,638 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism illustrations'
2025-12-20 22:16:59,639 - __main__ - INFO - RAG internal retrieval query: visual representations of attention in deep learning
2025-12-20 22:16:59,728 - __main__ - INFO - RAG retrieved 3 documents for subquery 'visual representations of attention in deep learning'
2025-12-20 22:16:59,729 - __main__ - INFO - RAG internal retrieval query: attention mechanism diagrams
2025-12-20 22:16:59,812 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism diagrams'
2025-12-20 22:16:59,812 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 5
2025-12-20 22:16:59,812 - __main__ - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:16:59,812 - __main__ - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:16:59,813 - __main__ - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_15
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:16:59,813 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:16:59,813 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:16:59,813 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=35721
2025-12-20 22:16:59,813 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:16:59,814 - __main__ - INFO - Graph Tool invoked with user query: show me images related to attention mechanism
2025-12-20 22:16:59,814 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:17:02,201 - __main__ - INFO - Resolving entities from graph for query: show me images related to attention mechanism
2025-12-20 22:17:02,415 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- Sequence to sequence learning (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 22:17:02,627 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:17:08,296 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:17:08,297 - __main__ - INFO - MATCH (c:Concept {id: "Attention mechanism"})<-[:DEPICTS]-(i:Image)
RETURN i.source_path AS image_path, i.id AS image_id
2025-12-20 22:17:08,297 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[{'image_path': 'E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png', 'image_id': 'img_attention_is_all_you_need_12_0'}]
2025-12-20 22:17:08,560 - __main__ - INFO - Graph context returned to LLM:
Raw graph rows:
{'image_path': 'E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png', 'image_id': 'img_attention_is_all_you_need_12_0'}

Images (from graph):
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Self-attention mechanism
2025-12-20 22:17:08,563 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:17:13,210 - __main__ - INFO - Final Answer: The graph context provides several images related to the attention mechanism and self-attention mechanism. The text context further explains these concepts, particularly detailing the Transformer architecture, Scaled Dot-Product Attention, and Multi-Head Attention.

The Transformer model architecture, as described in the text, utilizes stacked self-attention and point-wise, fully connected layers for both the encoder and decoder. An attention function maps a query and a set of key-value pairs to an output, computed as a weighted sum of values based on the compatibility of the query with corresponding keys. Specifically, "Scaled Dot-Product Attention" involves computing dot products of queries with keys, scaling by the square root of the key dimension, and applying a softmax function to get weights. "Multi-Head Attention" extends this by performing several attention functions in parallel on linearly projected versions of queries, keys, and values, allowing the model to attend to different representation subspaces.

**Image paths:**
*   img_attention_is_all_you_need_12_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
*   img_attention_is_all_you_need_2_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
*   img_attention_is_all_you_need_3_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
*   img_attention_is_all_you_need_3_1: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
*   img_attention_is_all_you_need_13_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
*   img_attention_is_all_you_need_14_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png
2025-12-20 22:31:54,067 - __main__ - INFO - Initializing resources...
2025-12-20 22:31:54,067 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:31:54,070 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:31:54,070 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:32:01,612 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:32:01,613 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:32:01,622 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:32:01,656 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:32:01,668 - __main__ - INFO - User query received: how does attention mechanism help in anaphora resolution?
2025-12-20 22:32:01,668 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism help in anaphora resolution?'
2025-12-20 22:32:01,668 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:32:01,669 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 22:32:02,051 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:32:02,107 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 22:32:02,108 - __main__ - INFO -   Subquery 1: attention mechanism anaphora resolution
2025-12-20 22:32:02,108 - __main__ - INFO -   Subquery 2: anaphora resolution using attention in NLP
2025-12-20 22:32:02,108 - __main__ - INFO -   Subquery 3: role of attention in coreference resolution
2025-12-20 22:32:02,108 - __main__ - INFO -   Subquery 4: attention-based models for anaphora resolution
2025-12-20 22:32:02,108 - __main__ - INFO -   Subquery 5: coreference resolution with attention mechanisms
2025-12-20 22:32:02,109 - __main__ - INFO - RAG internal retrieval query: attention mechanism anaphora resolution
2025-12-20 22:32:02,294 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism anaphora resolution'
2025-12-20 22:32:02,295 - __main__ - INFO - RAG internal retrieval query: anaphora resolution using attention in NLP
2025-12-20 22:32:02,419 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution using attention in NLP'
2025-12-20 22:32:02,419 - __main__ - INFO - RAG internal retrieval query: role of attention in coreference resolution
2025-12-20 22:32:02,523 - __main__ - INFO - RAG retrieved 3 documents for subquery 'role of attention in coreference resolution'
2025-12-20 22:32:02,523 - __main__ - INFO - RAG internal retrieval query: attention-based models for anaphora resolution
2025-12-20 22:32:02,617 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based models for anaphora resolution'
2025-12-20 22:32:02,617 - __main__ - INFO - RAG internal retrieval query: coreference resolution with attention mechanisms
2025-12-20 22:32:02,720 - __main__ - INFO - RAG retrieved 3 documents for subquery 'coreference resolution with attention mechanisms'
2025-12-20 22:32:02,720 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 22:32:02,720 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:32:02,721 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:32:02,721 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:32:02,721 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_6
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:32:02,721 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:32:02,721 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:32:02,721 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:32:02,721 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:32:02,722 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=57739
2025-12-20 22:32:02,722 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:32:02,722 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism help in anaphora resolution?
2025-12-20 22:32:02,723 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:32:04,832 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism help in anaphora resolution?
2025-12-20 22:32:05,014 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- anaphora resolution (Concept)
- Attention weights (Concept)
- Attention map (Concept)
2025-12-20 22:32:05,195 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:32:15,054 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:32:15,055 - __main__ - INFO - MATCH (attention:Concept {id:'Attention mechanism'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(anaphora:Concept {id:'anaphora resolution'})
RETURN d.id, d.text, d.source_type, d.source_id
LIMIT 10
2025-12-20 22:32:15,055 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[{'d.id': '36f927c2ec5951b1af0611a9728d214b', 'd.text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'd.source_type': 'markdown', 'd.source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}]
2025-12-20 22:32:15,389 - __main__ - INFO - Graph context returned to LLM:
Raw graph rows:
{'d.id': '36f927c2ec5951b1af0611a9728d214b', 'd.text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'd.source_type': 'markdown', 'd.source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}

Images (from graph):
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Self-attention mechanism
2025-12-20 22:32:15,390 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:32:23,544 - __main__ - INFO - Final Answer: Attention mechanisms, particularly self-attention, significantly aid in anaphora resolution by effectively capturing long-range dependencies within a sequence. Anaphora resolution requires identifying what a pronoun or noun phrase refers to, often necessitating connections between words that are far apart in a sentence or document.

Here's how attention mechanisms help:

1.  **Modeling Long-Range Dependencies:** Attention mechanisms allow models to focus on relevant observations and model dependencies between words regardless of their distance in the input or output sequences. This is a crucial advantage over traditional recurrent neural networks (RNNs) which struggle with long-term dependencies due to issues like vanishing gradients and their inherently sequential nature.
2.  **Shorter Path Lengths:** Self-attention layers connect all positions in a sequence with a constant number of sequentially executed operations. This results in shorter path lengths between any two input and output positions, making it easier for the model to learn and establish long-range dependencies, which is vital for linking an anaphor to its antecedent.
3.  **Understanding Syntactic and Semantic Structure:** Attention heads can learn to perform different tasks and exhibit behavior related to the syntactic and semantic structure of sentences. This ability to discern grammatical and meaning-based relationships is fundamental for correctly identifying the referent of an anaphor.
4.  **Interpretable Connections:** Visualizations of attention mechanisms demonstrate their ability to attend to distant dependencies, such as connecting a verb to a distant part of a phrase to complete its meaning. This capability to link semantically related but spatially separated words is directly applicable to resolving anaphora.

While the provided text does not explicitly name "anaphora resolution" as a task, it details the core functionalities of attention mechanisms—especially self-attention—that are directly beneficial for such a task, including handling long-range dependencies and understanding sentence structure.

**Image paths:**
*   img_attention_is_all_you_need_12_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
*   img_attention_is_all_you_need_2_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
*   img_attention_is_all_you_need_3_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
*   img_attention_is_all_you_need_3_1: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
*   img_attention_is_all_you_need_13_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
*   img_attention_is_all_you_need_14_0: E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png

**Chunks used:**
*   attention_is_all_you_need_raw_chunks_2k.jsonl
*   neuronal_attention_circuits_raw_chunks_2k.jsonl
*   attention_functional_roles_raw_chunks_2k.jsonl
2025-12-20 22:33:21,220 - __main__ - INFO - Initializing resources...
2025-12-20 22:33:21,221 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:33:21,224 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:33:21,224 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:33:28,422 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:33:28,423 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:33:28,428 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:33:28,469 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:33:28,490 - __main__ - INFO - User query received: how does attention mechanism relate to multi head attention?
2025-12-20 22:33:28,491 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism relate to multi head attention?'
2025-12-20 22:33:28,491 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:33:28,492 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:33:28,908 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:33:28,976 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 22:33:28,978 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-20 22:33:28,978 - __main__ - INFO -   Subquery 2: multi-head attention
2025-12-20 22:33:28,979 - __main__ - INFO -   Subquery 3: relation between attention mechanism and multi-head attention
2025-12-20 22:33:28,979 - __main__ - INFO -   Subquery 4: transformer multi-head attention
2025-12-20 22:33:28,979 - __main__ - INFO -   Subquery 5: self-attention mechanism
2025-12-20 22:33:28,980 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-20 22:33:29,238 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-20 22:33:29,238 - __main__ - INFO - RAG internal retrieval query: multi-head attention
2025-12-20 22:33:29,370 - __main__ - INFO - RAG retrieved 3 documents for subquery 'multi-head attention'
2025-12-20 22:33:29,371 - __main__ - INFO - RAG internal retrieval query: relation between attention mechanism and multi-head attention
2025-12-20 22:33:29,514 - __main__ - INFO - RAG retrieved 3 documents for subquery 'relation between attention mechanism and multi-head attention'
2025-12-20 22:33:29,514 - __main__ - INFO - RAG internal retrieval query: transformer multi-head attention
2025-12-20 22:33:29,663 - __main__ - INFO - RAG retrieved 3 documents for subquery 'transformer multi-head attention'
2025-12-20 22:33:29,663 - __main__ - INFO - RAG internal retrieval query: self-attention mechanism
2025-12-20 22:33:29,792 - __main__ - INFO - RAG retrieved 3 documents for subquery 'self-attention mechanism'
2025-12-20 22:33:29,792 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 22:33:29,792 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:33:29,792 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:33:29,792 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:33:29,792 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:33:29,792 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:33:29,793 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:33:29,793 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:33:29,793 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:33:29,793 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=59688
2025-12-20 22:33:29,793 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:33:29,794 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:33:29,794 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:33:31,759 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism relate to multi head attention?
2025-12-20 22:33:31,932 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Multi-head attention (Concept)
- Multi-Head Attention (Concept)
- Masked Multi-Head Attention (Concept)
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
2025-12-20 22:33:32,100 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:33:39,802 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:33:39,803 - __main__ - INFO - MATCH p = shortestPath((c1:Concept {id: "Attention mechanism"})-[*..4]-(c2:Concept {id: "Multi-head attention"}))
RETURN p
LIMIT 1
2025-12-20 22:33:39,803 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[{'p': [{'id': 'Attention mechanism'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-head attention'}]}]
2025-12-20 22:33:40,013 - __main__ - INFO - Graph context returned to LLM:
Raw graph rows:
{'p': [{'id': 'Attention mechanism'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-head attention'}]}

Images (from graph):
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-Head Attention
2025-12-20 22:33:40,015 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:33:48,445 - __main__ - INFO - Final Answer: The attention mechanism is a core component that allows models to focus on specific parts of an input sequence by computing the similarity between queries and keys to derive weights for values. The output of an attention function is a weighted sum of these values. A common type is Scaled Dot-Product Attention, which involves computing dot products of queries with all keys, scaling by the square root of the key dimension (`dk`), and applying a softmax function to obtain the weights.

Multi-Head Attention (MHA) is an extension of this fundamental attention mechanism. Instead of performing a single attention function, MHA linearly projects the queries, keys, and values multiple times (`h` times) using different, learned linear transformations. Each of these projected versions then undergoes an attention function in parallel, resulting in `dv`-dimensional output values from each "head". These outputs are subsequently concatenated and projected once more to produce the final result.

The primary benefit of Multi-Head Attention is that it enables the model to jointly attend to information from different representation subspaces and at different positions simultaneously. This parallel processing allows for a more comprehensive understanding of dependencies within the data, as a single attention head might otherwise average out important information. Research also suggests that these individual "attention heads" can exhibit functional specialization, performing distinct cognitive roles such as pattern induction, truthfulness, or visual grounding in models like Vision-Language Models (VLMs).

**Image paths:**
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png

**Chunks used:**
- attention_is_all_you_need_raw_chunks_2k.jsonl
- neuronal_attention_circuits_raw_chunks_2k.jsonl
- attention_functional_roles_raw_chunks_2k.jsonl
2025-12-20 22:35:34,579 - __main__ - INFO - Initializing resources...
2025-12-20 22:35:34,579 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:35:34,582 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:35:34,582 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:35:42,533 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:35:42,534 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:35:42,541 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:35:42,587 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:35:42,615 - __main__ - INFO - User query received: how does attention mechanism relate to multi head attention?
2025-12-20 22:35:42,615 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism relate to multi head attention?'
2025-12-20 22:35:42,616 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:35:42,618 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:35:43,135 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:35:43,222 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 22:35:43,222 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-20 22:35:43,223 - __main__ - INFO -   Subquery 2: multi-head attention
2025-12-20 22:35:43,223 - __main__ - INFO -   Subquery 3: relation between attention mechanism and multi-head attention
2025-12-20 22:35:43,223 - __main__ - INFO -   Subquery 4: self-attention and multi-head attention
2025-12-20 22:35:43,223 - __main__ - INFO -   Subquery 5: transformer attention mechanism
2025-12-20 22:35:43,224 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-20 22:35:43,440 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-20 22:35:43,440 - __main__ - INFO - RAG internal retrieval query: multi-head attention
2025-12-20 22:35:43,561 - __main__ - INFO - RAG retrieved 3 documents for subquery 'multi-head attention'
2025-12-20 22:35:43,561 - __main__ - INFO - RAG internal retrieval query: relation between attention mechanism and multi-head attention
2025-12-20 22:35:43,695 - __main__ - INFO - RAG retrieved 3 documents for subquery 'relation between attention mechanism and multi-head attention'
2025-12-20 22:35:43,695 - __main__ - INFO - RAG internal retrieval query: self-attention and multi-head attention
2025-12-20 22:35:43,820 - __main__ - INFO - RAG retrieved 3 documents for subquery 'self-attention and multi-head attention'
2025-12-20 22:35:43,821 - __main__ - INFO - RAG internal retrieval query: transformer attention mechanism
2025-12-20 22:35:43,938 - __main__ - INFO - RAG retrieved 3 documents for subquery 'transformer attention mechanism'
2025-12-20 22:35:43,938 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 7
2025-12-20 22:35:43,938 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:35:43,938 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:35:43,938 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:35:43,938 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:35:43,938 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:35:43,938 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:35:43,939 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:35:43,939 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=53380
2025-12-20 22:35:43,939 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:35:43,940 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:35:43,940 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:35:46,152 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism relate to multi head attention?
2025-12-20 22:35:46,368 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Multi-head attention (Concept)
- Multi-Head Attention (Concept)
- Masked Multi-Head Attention (Concept)
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
2025-12-20 22:35:46,576 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:35:52,107 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:35:52,107 - __main__ - INFO - MATCH (a:Concept {id:'Attention mechanism'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(b:Concept {id:'Multi-head attention'})
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2025-12-20 22:35:52,107 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 22:35:52,108 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 22:35:53,203 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Multi-head attention'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-Head Attention'}]}

Neighborhood of Concept 'Multi-head attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_3_1'}

Images (from graph):
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-Head Attention
2025-12-20 22:35:53,209 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:35:59,522 - __main__ - INFO - Final Answer: The attention mechanism allows models to focus on the most relevant observations by computing the similarity between queries (q) and keys (k). A specific type is "Scaled Dot-Product Attention," which calculates attention by taking the dot products of queries with all keys, scaling them, and applying a softmax function to get weights for the values.

Multi-Head Attention (MHA) is an extension of this fundamental attention mechanism. Instead of performing a single attention function, MHA linearly projects the queries, keys, and values multiple times (h times) using different, learned linear projections. An attention function is then performed in parallel on each of these projected versions, yielding multiple output values. These outputs are subsequently concatenated and projected once more to produce the final result.

The key relationship is that Multi-Head Attention enhances the basic attention mechanism by enabling the model to jointly attend to information from different representation subspaces at various positions simultaneously. This parallel processing helps overcome the limitation of a single attention head, where averaging might inhibit the model's ability to capture diverse aspects of the input.

**Image paths:**
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png
2025-12-20 22:37:32,477 - __main__ - INFO - Initializing resources...
2025-12-20 22:37:32,478 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:37:32,480 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:37:32,480 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:37:40,209 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:37:40,210 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:37:40,222 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:37:40,298 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:37:40,333 - __main__ - INFO - User query received: how does attention mechanism relate to multi head attention?
2025-12-20 22:37:40,335 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism relate to multi head attention?'
2025-12-20 22:37:40,336 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:37:40,338 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:37:40,895 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:37:40,967 - __main__ - INFO - Generated 5 RAG subqueries:
2025-12-20 22:37:40,969 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-20 22:37:40,969 - __main__ - INFO -   Subquery 2: multi-head attention
2025-12-20 22:37:40,969 - __main__ - INFO -   Subquery 3: relation between attention mechanism and multi-head attention
2025-12-20 22:37:40,970 - __main__ - INFO -   Subquery 4: transformer attention
2025-12-20 22:37:40,970 - __main__ - INFO -   Subquery 5: self-attention mechanism
2025-12-20 22:37:40,971 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-20 22:37:41,240 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-20 22:37:41,241 - __main__ - INFO - RAG internal retrieval query: multi-head attention
2025-12-20 22:37:41,334 - __main__ - INFO - RAG retrieved 3 documents for subquery 'multi-head attention'
2025-12-20 22:37:41,334 - __main__ - INFO - RAG internal retrieval query: relation between attention mechanism and multi-head attention
2025-12-20 22:37:41,439 - __main__ - INFO - RAG retrieved 3 documents for subquery 'relation between attention mechanism and multi-head attention'
2025-12-20 22:37:41,439 - __main__ - INFO - RAG internal retrieval query: transformer attention
2025-12-20 22:37:41,534 - __main__ - INFO - RAG retrieved 3 documents for subquery 'transformer attention'
2025-12-20 22:37:41,534 - __main__ - INFO - RAG internal retrieval query: self-attention mechanism
2025-12-20 22:37:41,631 - __main__ - INFO - RAG retrieved 3 documents for subquery 'self-attention mechanism'
2025-12-20 22:37:41,631 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-20 22:37:41,631 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:37:41,631 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:37:41,631 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:37:41,631 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:37:41,631 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:37:41,632 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:37:41,632 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:37:41,632 - __main__ - INFO - RAG Unique Doc 8:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:37:41,632 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=59688
2025-12-20 22:37:41,632 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:37:41,633 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:37:41,633 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:37:43,938 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism relate to multi head attention?
2025-12-20 22:37:44,159 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Multi-head attention (Concept)
- Multi-Head Attention (Concept)
- Masked Multi-Head Attention (Concept)
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
2025-12-20 22:37:44,376 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:37:50,071 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:37:50,072 - __main__ - INFO - MATCH (a:Concept {id:'Attention mechanism'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(b:Concept {id:'Multi-head attention'})
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2025-12-20 22:37:50,072 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 22:37:50,074 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 22:37:51,221 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Multi-head attention'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-Head Attention'}]}

Neighborhood of Concept 'Multi-head attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_3_1'}

Images (from graph):
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-Head Attention
2025-12-20 22:37:51,224 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:38:00,558 - __main__ - INFO - Final Answer: The attention mechanism is a core component in models like the Transformer, designed to allow the model to focus on the most relevant parts of the input sequence when processing data. It functions by mapping a query and a set of key-value pairs to an output. This output is a weighted sum of the values, where the weights are determined by a compatibility function between the query and each corresponding key. A common implementation is Scaled Dot-Product Attention, which computes dot products between queries and keys, scales them, and applies a softmax function to get the weights.

Multi-Head Attention (MHA) is an extension of this fundamental attention mechanism. Instead of performing a single attention function, MHA linearly projects the queries, keys, and values multiple times (e.g., `h` times) into different, learned representation subspaces. An attention function is then performed in parallel on each of these projected versions, yielding multiple output values (one from each "head"). These outputs are then concatenated and linearly projected again to produce the final result.

The relationship can be summarized as follows:
*   **Attention Mechanism (General):** The foundational concept that allows a model to weigh the importance of different parts of an input sequence relative to a query. It computes a single set of attention weights.
*   **Multi-Head Attention:** An enhancement that runs several attention mechanisms in parallel. This parallel processing enables the model to jointly attend to information from different representation subspaces and at different positions simultaneously. This helps to counteract the averaging effect that a single attention head might have, allowing for a richer and more diverse understanding of the input.

In models like the Transformer, Multi-Head Attention is crucial for capturing complex dependencies and is used in various ways, including self-attention layers within the encoder and decoder, and encoder-decoder attention layers. Research also indicates that individual attention heads in models like Vision-Language Models (VLMs) can exhibit functional specialization, performing distinct cognitive roles such as visual grounding or cross-modal interactions.

**Image paths:**
*   img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
*   img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
*   img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
*   img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
*   img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
*   img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png
2025-12-20 22:38:45,541 - __main__ - INFO - Initializing resources...
2025-12-20 22:38:45,542 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:38:45,544 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:38:45,544 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:38:53,690 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:38:53,690 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:38:53,696 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:38:53,731 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:38:53,749 - __main__ - INFO - User query received: how does attention mechanism relate to multi head attention?
2025-12-20 22:38:53,750 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism relate to multi head attention?'
2025-12-20 22:38:53,750 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:38:53,750 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:38:54,111 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:38:54,183 - __main__ - INFO - Generated 3 RAG subqueries:
2025-12-20 22:38:54,184 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-20 22:38:54,185 - __main__ - INFO -   Subquery 2: multi-head attention
2025-12-20 22:38:54,185 - __main__ - INFO -   Subquery 3: relation between attention and multi-head attention
2025-12-20 22:38:54,186 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-20 22:38:54,425 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-20 22:38:54,425 - __main__ - INFO - RAG internal retrieval query: multi-head attention
2025-12-20 22:38:54,524 - __main__ - INFO - RAG retrieved 3 documents for subquery 'multi-head attention'
2025-12-20 22:38:54,525 - __main__ - INFO - RAG internal retrieval query: relation between attention and multi-head attention
2025-12-20 22:38:54,631 - __main__ - INFO - RAG retrieved 3 documents for subquery 'relation between attention and multi-head attention'
2025-12-20 22:38:54,631 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 5
2025-12-20 22:38:54,631 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:38:54,631 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:38:54,631 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:38:54,631 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:38:54,632 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:38:54,632 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=37882
2025-12-20 22:38:54,632 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:38:54,632 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:38:54,633 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:38:56,587 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism relate to multi head attention?
2025-12-20 22:38:56,774 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Multi-head attention (Concept)
- Multi-Head Attention (Concept)
- Masked Multi-Head Attention (Concept)
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
2025-12-20 22:38:56,952 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:39:02,919 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:39:02,919 - __main__ - INFO - MATCH (a:Concept {id:'Attention mechanism'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(b:Concept {id:'Multi-head attention'})
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2025-12-20 22:39:02,919 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 22:39:02,920 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 22:39:03,905 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Multi-head attention'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-Head Attention'}]}

Neighborhood of Concept 'Multi-head attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_3_1'}

Images (from graph):
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-Head Attention

Chunks (inferred from derived_from_chunk_file):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.

## **Attention Is All You Need**



**Niki Parmar** _[∗]_
Google Research
```
nikip@google.com

```


**Ashish Vaswani** _[∗]_
Google Brain
```
avaswani@google.com

```

**Llion Jones** _[∗]_
Google Research
```
 llion@google.com

```


**Noam Shazeer** _[∗]_
Google Brain
```
noam@google.com

```


**Jakob Uszkoreit** _[∗]_
Google Research
```
usz@google.com

```


**Aidan N. Gomez** _[∗†]_
University of Toronto
```
aidan…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: [37]. We used a vocabulary of 16K tokens for the WSJ only setting and a vocabulary of 32K tokens
for the semi-supervised setting.


We performed only a small number of experiments to select the dropout, both attention and residual
(section 5.4), learning rates and beam size on the Section 22 development set, all other parameters
remained unchanged from the English-to-German base translation model. During inference, we


9


Table 4: The Transformer generalizes well to English constituency parsing (Results are on Section 23
of WSJ)

|Parser|Training|WSJ23F1|
|---|---|---|
|Vinyals & Kaiser el a…
2025-12-20 22:39:04,079 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:39:11,122 - __main__ - INFO - Final Answer: The attention mechanism allows models to focus on the most relevant observations by computing the similarity between queries (q) and keys (k). It treats all time steps equally, mitigating limitations found in recurrent neural networks (RNNs) like vanishing gradients and challenges with irregularly sampled data.

Multi-Head Attention (MHA) is an extension of this fundamental attention mechanism. Instead of performing a single attention function, MHA linearly projects the queries, keys, and values multiple times (e.g., `h` times) into different, learned subspaces of reduced dimensions. An attention function is then performed in parallel on each of these projected versions, yielding multiple output values. These outputs are subsequently concatenated and projected once more to produce the final result.

The primary benefit of Multi-Head Attention is that it enables the model to jointly attend to information from different representation subspaces at various positions. This parallel processing allows the model to capture a richer and more diverse set of relationships within the data, as a single attention head might average out these distinct aspects.

**Image paths:**
* img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
* img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
* img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
* img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
* img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
* img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png

**Chunks used:**
* attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
* attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
2025-12-20 22:40:13,010 - __main__ - INFO - Initializing resources...
2025-12-20 22:40:13,011 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-20 22:40:13,013 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-20 22:40:13,013 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-20 22:40:19,648 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-20 22:40:19,648 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-20 22:40:19,654 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-20 22:40:19,680 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-20 22:40:19,693 - __main__ - INFO - User query received: how does attention mechanism relate to multi head attention?
2025-12-20 22:40:19,694 - __main__ - INFO - Starting Query Agent with query: 'how does attention mechanism relate to multi head attention?'
2025-12-20 22:40:19,694 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-20 22:40:19,695 - __main__ - INFO - RAG Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:40:19,994 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-20 22:40:20,019 - __main__ - INFO - Generated 3 RAG subqueries:
2025-12-20 22:40:20,019 - __main__ - INFO -   Subquery 1: attention mechanism
2025-12-20 22:40:20,020 - __main__ - INFO -   Subquery 2: multi-head attention
2025-12-20 22:40:20,020 - __main__ - INFO -   Subquery 3: relation between attention mechanism and multi-head attention
2025-12-20 22:40:20,020 - __main__ - INFO - RAG internal retrieval query: attention mechanism
2025-12-20 22:40:20,158 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention mechanism'
2025-12-20 22:40:20,158 - __main__ - INFO - RAG internal retrieval query: multi-head attention
2025-12-20 22:40:20,261 - __main__ - INFO - RAG retrieved 3 documents for subquery 'multi-head attention'
2025-12-20 22:40:20,261 - __main__ - INFO - RAG internal retrieval query: relation between attention mechanism and multi-head attention
2025-12-20 22:40:20,357 - __main__ - INFO - RAG retrieved 3 documents for subquery 'relation between attention mechanism and multi-head attention'
2025-12-20 22:40:20,357 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 5
2025-12-20 22:40:20,357 - __main__ - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-20 22:40:20,357 - __main__ - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-20 22:40:20,357 - __main__ - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:40:20,357 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:40:20,357 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-20 22:40:20,357 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=37882
2025-12-20 22:40:20,358 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-20 22:40:20,358 - __main__ - INFO - Graph Tool invoked with user query: how does attention mechanism relate to multi head attention?
2025-12-20 22:40:20,358 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-20 22:40:22,248 - __main__ - INFO - Resolving entities from graph for query: how does attention mechanism relate to multi head attention?
2025-12-20 22:40:22,471 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- Multi-head attention (Concept)
- Multi-Head Attention (Concept)
- Masked Multi-Head Attention (Concept)
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
2025-12-20 22:40:22,655 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-20 22:40:28,145 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-20 22:40:28,146 - __main__ - INFO - MATCH (a:Concept {id:'Attention mechanism'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(b:Concept {id:'Multi-head attention'})
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2025-12-20 22:40:28,146 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-20 22:40:28,147 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-20 22:40:29,070 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Multi-head attention'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-Head Attention'}]}

Neighborhood of Concept 'Multi-head attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_3_1'}

Images (from graph):
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-Head Attention

Chunks (inferred from derived_from_chunk_file):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.

## **Attention Is All You Need**



**Niki Parmar** _[∗]_
Google Research
```
nikip@google.com

```


**Ashish Vaswani** _[∗]_
Google Brain
```
avaswani@google.com

```

**Llion Jones** _[∗]_
Google Research
```
 llion@google.com

```


**Noam Shazeer** _[∗]_
Google Brain
```
noam@google.com

```


**Jakob Uszkoreit** _[∗]_
Google Research
```
usz@google.com

```


**Aidan N. Gomez** _[∗†]_
University of Toronto
```
aidan…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: [37]. We used a vocabulary of 16K tokens for the WSJ only setting and a vocabulary of 32K tokens
for the semi-supervised setting.


We performed only a small number of experiments to select the dropout, both attention and residual
(section 5.4), learning rates and beam size on the Section 22 development set, all other parameters
remained unchanged from the English-to-German base translation model. During inference, we


9


Table 4: The Transformer generalizes well to English constituency parsing (Results are on Section 23
of WSJ)

|Parser|Training|WSJ23F1|
|---|---|---|
|Vinyals & Kaiser el a…
2025-12-20 22:40:29,072 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-20 22:40:38,021 - __main__ - INFO - Final Answer: Multi-Head Attention is an extension of the general attention mechanism, designed to enhance a model's ability to focus on different aspects of information simultaneously.

Here's how they relate:

1.  **Attention Mechanism:** An attention function maps a query and a set of key-value pairs to an output. It computes the similarity between queries (q) and keys (k), scaling by the key dimension, and then uses these compatibility scores as weights to sum the values. This allows models to focus on the most relevant observations in sequential data, mitigating limitations of traditional recurrent neural networks (RNNs).

2.  **Multi-Head Attention (MHA):** MHA extends this concept by allowing the model to attend to different representation subspaces in parallel. Instead of performing a single attention function on the full `d_model`-dimensional keys, values, and queries, MHA:
    *   Linearly projects the queries, keys, and values `h` times using different, learned linear projections. Each projection transforms the input into `d_k` (for queries and keys) and `d_v` (for values) dimensions, creating `h` sets of projected queries, keys, and values.
    *   Performs the attention function (e.g., Scaled Dot-Product Attention) in parallel on each of these `h` projected sets, yielding `h` separate `d_v`-dimensional output values.
    *   Concatenates these `h` output values.
    *   Projects the concatenated result once again to produce the final output.

**Key Benefits of Multi-Head Attention:**
*   It enables the model to jointly attend to information from different representation subspaces at different positions within the input. A single attention head, by averaging, might inhibit this diverse focus.
*   Attention heads can exhibit functional specialization, meaning different heads might be responsible for distinct cognitive functions such as pattern induction, truthfulness, information retrieval, safety alignment, or visual grounding in models like Large Language Models (LLMs) and Vision-Language Models (VLMs).

**Image paths:**
*   img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
*   img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
*   img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
*   img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
*   img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
*   img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png

**Chunks used:**
*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
2025-12-21 14:48:54,401 - __main__ - INFO - Initializing resources...
2025-12-21 14:48:54,401 - __main__ - INFO - Loading EmbeddingGemma model...
2025-12-21 14:48:54,403 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-12-21 14:48:54,403 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2025-12-21 14:49:04,406 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2025-12-21 14:49:04,407 - __main__ - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2025-12-21 14:49:04,449 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-12-21 14:49:05,095 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-12-21 14:49:05,154 - __main__ - INFO - User query received: how is anaphora resolution done using attention mechanism?
2025-12-21 14:49:05,155 - __main__ - INFO - Starting Query Agent with query: 'how is anaphora resolution done using attention mechanism?'
2025-12-21 14:49:05,155 - __main__ - INFO - Invoking RAG retrieval tool...
2025-12-21 14:49:05,169 - __main__ - INFO - RAG Tool invoked with user query: how is anaphora resolution done using attention mechanism?
2025-12-21 14:49:05,992 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-12-21 14:49:06,038 - __main__ - INFO - Generated 4 RAG subqueries:
2025-12-21 14:49:06,039 - __main__ - INFO -   Subquery 1: anaphora resolution attention mechanism
2025-12-21 14:49:06,039 - __main__ - INFO -   Subquery 2: attention-based anaphora resolution models
2025-12-21 14:49:06,039 - __main__ - INFO -   Subquery 3: using attention for coreference resolution
2025-12-21 14:49:06,040 - __main__ - INFO -   Subquery 4: anaphora resolution with neural attention
2025-12-21 14:49:06,040 - __main__ - INFO - RAG internal retrieval query: anaphora resolution attention mechanism
2025-12-21 14:49:08,706 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution attention mechanism'
2025-12-21 14:49:08,706 - __main__ - INFO - RAG internal retrieval query: attention-based anaphora resolution models
2025-12-21 14:49:08,807 - __main__ - INFO - RAG retrieved 3 documents for subquery 'attention-based anaphora resolution models'
2025-12-21 14:49:08,808 - __main__ - INFO - RAG internal retrieval query: using attention for coreference resolution
2025-12-21 14:49:08,933 - __main__ - INFO - RAG retrieved 3 documents for subquery 'using attention for coreference resolution'
2025-12-21 14:49:08,934 - __main__ - INFO - RAG internal retrieval query: anaphora resolution with neural attention
2025-12-21 14:49:09,039 - __main__ - INFO - RAG retrieved 3 documents for subquery 'anaphora resolution with neural attention'
2025-12-21 14:49:09,040 - __main__ - INFO - Total unique documents after de-duplication across all subqueries: 8
2025-12-21 14:49:09,040 - __main__ - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-21 14:49:09,040 - __main__ - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-21 14:49:09,040 - __main__ - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-21 14:49:09,041 - __main__ - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-21 14:49:09,041 - __main__ - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-21 14:49:09,041 - __main__ - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2025-12-21 14:49:09,041 - __main__ - INFO - RAG Unique Doc 7:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2025-12-21 14:49:09,041 - __main__ - INFO - RAG Unique Doc 8:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2025-12-21 14:49:09,042 - __main__ - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=58506
2025-12-21 14:49:09,042 - __main__ - INFO - Invoking Graph retrieval tool...
2025-12-21 14:49:09,043 - __main__ - INFO - Graph Tool invoked with user query: how is anaphora resolution done using attention mechanism?
2025-12-21 14:49:09,043 - __main__ - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2025-12-21 14:49:11,149 - __main__ - INFO - Resolving entities from graph for query: how is anaphora resolution done using attention mechanism?
2025-12-21 14:49:11,339 - __main__ - INFO - Grounded entities to be provided to Cypher generator:
- anaphora resolution (Concept)
- Attention mechanism (Concept)
- attention heads (Concept)
- attention patterns (Concept)
- Attention weights (Concept)
2025-12-21 14:49:11,530 - __main__ - INFO - Initializing grounded GraphCypherQAChain...
2025-12-21 14:49:18,093 - __main__ - INFO - Generated Cypher query for graph retrieval:
2025-12-21 14:49:18,093 - __main__ - INFO - MATCH (c1:Concept {id:'anaphora resolution'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(c2:Concept {id:'Attention mechanism'})
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2025-12-21 14:49:18,094 - __main__ - INFO - Raw graph context rows returned from Neo4j:
[]
2025-12-21 14:49:18,096 - __main__ - INFO - Graph retrieval returned empty context; running fallback queries...
2025-12-21 14:49:19,136 - __main__ - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'anaphora resolution'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Attention mechanism'}]}

Neighborhood of Concept 'anaphora resolution':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_13_0'}

Images (from graph):
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=anaphora resolution
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=anaphora resolution
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=anaphora resolution
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=anaphora resolution
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=anaphora resolution
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=anaphora resolution
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Attention mechanism

Chunks (inferred from derived_from_chunk_file):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.

## **Attention Is All You Need**



**Niki Parmar** _[∗]_
Google Research
```
nikip@google.com

```


**Ashish Vaswani** _[∗]_
Google Brain
```
avaswani@google.com

```

**Llion Jones** _[∗]_
Google Research
```
 llion@google.com

```


**Noam Shazeer** _[∗]_
Google Brain
```
noam@google.com

```


**Jakob Uszkoreit** _[∗]_
Google Research
```
usz@google.com

```


**Aidan N. Gomez** _[∗†]_
University of Toronto
```
aidan…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: - The encoder contains self-attention layers. In a self-attention layer all of the keys, values
and queries come from the same place, in this case, the output of the previous layer in the
encoder. Each position in the encoder can attend to all positions in the previous layer of the
encoder.


    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to
all positions in the decoder up to and including that position. We need to prevent leftward
information flow in the decoder to preserve the auto-regressive property. We implement this
inside of scaled dot…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: [37]. We used a vocabulary of 16K tokens for the WSJ only setting and a vocabulary of 32K tokens
for the semi-supervised setting.


We performed only a small number of experiments to select the dropout, both attention and residual
(section 5.4), learning rates and beam size on the Section 22 development set, all other parameters
remained unchanged from the English-to-German base translation model. During inference, we


9


Table 4: The Transformer generalizes well to English constituency parsing (Results are on Section 23
of WSJ)

|Parser|Training|WSJ23F1|
|---|---|---|
|Vinyals & Kaiser el a…
2025-12-21 14:49:19,431 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2025-12-21 14:49:27,653 - __main__ - INFO - Final Answer: While the provided text and graph contexts indicate a relationship between anaphora resolution and attention mechanisms, neither source explicitly details *how* anaphora resolution is done using attention.

The graph context shows that "anaphora resolution" is a concept mentioned in relation to "Attention mechanism" within the "Attention Is All You Need" paper. This paper introduces the Transformer model, which relies solely on attention mechanisms.

The text context, primarily from the "Attention Is All You Need" paper, explains the general workings of attention mechanisms, particularly self-attention:
*   **Self-attention layers** in the encoder allow each position to attend to all positions in the previous layer, enabling the model to relate different positions of a single sequence to compute a representation.
*   **Self-attention layers** in the decoder allow each position to attend to all preceding positions.
*   Attention mechanisms allow models to focus on the most relevant observations and model dependencies without regard to their distance in the input or output sequences. This ability to connect distant parts of a sequence is crucial for tasks like anaphora resolution, where a pronoun might refer to an entity far earlier in the text.
*   The Transformer uses multi-head attention, which allows the model to jointly attend to information from different representation subspaces at different positions.

Although the specific steps for anaphora resolution using attention are not detailed, the underlying principle is that attention mechanisms, especially self-attention, provide a way for models to identify and weigh the relevance of different words or phrases in a sequence to each other, which is fundamental for resolving anaphoric references.

**Image paths:**
*   img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png
*   img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png
*   img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png
*   img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png
*   img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png
*   img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png

**Chunks used:**
*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0 (source: attention_is_all_you_need_raw_with_image_ids_with_captions.md)
*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1 (source: attention_is_all_you_need_raw_with_image_ids_with_captions.md)
*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2 (source: attention_is_all_you_need_raw_with_image_ids_with_captions.md)
2025-12-21 14:49:27,664 - __main__ - INFO - QUERY_TRACE_JSON {"run_id": "73bc8f7e-a92a-4e10-826c-8b6e46d5a3fa", "timestamp_utc": "2025-12-21T09:04:27.657543+00:00", "user_question": "how is anaphora resolution done using attention mechanism?", "rewritten_or_decomposed_queries": ["anaphora resolution attention mechanism", "attention-based anaphora resolution models", "using attention for coreference resolution", "anaphora resolution with neural attention"], "retrieved_chunks": [{"chunk_id": "attention_is_all_you_need_raw_chunks_2k_2", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl", "metadata": {"source": "attention_is_all_you_need_raw.md", "chunk_id": "attention_is_all_you_need_raw_chunks_2k_2", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, "text": "[38, 2, 9].\n\n\n    - The encoder contains self-attention layers. In a self-attention layer all of the keys, values\nand queries come from the same place, in this case, the output of the previous layer in the\nencoder. Each position in the encoder can attend to all positions in the previous layer of the\nencoder.\n\n\n    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to\nall positions in the decoder up to and including that position. We need to prevent leftward\ninformation flow in the decoder to preserve the auto-regressive property. We implement this\ninside of scaled dot-product attention by masking out (setting to _−∞_ ) all values in the input\nof the softmax which correspond to illegal connections. See Figure 2.\n\n\n**3.3** **Position-wise Feed-Forward Networks**\n\n\nIn addition to attention sub-layers, each of the layers in our encoder and decoder contains a fully\nconnected feed-forward network, which is applied to each position separately and identically. This\nconsists of two linear transformations with a ReLU activation in between.\n\n\nFFN( _x_ ) = max(0 _, xW_ 1 + _b_ 1) _W_ 2 + _b_ 2 (2)\n\n\nWhile the linear transformations are the same across different positions, they use different parameters\nfrom layer to layer. Another way of describing this is as two convolutions with kernel size 1.\nThe dimensionality of input and output is _d_ model = 512, and the inner-layer has dimensionality\n_dff_ = 2048.\n\n\n**3.4** **Embeddings and Softmax**\n\n\nSimilarly to other sequence transduction models, we use learned embeddings to convert the input\ntokens and output tokens to vectors of dimension _d_ model. We also use the usual learned linear transformation and softmax function to convert the decoder output to predicted next-token probabilities. In\nour model, we share the same weight matrix between the two embedding layers and the pre-softmax\nlinear transformation, similar to [30]. In the embedding layers, we multiply those weights by _[√]_ _d_ model.\n\n\n5\n\n\nTable 1: Maximum path lengths, per-layer complexity and minimum number of sequential operations\nfor different layer types. _n_ is the sequence length, _d_ is the representation dimension, _k_ is the kernel\nsize of convolutions and _r_ the size of the neighborhood in restricted self-attention.\n\n\nLayer Type Complexity per Layer Sequential Maximum Path Length\nOperations\nSelf-Attention _O_ ( _n_ [2] _· d_ ) _O_ (1) _O_ (1)\nRecurrent _O_ ( _n · d_ [2] ) _O_ ( _n_ ) _O_ ( _n_ )\nConvolutional _O_ ( _k · n · d_ [2] ) _O_ (1) _O_ ( _logk_ ( _n_ ))\nSelf-Attention (restricted) _O_ ( _r · n · d_ ) _O_ (1) _O_ ( _n/r_ )\n\n\n**3.5** **Positional Encoding**\n\n\nSince our model contains no recurrence and no convolution, in order for the model to make use of the\norder of the sequence, we must inject some information about the relative or absolute position of the\ntokens in the sequence. To this end, we add \"positional encodings\" to the input embeddings at the\nbottoms of the encoder and decoder stacks. The positional encodings have the same dimension _d_ model\nas the embeddings, so that the two can be summed. There are many choices of positional encodings,\nlearned and fixed [9].\n\n\nIn this work, we use sine and cosine functions of different frequencies:\n\n\n_PE_ ( _pos,_ 2 _i_ ) = _sin_ ( _pos/_ 10000 [2] _[i/d]_ [model] )\n\n_PE_ ( _pos,_ 2 _i_ +1) = _cos_ ( _pos/_ 10000 [2] _[i/d]_ [model] )\n\n\nwhere _pos_ is the position and _i_ is the dimension. That is, each dimension of the positional encoding\ncorresponds to a sinusoid. The wavelengths form a geometric progression from 2 _π_ to 10000 _·_ 2 _π_ . We\nchose this function because we hypothesized it would allow the model to easily learn to attend by\nrelative positions, since for any fixed offset _k_, _PEpos_ + _k_ can be represented as a linear function of\n_PEpos_ .\n\n\nWe also experimented with using learned positional embeddings [9] instead, and found that the two\nversions produced nearly identical results (see Table 3 row (E)). We chose the sinusoidal version\nbecause it may allow the model to extrapolate to sequence lengths longer than the ones encountered\nduring training.\n\n\n**4** **Why Self-Attention**\n\n\nIn this section we compare various aspects of self-attention layers to the recurrent and convolutional layers commonly used for mapping one variable-length sequence of symbol representations\n( _x_ 1 _, ..., xn_ ) to another sequence of equal length ( _z_ 1 _, ..., zn_ ), with _xi, zi ∈_ R _[d]_, such as a hidden\nlayer in a typical sequence transduction encoder or decoder. Motivating our use of self-attention we\nconsider three desiderata.\n\n\nOne is the total computational complexity per layer. Another is the amount of computation that can\nbe parallelized, as measured by the minimum number of sequential operations required.\n\n\nThe third is the path length between long-range dependencies in the network. Learning long-range\ndependencies is a key challenge in many sequence transduction tasks. One key factor affecting the\nability to learn such dependencies is the length of the paths forward and backward signals have to\ntraverse in the network. The shorter these paths between any combination of positions in the input\nand output sequences, the easier it is to learn long-range dependencies [12]. Hence we also compare\nthe maximum path length between any two input and output positions in networks composed of the\ndifferent layer types.\n\n\nAs noted in Table 1, a self-attention layer connects all positions with a constant number of sequentially\nexecuted operations, whereas a recurrent layer requires _O_ ( _n_ ) sequential operations. In terms of\ncomputational complexity, self-attention layers are faster than recurrent layers when the sequence\n\n\n6\n\n\nlength _n_ is smaller than the representation dimensionality _d_, which is most often the case with\nsentence representations used by state-of-the-art models in machine translations, such as word-piece\n\n[38] and byte-pair [31] representations. To improve computational performance for tasks involving\nvery long sequences, self-attention could be restricted to considering only a neighborhood of size _r_ in\nthe input sequence centered around the respective output position. This would increase the maximum\npath length to _O_ ( _n/r_ ). We plan to investigate this approach further in future work.\n\n\nA single convolutional layer with kernel width _k < n_ does not connect all pairs of input and output\npositions. Doing so requires a stack of _O_ ( _n/k_ ) convolutional layers in the case of contiguous kernels,\nor _O_ ( _logk_ ( _n_ )) in the case of dilated convolutions [18], increasing the length of the longest paths\nbetween any two positions in the network. Convolutional layers are generally more expensive than\nrecurrent layers, by a factor of _k_ . Separable convolutions [6], however, decrease the complexity\nconsiderably, to _O_ ( _k · n · d_ + _n · d_ [2] ). Even with _k_ = _n_, however, the complexity of a separable\nconvolution is equal to the combination of a self-attention layer and a point-wise feed-forward layer,\nthe approach we take in our model.\n\n\nAs side benefit, self-attention could yield more interpretable models. We inspect attention distributions\nfrom our models and present and discuss examples in the appendix. Not only do individual attention\nheads clearly learn to perform different tasks, many appear to exhibit behavior related to the syntactic\nand semantic structure of the sentences.\n\n\n**5** **Training**\n\n\nThis section describes the training regime for our models.\n\n\n**5.1** **Training Data and Batching**"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_0", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl", "metadata": {"source": "neuronal_attention_circuits_raw.md", "chunk_id": "neuronal_attention_circuits_raw_chunks_2k_0", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, "text": "## **Neuronal Attention Circuit (NAC) for Representation Learning**\n\n**Waleed Razzaq** [1] **Izis Kankaraway** [1] **Yun-Bo Zhao** [1 2]\n\n\n\n**Abstract**\n\nAttention improves representation learning over\nRNNs, but its discrete nature limits continuoustime (CT) modeling. We introduce Neuronal Attention Circuit (NAC), a novel, biologically plausible CT-Attention mechanism that reformulates\n\nattention logits computation as the solution to a\nlinear first-order ODE with nonlinear interlinked\ngates derived from repurposing _C. elegans_ Neuronal Circuit Policies (NCPs) wiring mechanism.\nNAC replaces dense projections with sparse sensory gates for key-query projections and a sparse\nbackbone network with two heads for computing\n_content-target_ and _learnable time-constant_ gates,\nenabling efficient adaptive dynamics. NAC supports three attention logit computation modes: (i)\nexplicit Euler integration, (ii) exact closed-form\nsolution, and (iii) steady-state approximation. To\nimprove memory intensity, we implemented a\nsparse Top- _K_ pairwise concatenation scheme that\nselectively curates key-query interactions. We\nprovide rigorous theoretical guarantees, including\nstate stability, bounded approximation errors, and\nuniversal approximation. Empirically, we implemented NAC in diverse domains, including irregular time-series classification, lane-keeping for\nautonomous vehicles, and industrial prognostics.\nWe observed that NAC matches or outperforms\ncompeting baselines in accuracy and occupies an\nintermediate position in runtime and memory efficiency compared with several CT baselines.\n\n\n**1. Introduction**\n\n\nLearning representations of sequential data in temporal or\nspatio-temporal domains is essential for capturing patterns\nand enabling accurate forecasting. Discrete-time Recurrent neural networks (DT-RNNs) such as RNN (Rumelhart et al., 1985; Jordan, 1997), Long-short term memory\n\n\n1Department of Automation, University of Science & Technology of China, Hefei, China [2] Institute of Artificial Intelligence,\nHefei Comprehensive National Science Center. Correspondence to:\nYun-Bo Zhao _<_ ybzhao@ustc.edu.cn _>_, Waleed Razzaq _<_ waleedrazzaq@mail.ustc.edu.cn _>_ .\n\n\n_Preprint. December 12, 2025._\n\n\n\n(LSTM) (Hochreiter & Schmidhuber, 1997), and Gated Recurrent Unit (GRU) (Cho et al., 2014) model sequential dependencies by iteratively updating hidden states to represent\nor predict future elements in a sequence. While effective\nfor regularly sampled sequences, DT-RNNs face challenges\nwith irregularly sampled data because they assume uniform\ntime intervals. In addition, vanishing gradients can make\nit difficult to capture long-term dependencies (Hochreiter,\n1998).\nContinuous-time RNNs (CT-RNNs) (Rubanova et al., 2019)\nmodel hidden states as ordinary differential equations\n(ODEs), allowing them to process inputs that arrive at arbitrary or irregular time intervals. Mixed-memory RNNs\n(mmRNNs) (Lechner & Hasani, 2022) build on this idea\nby separating memory compartments from time-continuous\nstates, helping maintain stable error propagation while capturing continuous-time dynamics. Liquid neural networks\n(LNNs) (Hasani et al., 2021; 2022) take a biologically inspired approach by assigning variable time-constants to hidden states, improving adaptability and robustness, though\nvanishing gradients can still pose challenges during training.\nThe attention mechanisms (Vaswani et al., 2017) mitigate\nthis limitation by treating all time steps equally and allowing models to focus on the most relevant observations. It\ncomputes the similarity between queries ( _q_ ) and keys ( _k_ ),\nscaling by the key dimension to keep gradients stable. MultiHead Attention (MHA) (Vaswani et al., 2017) extends this\nby allowing the model to attend to different representation\nsubspaces in parallel. Variants like Sparse Attention (Tay\net al., 2020; Roy et al., 2021), BigBird (Zaheer et al., 2020),\nand Longformer (Beltagy et al., 2020) modify the attention\npattern to reduce computational cost, particularly for long sequences, by attending only to selected positions rather than\nall pairs. Even with these improvements, attention-based\nmethods still rely on discrete scaled dot-product operations,\nlimiting their ability to model continuous trajectories often\ncaptured by CT counterparts.\nRecent work has explored bridging this gap through NeuralODE (Chen et al., 2018) formulation. mTAN (Shukla &\nMarlin, 2021) learns CT embeddings and uses time-based\nattention to interpolate irregular observations into a fixedlength representation for downstream encoder-decoder modeling. ODEFormer (d’Ascoli et al., 2023) trains a sequenceto-sequence transformer on synthetic trajectories to directly\ninfer symbolic ODE systems from noisy, irregular data,\nthough it struggles with chaotic systems and generalization\n\n\n\n1\n\n\n**Neuronal Attention Circuit (NAC) for Representation Learning**\n\n\n\nbeyond observed conditions. Continuous-time Attention\n(CTA) (Chien & Chen, 2021) embeds a continuous-time\nattention mechanism within a Neural ODE, allowing attention weights and hidden states to evolve jointly over time.\nStill, it remains computationally intensive and sensitive to\nthe accuracy of the ODE solver. ContiFormer (Chen et al.,\n2023) builds a CT-transformer by pairing ODE-defined latent trajectories with a time-aware attention mechanism to\nmodel dynamic relationships in data.\nDespite these innovations, a persistent and underexplored\ngap remains in developing a biologically plausible attention\nmechanism that seamlessly integrates CT dynamics with the\nabstraction of the brain’s connectome to handle irregular sequences without prohibitive computational costs. Building\non this, we propose a novel attention mechanism called the\n_Neuronal Attention Circuit_ (NAC), in which attention logits\nare computed as the solution to a first-order ODE modulated\nby nonlinear, interlinked gates derived from repurposing\nNeuronal Circuit Policies (NCPs) from the nervous system\nof _C. elegans_ nematode (refer to Appendix A.2 for more\ninformation). Unlike standard attention, which projects keyquery pairs through a dense layer, NAC employs a sensory\ngate to transform input features and a backbone to model\nnonlinear interactions, with multiple heads producing outputs structured for attention logits computation. Based on\nthe solutions to ODE, we define three computation modes:\n(i) Exact, using the closed-form ODE solution; (ii) Euler,\napproximating the solution via _explicit Euler_ integration;\nand (iii) Steady, using only the steady-state solution, analogous to standard attention scores. To reduce computational\ncomplexity, we implemented a sparse Top- _K_ pairwise concatenation algorithm that selectively curates key-query inputs. We evaluate NAC across multiple domains, including\nirregularly sampled time series, autonomous vehicle lanekeeping, and Industry 4.0, comparing it to state-of-the-art\nbaselines. NAC consistently matches or outperforms these\nmodels, while runtime and peak memory benchmarks place\nit between CT-RNNs in terms of speed and CT-Attentions\nin terms of memory requirements.\n\n\n**2. Neuronal Attention Circuit (NAC)**\n\n\nWe propose a simple alternative formulation of the attention\nlogits _a_ (refer to Appendix A.1 for more information), interpreting them as the solution to a first-order linear ODE\nmodulated by nonlinear, interlinked gates:\n\n\n\nfrom repurposing NCPs. We refer to this formulation as\nthe Neuronal Attention Circuit (NAC). It enables the logits\n_at_ to evolve dynamically with input-dependent, variable\ntime constants, mirroring the adaptive temporal dynamics\nfound in _C. elegans_ nervous systems while improving\ncomputational efficiency and expressiveness. Moreover, it\nintroduces continuous depth into the attention mechanism,\nbridging discrete-layer computation with dynamic temporal\nevolution.\n\n**Motivation behind this formulation:** The proposed\nformulation is loosely motivated by the input-dependent\ntime-constant mechanism of Liquid Neural Networks\n(LNNs), a class of CT-RNNs inspired by biological nervous\nsystems and synaptic transmission. In this framework, the\ndynamics of non-spiking neurons are described by a linear\nODE with nonlinear, interlinked gates: _ddt_ **xt** = **[x]** _τ_ **[t]** [+] **[ S][t]** _[,]_"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_3", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl", "metadata": {"source": "neuronal_attention_circuits_raw.md", "chunk_id": "neuronal_attention_circuits_raw_chunks_2k_3", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, "text": "Scores: _S ←_ _Q · K_ _[⊤]_\n\nEffective Top- _K_ : _K_ eff _←_ min( _K, Tk_ )\nIndices: _I_ topk _←_ top ~~k~~ ( _S, K_ eff)\nGather: _K_ selected _←_ gather( _K, I_ topk) _∈_ R _[B][×][H][×][T][q]_ _[×][K]_ [eff] _[×][D]_\n\nTiled: _Q_ tiled _←_ tile( _Q, K_ eff) _∈_ R _[B][×][H][×][T][q]_ _[×][K]_ [eff] _[×][D]_\n\nConcatenate: _U_ topk _←_ [ _Q_ tiled; _K_ selected ] _∈_ R _[B][×][H][×][T][q]_ _[×][K]_ [eff] _[×]_ [2] _[D]_\n\n**return** _U_ topk\n\n\n**2.2. Designing the Neural Network**\n\n\nWe now outline the design of a neural network layer guided\nby the preceding analysis. The process involves five steps:\n(i) repurposing NCPs; (ii) input curation; (iii) construction\nof the time vector ( _t_ ); (iv) computing attention logits and\nweights; and (v) generating the attention output. Figure 2\nprovides a graphical overview of NAC.\n**Repurposing NCPs:** We repurpose the NCPs framework\nby converting its fixed, biologically derived wiring (see Figure 1(a)) into a flexible recurrent architecture that allows\nconfigurable input–output mappings. Instead of enforcing\na static connectome, our approach exposes adjacency matrices as modifiable structures defining sparse input and\nrecurrent connections. This enables selective information\n\nrouting across neuron groups while retaining the original circuit topology. Decoupling wiring specifications from model\ninstantiation allows dynamic connectivity adjustments to\naccommodate different input modalities without full retraining. Algorithm 1 summarizes the steps for repurposing the\nNCPs wiring mechanism. Key features include group-wise\nmasking for neuron isolation, adaptive remapping of inputs\nand outputs for task-specific adaptation, and tunable sparsity\n_s_ to balance expressiveness and efficiency.\nIn our implementation, the sensory neuron gate ( _NN_ sensory)\nprojects the _q_, _k_, and _v_ representations (see Figure 1(b)).\nThis enables sensory neurons to maintain structured, contextaware representations rather than collapsing inputs into fully\n\n\n\nconnected layers. As a result, the network preserves locality\nand modularity, which improves information routing.\n\n\n_NN_ sensory = NCPCell( _G_ input = [ _Ns_ ] _, G_ output = [ _Ns_ ] _,_\n\n_D_ = [ _Ni, Nc, Nm_ ] _, s_ )\n(13)\nThe inter-to-motor pathways form a backbone network\n( _NN_ backbone) with branches that compute _ϕ_ and _ωτ_ (see\nFigure 1(c)). Instead of learning _ϕ_ and _ωτ_ independently,\nthis backbone allows the model to learn shared representations, enabling multiple benefits: (i) separate head layers\nenable the system to capture temporal and structural dependencies independently; (ii) accelerates convergence during\ntraining.\n\n\n_NN_ backbone = NCPCell( _G_ input = [ _Ni_ ] _, G_ output = [ _Nm_ ] _,_\n\n_D_ = [ _Ns_ ] _, s_ )\n(14)\nThe output heads are defined as:\n\n\n_ϕ_ = _σ_ ( _NN_ backbone( **u** )) (15)\n\n_ωτ_ = softplus( _NN_ backbone( **u** )) + _ε,_ _ε >_ 0 (16)\n\n\nHere, _ϕ_ serves as a _content–target gate_ head, where the\nsigmoid function _σ_ ( _·_ ) determines the target signal strength.\nIn contrast, _ωτ_ is a strictly positive _time–constant gate_ head\nthat controls the rate of convergence and the steady-state\namplitude. Conceptually, this parallels recurrent gating: _ϕ_\nregulates _what_ content to emphasize, while _ωτ_ governs _how_\n_quickly_ and _to what extent_ it is expressed.\n**Input Curation:** We experimented with different\nstrategies for constructing query–key inputs. Initially, we implemented full pairwise concatenation,\nwhere queries _Q ∈_ R _[B][×][H][×][T][q][×][D]_ are combined with\nall keys _K_ _∈_ R _[B][×][H][×][T][k][×][D]_ to form a joint tensor\n_U ∈_ R _[B][×][H][×][T][q][×][T][k][×]_ [2] _[D]_ . While this preserved complete\nfeature information and enabled expressive, learnable\nsimilarity functions, it was memory-intensive, making it impractical for longer sequences. To mitigate this, we applied\na sparse Top- _K_ optimization: for each query, we compute\npairwise scores _S_ = _Q · K_ _[⊤]_ _∈_ R _[B][×][H][×][T][q][×][T][k]_, select the\nTop- _K_ eff = min( _K, Tk_ ) keys, and construct concatenated\npairs _U_ topk _∈_ R _[B][×][H][×][T][q][×][K]_ [eff] _[×]_ [2] _[D]_ . This approach preserves\nthe most relevant interactions while substantially reducing\nmemory requirements in the concatenation and subsequent\nbackbone processing stages, allowing the method to scale\nlinearly with the sequence length in those components.\nHowever, the initial computation of _S_ remains quadratic\n(see Appendix C.3). Algorithm 2 outlines the steps required\nfor input curation.\n**Time Vector:** NAC builds on continuous-depth models\nas (Hasani et al., 2022) that adapt their temporal dynamics to the task. It constructs an internal, normalized\npseudo-time vector _t_ pseudo using a sigmoidal transformation,\n_t_ pseudo = _σ_ ( _ta · t_ + _tb_ ), where _ta_ and _tb_ are learnable affine\n\n\n\n4\n\n\n**Neuronal Attention Circuit (NAC) for Representation Learning**\n\n\n\nparameters and _σ_ is the sigmoid function. For time-varying\ndatasets (e.g., irregularly sampled series), each time point\n_t_ is derived from the sample’s timestamp, while for tasks\nwithout meaningful timing, _t_ is set to 1. The resulting _t_ pseudo\nlies in [0 _,_ 1] and provides a smooth, bounded representation\nof time for modulating the network’s dynamics.\n**Attention logits and weights:** Starting from Eqn. 3,\nconsider the trajectory of a query–key pair with initial\ncondition _a_ 0 = 0:\n\n\n\n_at_ = _[ϕ]_\n\n_ωτ_\n\n\n\n�1 _−_ _e_ _[−][ω][τ][ t]_ [�] _,_ (17)\n\n\n\nfollowed by the _softmax_ normalization to calculate attention weights. The resulting attention weights _αt_ [(] _[h]_ [)] are then\nused to integrate with the value vector _v_ [(] _[h]_ [)], producing headspecific attention outputs. Finally, these outputs are concatenated and linearly projected back into the model dimension.\nThis formulation ensures that each head learns distinct dynamic compatibilities governed by its own parameterization\nof _ϕ_ and _ωτ_, while the aggregation across heads preserves\nthe expressive capacity of the standard multi-head attention\nmechanism.\n\n\n**2.3. NAC as Universal Approximator**\n\n\nWe now establish the universal approximation capability of\nNAC by extending the classical Universal Approximation\nTheorem (UAT) (Nishijima, 2021) to the proposed mechanism. For brevity, we consider a network with a single\nNAC layer processing fixed-dimensional inputs, though the\nargument generalizes to sequences."}, {"chunk_id": "attention_is_all_you_need_raw_chunks_2k_0", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl", "metadata": {"source": "attention_is_all_you_need_raw.md", "chunk_id": "attention_is_all_you_need_raw_chunks_2k_0", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, "text": "Provided proper attribution is provided, Google hereby grants permission to\nreproduce the tables and figures in this paper solely for use in journalistic or\nscholarly works.\n\n## **Attention Is All You Need**\n\n\n\n**Niki Parmar** _[∗]_\nGoogle Research\n```\nnikip@google.com\n\n```\n\n\n**Ashish Vaswani** _[∗]_\nGoogle Brain\n```\navaswani@google.com\n\n```\n\n**Llion Jones** _[∗]_\nGoogle Research\n```\n llion@google.com\n\n```\n\n\n**Noam Shazeer** _[∗]_\nGoogle Brain\n```\nnoam@google.com\n\n```\n\n\n**Jakob Uszkoreit** _[∗]_\nGoogle Research\n```\nusz@google.com\n\n```\n\n\n**Aidan N. Gomez** _[∗†]_\nUniversity of Toronto\n```\naidan@cs.toronto.edu\n\n```\n\n\n**Łukasz Kaiser** _[∗]_\nGoogle Brain\n```\nlukaszkaiser@google.com\n\n```\n\n\n**Illia Polosukhin** _[∗‡]_\n\n```\n             illia.polosukhin@gmail.com\n\n```\n\n**Abstract**\n\n\nThe dominant sequence transduction models are based on complex recurrent or\nconvolutional neural networks that include an encoder and a decoder. The best\nperforming models also connect the encoder and decoder through an attention\nmechanism. We propose a new simple network architecture, the Transformer,\nbased solely on attention mechanisms, dispensing with recurrence and convolutions\nentirely. Experiments on two machine translation tasks show these models to\nbe superior in quality while being more parallelizable and requiring significantly\nless time to train. Our model achieves 28.4 BLEU on the WMT 2014 Englishto-German translation task, improving over the existing best results, including\nensembles, by over 2 BLEU. On the WMT 2014 English-to-French translation task,\nour model establishes a new single-model state-of-the-art BLEU score of 41.8 after\ntraining for 3.5 days on eight GPUs, a small fraction of the training costs of the\nbest models from the literature. We show that the Transformer generalizes well to\nother tasks by applying it successfully to English constituency parsing both with\nlarge and limited training data.\n\n\n_∗_ Equal contribution. Listing order is random. Jakob proposed replacing RNNs with self-attention and started\nthe effort to evaluate this idea. Ashish, with Illia, designed and implemented the first Transformer models and\nhas been crucially involved in every aspect of this work. Noam proposed scaled dot-product attention, multi-head\nattention and the parameter-free position representation and became the other person involved in nearly every\ndetail. Niki designed, implemented, tuned and evaluated countless model variants in our original codebase and\ntensor2tensor. Llion also experimented with novel model variants, was responsible for our initial codebase, and\nefficient inference and visualizations. Lukasz and Aidan spent countless long days designing various parts of and\nimplementing tensor2tensor, replacing our earlier codebase, greatly improving results and massively accelerating\nour research.\n\n_†_ Work performed while at Google Brain.\n\n_‡_ Work performed while at Google Research.\n\n\n31st Conference on Neural Information Processing Systems (NIPS 2017), Long Beach, CA, USA.\n\n\n**1** **Introduction**\n\n\nRecurrent neural networks, long short-term memory [13] and gated recurrent [7] neural networks\nin particular, have been firmly established as state of the art approaches in sequence modeling and\ntransduction problems such as language modeling and machine translation [35, 2, 5]. Numerous\nefforts have since continued to push the boundaries of recurrent language models and encoder-decoder\narchitectures [38, 24, 15].\n\n\nRecurrent models typically factor computation along the symbol positions of the input and output\nsequences. Aligning the positions to steps in computation time, they generate a sequence of hidden\nstates _ht_, as a function of the previous hidden state _ht−_ 1 and the input for position _t_ . This inherently\nsequential nature precludes parallelization within training examples, which becomes critical at longer\nsequence lengths, as memory constraints limit batching across examples. Recent work has achieved\nsignificant improvements in computational efficiency through factorization tricks [21] and conditional\ncomputation [32], while also improving model performance in case of the latter. The fundamental\nconstraint of sequential computation, however, remains.\n\n\nAttention mechanisms have become an integral part of compelling sequence modeling and transduction models in various tasks, allowing modeling of dependencies without regard to their distance in\nthe input or output sequences [2, 19]. In all but a few cases [27], however, such attention mechanisms\nare used in conjunction with a recurrent network.\n\n\nIn this work we propose the Transformer, a model architecture eschewing recurrence and instead\nrelying entirely on an attention mechanism to draw global dependencies between input and output.\nThe Transformer allows for significantly more parallelization and can reach a new state of the art in\ntranslation quality after being trained for as little as twelve hours on eight P100 GPUs.\n\n\n**2** **Background**\n\n\nThe goal of reducing sequential computation also forms the foundation of the Extended Neural GPU\n\n[16], ByteNet [18] and ConvS2S [9], all of which use convolutional neural networks as basic building\nblock, computing hidden representations in parallel for all input and output positions. In these models,\nthe number of operations required to relate signals from two arbitrary input or output positions grows\nin the distance between positions, linearly for ConvS2S and logarithmically for ByteNet. This makes\nit more difficult to learn dependencies between distant positions [12]. In the Transformer this is\nreduced to a constant number of operations, albeit at the cost of reduced effective resolution due\nto averaging attention-weighted positions, an effect we counteract with Multi-Head Attention as\ndescribed in section 3.2.\n\n\nSelf-attention, sometimes called intra-attention is an attention mechanism relating different positions\nof a single sequence in order to compute a representation of the sequence. Self-attention has been\nused successfully in a variety of tasks including reading comprehension, abstractive summarization,\ntextual entailment and learning task-independent sentence representations [4, 27, 28, 22].\n\n\nEnd-to-end memory networks are based on a recurrent attention mechanism instead of sequencealigned recurrence and have been shown to perform well on simple-language question answering and\nlanguage modeling tasks [34].\n\n\nTo the best of our knowledge, however, the Transformer is the first transduction model relying\nentirely on self-attention to compute representations of its input and output without using sequencealigned RNNs or convolution. In the following sections, we will describe the Transformer, motivate\nself-attention and discuss its advantages over models such as [17, 18] and [9].\n\n\n**3** **Model Architecture**\n\n\nMost competitive neural sequence transduction models have an encoder-decoder structure [5, 2, 35].\nHere, the encoder maps an input sequence of symbol representations ( _x_ 1 _, ..., xn_ ) to a sequence\nof continuous representations **z** = ( _z_ 1 _, ..., zn_ ). Given **z**, the decoder then generates an output\nsequence ( _y_ 1 _, ..., ym_ ) of symbols one element at a time. At each step the model is auto-regressive\n\n[10], consuming the previously generated symbols as additional input when generating the next.\n\n\n2\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png)\n\nFigure 1: The Transformer - model architecture.\n\n\nThe Transformer follows this overall architecture using stacked self-attention and point-wise, fully\nconnected layers for both the encoder and decoder, shown in the left and right halves of Figure 1,\nrespectively.\n\n\n**3.1** **Encoder and Decoder Stacks**"}, {"chunk_id": "attention_functional_roles_raw_chunks_2k_0", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl", "metadata": {"source": "attention_functional_roles_raw.md", "chunk_id": "attention_functional_roles_raw_chunks_2k_0", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl"}, "text": "## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES\n\n**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**\n\n**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**\n\n1The University of Melbourne 2The University of Sydney\n_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au\n_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au\ntongliang.liu@sydney.edu.au\n\n\nABSTRACT\n\n\nDespite excelling on multimodal benchmarks, vision–language models (VLMs)\nlargely remain a black box. In this paper, we propose a novel interpretability framework to systematically analyze the internal mechanisms of VLMs, focusing on the functional roles of attention heads in multimodal reasoning. To\nthis end, we introduce CogVision, a dataset that decomposes complex multimodal questions into step-by-step subquestions designed to simulate human reasoning through a chain-of-thought paradigm, with each subquestion associated\nwith specific receptive or cognitive functions such as high-level visual reception and inference. Using a probing-based methodology, we identify attention\nheads that specialize in these functions and characterize them as functional heads.\nOur analysis across diverse VLM families reveals that these functional heads\nare universally sparse, vary in number and distribution across functions, and\nmediate interactions and hierarchical organization. Furthermore, intervention\nexperiments demonstrate their critical role in multimodal reasoning: removing\nfunctional heads leads to performance degradation, while emphasizing them enhances accuracy. These findings provide new insights into the cognitive organization of VLMs and suggest promising directions for designing models with more\nhuman-aligned perceptual and reasoning abilities. Code and data are available at\nhttps://github.com/YanbeiJiang/CogVision.\n\n\n1 INTRODUCTION\n\n\nLarge Vision-Language Models (VLMs) (Zhu et al., 2023; Liu et al., 2023; Lu et al., 2024a) have\ndemonstrated remarkable success across diverse multimodal tasks, ranging from image captioning\nto visual question answering. Although VLMs can solve mathematical reasoning problems with\nvisual context (as shown in Fig. 1), their internal mechanisms remain poorly understood.\n\n\nFor humans, solving such complex problems (illustrated in Fig. 1) typically requires the collaboration of vision and language, engaging multiple brain regions (Barsalou, 2014): the occipital lobe\nfor visual reception, capturing and processing the content of the images; the temporal lobe supports\nlong-term memory and the recall of relevant factual knowledge, such as chemical concentration formulas (Wheeler et al., 1997); and the parietal and prefrontal cortices are involved in higher-order\nreasoning (Hubbard et al., 2005), to produce the correct answer.\n\n\nRecent research in interpretability has begun probing the internal organization of large language\nmodels (LLMs), revealing specialized attention heads for specific functions (Wu et al.; Li et al.,\n2023a; Zheng et al.). In the case of VLMs, several studies (Kang et al., 2025; Bi et al., 2025) have\nidentified sparse attention heads with special functional roles in tasks such as grounding. However,\nstudying VLMs in complex, multi-step reasoning scenarios remains underexplored. A deeper under\n\n_∗_ Both authors contributed equally to this research.\n\n\n1\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png)\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png)\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png)\n\n\n\nDecision making\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png)\n\nHigh-level Vision Reception\n\n\n\nLanguage Knowledge Recall\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png)\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png)\n\n\n\nMath Reasoning\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png)\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png)\n\nOccipital lobe Temporal lobe Parietal lobe Frontal lobe\n\n\n\n\n\n\n\n\n\nBy dividing the number of Solution A has a higher\n\nparticles by the solvent concentration of A, Solution A.\n\n\n\n\n\n\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png)\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png)\n\nFigure 1: To answer a complex question, the human brain engages multiple regions, each performing\ndistinct cognitive functions. We investigate whether specific attention heads in large vision language\nmodels play analogous functional roles in generating responses.\n\n\nstanding of whether such specialized components exist, how they are organized, and what functional\nroles they play in multimodal reasoning is therefore critical.\n\n\nIn this paper, we propose a novel interpretability framework for systematically analyzing the functional roles of attention heads-parallel units in transformer models that compute token-to-token\nattention-an important component in VLMs, with a focus on their contributions to reception (perceptual processing) and cognition. To facilitate this, we introduce CogVision, a dataset that bridges the\ngap between model analysis and human cognitive processes. CogVision decomposes multimodal\nqueries into step-by-step subquestions, each aligned with specific cognitive functions (such as math\nreasoning, decision-masking), thus enabling a fine-grained evaluation of reasoning aligned with the\nchain-of-thought (CoT) paradigm. Leveraging CogVision, we develop a probing method to identify and characterize attention heads responsible for distinct cognitive operations across vision and\nlanguage within the transformer architecture.\n\n\nWe conduct extensive experiments on three major VLM families, including Intern (Zhu et al., 2025),\nQwen (Yang et al., 2025), and Gemma (Team et al., 2025) with different model scales. Our results\nreveal the existence of cognitive heads that consistently exhibit **universal**, **sparse**, and **intrinsic**\nproperties across architectures. Further analysis of the correlations among these functional heads\nreveals **cross-function interactions**, where a single head may support multiple functions or modalities, and uncovers a **hierarchical structure** in which lower-level functional heads modulate higherlevel ones, showing the complexity of neural networks (Barsalou, 2014; Ono et al., 2022).\n\n\nFurthermore, we validate the functional importance of these heads by showing that their removal\ndegrades performance on complex tasks and leads to specific error patterns, while their enhancement improves reasoning capabilities. Our findings provide compelling evidence that these attention\nheads play a critical role in multimodal reasoning. This insight not only deepens our understanding of the internal organization of VLMs but also suggests potential avenues for designing more\ninterpretable and cognitive-inspired multimodal AI systems.\n\n\n2 COGVISION\n\n\nIn this section, we present our dataset Cognitive Vision (CogVision) that contains cognitive process\nin multimodal reasoning. CogVision contains 1,409 main questions and 5,744 subquestions. Each\n\n\n2"}, {"chunk_id": "attention_functional_roles_raw_chunks_2k_2", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl", "metadata": {"source": "attention_functional_roles_raw.md", "chunk_id": "attention_functional_roles_raw_chunks_2k_2", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl"}, "text": "Let _Nt_ denote the number of tokens in the generated answer _a_ _[M]_ _i_ [. To isolate semantically informative]\ncontent relevant to reasoning, we select the top- _k_ most important tokens, determined by prompting\nQwen3-30B LLM (Yang et al., 2025), yielding an index set _Ik_ with _|Ik|_ = _k_ . For each index\n_j ∈Ik_, we extract the corresponding attention head activations _Xj_, and compute the averaged\nactivation feature for the _m_ -th head in layer _l_ as ¯ _x_ _[m]_ _l_ = _k_ [1] � _j ∈Ikxml_ [. This results in a full set of]\n\nhead-level features _X_ [¯] _i_ = _{x_ ¯ _[m]_ _l_ _[|][ l][ ∈]_ [1] _[, . . ., L, m][ ∈]_ [1] _[, . . ., M]_ _[}]_ [.]\n\n\n3.2 FUNCTION PROBING\n\n\nFor the dataset with _N_ subQAF triplets, we collect all activations to construct the probing dataset:\n\n\n_D_ probe = _{_ (¯ _x_ _[m]_ _l_ _[, c]_ [)] _[i][}][N]_ _i_ =1 _[, l][ ∈{]_ [1] _[, . . ., L][}][, m][ ∈{]_ [1] _[, . . ., M]_ _[}]_ (1)\n\n\nFor classification based on CogVision, the training set includes 1,124 main questions with 4,604\nsubQAF triplet, while the testing set has 285 main questions with 1,141 triplets. Our probe takes\nthe form _pθ_ ( _x_ _[m]_ _l_ [) = sigmoid (] _[⟨][θ, x][m]_ _l_ _[⟩]_ [)][. There is one probe per attention head per layer per function.]\nFor each target function, the probe is trained by treating the attention-head outputs that lead to\ncorrect answers for that function as the positive class, and those associated with correct answers\nfrom other functions as the negative class. To ensure data balance, we select an equal number of\nnegative samples to match the positive ones. Given prior findings suggesting that cognitive functions\nmay vary by layer depth (Zheng et al.), we incorporate layer-wise information by computing the\naverage activation ¯ _xl_ = _M_ 1 � _Mm_ =1 _[x]_ [¯] _l_ _[m]_ [for each layer. We then augment each head-level vector with]\n\n\n4\n\n\nits corresponding layer summary, resulting in enriched features _x_ _[m]_ _l_ _[′]_ = [¯ _x_ _[m]_ _l_ [; ¯] _[x][l]_ []][ for probing. The]\nimportance for each head are then calculated based on the accuracy of predicting target function. The\neffectiveness of top-k tokens and layer information, as well as the sensitivity analysis with respect\nto the parameter _k_ and the choice of LLM fused for top-k token extraction, and prompt format, can\nbe found in Appendix A.8.\n\n\n4 EXPERIMENTS\n\n\nWe conduct a series of experiments on three VLM families across various model scales, including\nIntern (Zhu et al., 2025) (InternVL3-8B and InternVL3-2B), Qwen (Yang et al., 2025) (Qwen2.5VL-7B and Qwen2.5-VL-3B), and Gemma (Team et al., 2025) (Gemma3-4B and Gemma3-2B).\nWe analyze the commonalities and differences of functional heads (Subsection 4.1), validate their\ncontributions (Subsection 4.2), and examine correlations, including cross-function interactions and\nhierarchical organization (Subsection 4.3). We also assess their causal impact on downstream reasoning tasks (Subsection 4.4). Results confirm the existence of sparse, function-specific heads and\nhighlight their critical contribution to structured cognitive processing within VLMs.\n\n\n4.1 PROPERTIES OF COGNITIVE HEADS\n\n\n**Sparsity, Universality, and Intrinsic Organization:** Fig 2 shows the heatmap of attention head\naccuracy across eight functions in Qwen2.5-VL-7B on the CogVision test set, revealing a sparse\ndistribution. In total, fewer than 7% of all heads achieve accuracies above 0.9 across the eight functions (about 2% for high-level visual reception and math reasoning, and less than 1% for the others),\nsuggesting that only a small subset of heads meaningfully contributes to different reasoning tasks.\nThese results demonstrate that VLMs rely on highly specialized, localized components for distinct\ncognitive abilities. Pearson correlations between head-activation heatmaps across the eight functions\n(Fig. 3) are generally low, confirming that different functions tend to depend on partially separable\nsubsets of heads. Moreover, this sparse functional organization is consistent across architectures\nand scales: heatmaps for five additional models (Appendix A.4) confirm its universality, and the\nrelatively high Pearson correlation coefficients between models further verify this consistency (in\nAppendix A.9). Within the same model family (e.g., Qwen2.5-VL-7B in Fig 2 vs. Qwen2.5-VL-3B\nin Fig 8), we observe similar distributions, suggesting that such specialization is intrinsic to VLMs.\n\n\n**Functional Personalization:** Beyond sparsity, attention heads exhibit a structured distribution\nacross model layers. Math-related heads are dispersed throughout the network, whereas inferencerelated heads appear more frequently in higher layers. This task-dependent localization suggests an\nemergent modular organization in which different layers support distinct cognitive operations. We\nalso observe notable variation in head counts across functions. For example, in the Qwen family,\nmath reasoning and high-level visual reception heads are more prevalent than others, reflecting differences in representational and computational complexity. Smaller models contain fewer functional\nheads compared to their larger counterparts.\n\n\n4.2 FUNCTIONAL CONTRIBUTIONS OF COGNITIVE HEADS\n\n\nAfter identifying the cognitive heads associated with each function, we examine their functional\nroles by evaluating the model’s behavior on the CogVision test set under targeted interventions. We\nperform head ablation by scaling the output of a specific attention head with a small factor _ϵ_ (e.g.,\n0.001), effectively suppressing its contribution:\n\n\n\n�\n\n\n\n_x_ [mask] _i_ = Softmax\n\n\n\n_Wq_ _[i][W][ iT]_ _k_\n� ~~�~~ _dk/n_\n\n\n\n\n_· ϵWv_ _[i]_ (2)\n\n\n\nSpecifically, we compare model performance when masking identified cognitive heads versus masking an equal number of randomly-selected heads. To quantify the impact, we employ both an LLMbased judge and an integrated accuracy metric. For LLM-based judge, we use LLM (Qwen3-30B\nLLM (Yang et al., 2025)) to judge the correctness of the output. For the integrated accuracy metric,\nan output is considered unaffected if its BLEU score (Papineni et al., 2002) exceeds 0.8, or if either\n\n\n5\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png)\n\nFigure 2: The existence of cognitive heads in Qwen2.5-VL-7B responsible for eight distinct functions in complex reasoning tasks. The x-axis represents the head index, while the y-axis indicates\nthe layer index. The values denote head importance scores, capped at a cutoff of 0.60.\n\n\nFigure 3: Pearson Correlation between different functions across two models.\n\n\nthe ROUGE score (Chin-Yew, 2004) or the semantic similarity score surpasses 0.6. This provides a\ncomprehensive evaluation of performance degradation."}, {"chunk_id": "attention_is_all_you_need_raw_chunks_2k_1", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl", "metadata": {"source": "attention_is_all_you_need_raw.md", "chunk_id": "attention_is_all_you_need_raw_chunks_2k_1", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, "text": "[10], consuming the previously generated symbols as additional input when generating the next.\n\n\n2\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png)\n\nFigure 1: The Transformer - model architecture.\n\n\nThe Transformer follows this overall architecture using stacked self-attention and point-wise, fully\nconnected layers for both the encoder and decoder, shown in the left and right halves of Figure 1,\nrespectively.\n\n\n**3.1** **Encoder and Decoder Stacks**\n\n\n**Encoder:** The encoder is composed of a stack of _N_ = 6 identical layers. Each layer has two\nsub-layers. The first is a multi-head self-attention mechanism, and the second is a simple, positionwise fully connected feed-forward network. We employ a residual connection [11] around each of\nthe two sub-layers, followed by layer normalization [1]. That is, the output of each sub-layer is\nLayerNorm( _x_ + Sublayer( _x_ )), where Sublayer( _x_ ) is the function implemented by the sub-layer\nitself. To facilitate these residual connections, all sub-layers in the model, as well as the embedding\nlayers, produce outputs of dimension _d_ model = 512.\n\n\n**Decoder:** The decoder is also composed of a stack of _N_ = 6 identical layers. In addition to the two\nsub-layers in each encoder layer, the decoder inserts a third sub-layer, which performs multi-head\nattention over the output of the encoder stack. Similar to the encoder, we employ residual connections\naround each of the sub-layers, followed by layer normalization. We also modify the self-attention\nsub-layer in the decoder stack to prevent positions from attending to subsequent positions. This\nmasking, combined with fact that the output embeddings are offset by one position, ensures that the\npredictions for position _i_ can depend only on the known outputs at positions less than _i_ .\n\n\n**3.2** **Attention**\n\n\nAn attention function can be described as mapping a query and a set of key-value pairs to an output,\nwhere the query, keys, values, and output are all vectors. The output is computed as a weighted sum\n\n\n3\n\n\nScaled Dot-Product Attention Multi-Head Attention\n\n\nFigure 2: (left) Scaled Dot-Product Attention. (right) Multi-Head Attention consists of several\nattention layers running in parallel.\n\n\nof the values, where the weight assigned to each value is computed by a compatibility function of the\nquery with the corresponding key.\n\n\n**3.2.1** **Scaled Dot-Product Attention**\n\n\nWe call our particular attention \"Scaled Dot-Product Attention\" (Figure 2). The input consists of\nqueries and keys of dimension _dk_, and values of dimension _dv_ . We compute the dot products of the\nquery with all keys, divide each by _[√]_ _dk_, and apply a softmax function to obtain the weights on the\nvalues.\n\n\nIn practice, we compute the attention function on a set of queries simultaneously, packed together\ninto a matrix _Q_ . The keys and values are also packed together into matrices _K_ and _V_ . We compute\nthe matrix of outputs as:\n\n\nAttention( _Q, K, V_ ) = softmax( _[Q][K]_ _[T]_ ) _V_ (1)\n\n~~_√_~~ _dk_\n\n\nThe two most commonly used attention functions are additive attention [2], and dot-product (multiplicative) attention. Dot-product attention is identical to our algorithm, except for the scaling factor\nof ~~_√_~~ 1 _dk_ . Additive attention computes the compatibility function using a feed-forward network with\na single hidden layer. While the two are similar in theoretical complexity, dot-product attention is\nmuch faster and more space-efficient in practice, since it can be implemented using highly optimized\nmatrix multiplication code.\n\n\nWhile for small values of _dk_ the two mechanisms perform similarly, additive attention outperforms\ndot product attention without scaling for larger values of _dk_ [3]. We suspect that for large values of\n_dk_, the dot products grow large in magnitude, pushing the softmax function into regions where it has\nextremely small gradients [4] . To counteract this effect, we scale the dot products by ~~_√_~~ 1 _dk_ .\n\n\n**3.2.2** **Multi-Head Attention**\n\n\nInstead of performing a single attention function with _d_ model-dimensional keys, values and queries,\nwe found it beneficial to linearly project the queries, keys and values _h_ times with different, learned\nlinear projections to _dk_, _dk_ and _dv_ dimensions, respectively. On each of these projected versions of\nqueries, keys and values we then perform the attention function in parallel, yielding _dv_ -dimensional\n\n\n4To illustrate why the dot products get large, assume that the components of _q_ and _k_ are independent random\nvariables with mean 0 and variance 1. Then their dot product, _q · k_ = [�] _[d]_ _i_ =1 _[k]_ _[q][i][k][i]_ [, has mean][ 0][ and variance] _[ d][k]_ [.]\n\n\n4\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png)\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png)\noutput values. These are concatenated and once again projected, resulting in the final values, as\ndepicted in Figure 2.\n\n\nMulti-head attention allows the model to jointly attend to information from different representation\nsubspaces at different positions. With a single attention head, averaging inhibits this.\n\n\nMultiHead( _Q, K, V_ ) = Concat(head1 _, ...,_ headh) _W_ _[O]_\n\nwhere headi = Attention( _QWi_ _[Q][, KW][ K]_ _i_ _[, V W][ V]_ _i_ [)]\n\n\nWhere the projections are parameter matrices _Wi_ _[Q]_ _∈_ R _[d]_ [model] _[×][d][k]_, _Wi_ _[K]_ _∈_ R _[d]_ [model] _[×][d][k]_, _Wi_ _[V]_ _∈_ R _[d]_ [model] _[×][d][v]_\nand _W_ _[O]_ _∈_ R _[hd][v][×][d]_ [model] .\n\n\nIn this work we employ _h_ = 8 parallel attention layers, or heads. For each of these we use\n_dk_ = _dv_ = _d_ model _/h_ = 64. Due to the reduced dimension of each head, the total computational cost\nis similar to that of single-head attention with full dimensionality.\n\n\n**3.2.3** **Applications of Attention in our Model**\n\n\nThe Transformer uses multi-head attention in three different ways:\n\n\n    - In \"encoder-decoder attention\" layers, the queries come from the previous decoder layer,\nand the memory keys and values come from the output of the encoder. This allows every\nposition in the decoder to attend over all positions in the input sequence. This mimics the\ntypical encoder-decoder attention mechanisms in sequence-to-sequence models such as\n\n[38, 2, 9].\n\n\n    - The encoder contains self-attention layers. In a self-attention layer all of the keys, values\nand queries come from the same place, in this case, the output of the previous layer in the\nencoder. Each position in the encoder can attend to all positions in the previous layer of the\nencoder.\n\n\n    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to\nall positions in the decoder up to and including that position. We need to prevent leftward\ninformation flow in the decoder to preserve the auto-regressive property. We implement this\ninside of scaled dot-product attention by masking out (setting to _−∞_ ) all values in the input\nof the softmax which correspond to illegal connections. See Figure 2."}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_4", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl", "metadata": {"source": "neuronal_attention_circuits_raw.md", "chunk_id": "neuronal_attention_circuits_raw_chunks_2k_4", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, "text": "**2.3. NAC as Universal Approximator**\n\n\nWe now establish the universal approximation capability of\nNAC by extending the classical Universal Approximation\nTheorem (UAT) (Nishijima, 2021) to the proposed mechanism. For brevity, we consider a network with a single\nNAC layer processing fixed-dimensional inputs, though the\nargument generalizes to sequences.\n\n\n**Theorem 2** (Universal Approximation by NAC) **.** _Let K ⊂_\nR _[n]_ _be a compact set and f_ : _K →_ R _[m]_ _be a continuous_\n_function. For any ϵ >_ 0 _, there exists a neural network_\n_consisting of a single NAC layer, with sufficiently large_\n_model dimension dmodel, number of heads H, sparsity s,_\n_and nonlinear activations, such that the network’s output_\n_g_ : R _[n]_ _→_ R _[m]_ _satisfies_\n\n\nsup _∥f_ ( _x_ ) _−_ _g_ ( _x_ ) _∥_ _< ϵ._ (20)\n_x∈K_\n\n\n_The proof is provided in Appendix B.3._\n\n\n**3. Evaluation**\n\n\nWe evaluate the proposed architecture against a range of\nbaselines, including (DT & CT) RNN, (DT & CT) attention,\nand multiple NAC ablation configurations. Experiments\nare conducted across diverse domains, including irregular\ntime-series modeling, lane keeping of autonomous vehicles,\nand Industry 4.0 prognostics. All results are obtained using 5-fold cross-validation, where models are trained using\nBPTT (see Appendix C.2) on each fold and evaluated across\nall folds. We report the mean ( _µ_ ) and standard deviation ( _σ_ )\nto capture variability and quantify uncertainty in the predictions. Table 1 provides results for all experiments, and the\ndetails of the baselines, ablation, environment utilized, the\ndata curation and preprocessing, and neural network architectures for all experiments are provided in the Appendix\nD.3.\n\n\n**3.1. Irregular Time-series**\n\n\nWe evaluate the proposed architecture on two irregular timeseries datasets: (i) Event-based MNIST; and (ii) Person\nActivity Recognition (PAR).\n\n\n\nFor finite _t_, the exponential factor (1 _−_ _e_ _[−][ω][τ][ t]_ ) regulates the\nbuildup of attention, giving _ωτ_ a temporal gating role. Normalizing across all keys via _softmax_ yields attention weights\n_αt_ = softmax( _at_ ), defining a valid probability distribution\nwhere _ϕ_ amplifies or suppresses content alignments, and _ωτ_\nshapes both the speed and saturation of these preferences.\nAs _t →∞_, the trajectory converges to the steady state\n\n\n_a_ _[∗]_ _t_ [=] _[ϕ]_ _≈_ _[q][⊤][k]_ _,_ (18)\n\n_ωτ_ ~~_√_~~ _dk_\n\n\nwhich is analogous to scaled-dot attention under specific\nparameterization when the backbone _NN_ backbone is configured as a linear projection such that _ϕ_ ( **u** ) = _q_ _[⊤]_ _k_ and\n_ωτ_ ( _u_ ) = _[√]_ _dk_ (e.g., by setting NCP weights to emulate\nbilinear forms and disabling nonlinearities). In general, the\nnonlinear backbone allows for more expressive similarities,\nwith the approximation holding when trained to mimic dot\nproducts.\n**Attention output:** Finally, the attention output is computed\nby integrating the attention weights with the value matrix:\n\n\nNAC( _q, k, v_ ) = _αtvtdt_ (19)\n� _T_\n\n\nIn practice, the integration is approximated using a Riemannstyle approach, where the weighted elements are computed\nby multiplying each _vt_ with its corresponding _αt_ . These are\nthen summed and multiplied by a fixed pseudo-time step\n_δt_, chosen as a scalar (typically between 0.5–1.0) hyperparameter during layer initialization. This yields a continuous\nanalogue of standard weighted sums, giving finer resolution\nof the attention trajectory without altering the underlying\nvalues. Sensitivity to attention output w.r.t _δt_ is visualized\nin Appendix D.2.\n\n\n2.2.1. EXTENSION TO MULTI-HEAD\n\n\nTo scale this mechanism to multi-head attention, we project\nthe input sequence into _H_ independent subspaces (heads)\nof dimension _d_ model _/H_, yielding query, key, and value tensors ( _q_ [(] _[h]_ [)] _, k_ [(] _[h]_ [)] _, v_ [(] _[h]_ [)] ) for _h ∈{_ 1 _, . . ., H}_ . For each head,\npairwise logits are computed according to Eqns. 2,3 or 18,\n\n\n\n5\n\n\n**Neuronal Attention Circuit (NAC) for Representation Learning**\n\n\n_Figure 2._ Illustration of the architecture of **(a)** Neuronal Attention Circuit mechanism ; **(b)** Multi-Head Extension\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png)\n\n**Event-based MNIST:** Event-based MNIST is the trans\nformation of the widely recognized MNIST dataset with\nirregular sampling added originally proposed in (Lechner\n& Hasani, 2022). The transformation was done in two\nsteps: (i) flattening each 28×28 image into a time series\nof length 784, and (ii) encoding the binary time series into\nan event-based format by collapsing consecutive identical\nvalues (e.g., 1,1,1,1 → (1, t=4)). This representation requires models to handle temporal dependencies effectively.\nNAC-PW achieved first place with an accuracy of 96.64%,\nfollowed by NAC-Exact/05s/8k at 96.12%. GRU-ODE and\nContiFormer ranked third with 96.04%.\n\n**Person Activity Recognition (PAR):** We employed the\nLocalized Person Activity dataset from UC Irvine (Vidulin\net al., 2010). The dataset contains data from five participants,\neach equipped with inertial measurement sensors sampled\nevery 211 ms. The goal of this experiment is to predict a\nperson’s activity from a set of predefined actions, making it\na classification task. All models performed well on this task,\nwith NAC-PW achieving 89.15% accuracy and taking first\nplace. NAC-Exact/05s/8k and GRU-ODE ranked second\nwith 89.01% accuracy, while NAC-02s ranked third with\n88.84% mean accuracy.\n\n\n**3.2. Lane-Keeping of Autonomous Vehicles**\n\n\nLane keeping in autonomous vehicles (AVs) is a fundamental problem in robotics and AI. Early works (Tiang et al.,\n2018; Park et al., 2021) primarily emphasized accuracy,\noften relying on large models. More recent research (Lechner et al., 2020; Razzaq & Hongwei, 2023) has shifted toward designing compact architectures suitable for resourceconstrained devices. The goal of this experiment is to create\na long causal structure between the road’s horizon and the"}], "retrieved_graph_subgraph": {"nodes": [{"id": "Attention mechanism", "properties": {"id": "Attention mechanism"}, "labels": ["Concept"]}, {"id": "attention heads", "properties": {"id": "attention heads"}, "labels": ["Concept"]}, {"id": "attention patterns", "properties": {"id": "attention patterns"}, "labels": ["Concept"]}, {"id": "anaphora resolution", "properties": {"id": "anaphora resolution"}, "labels": ["Concept"]}, {"id": "Attention weights", "properties": {"id": "Attention weights"}, "labels": ["Concept"]}, {"id": "c35df05545627694d3b4bbf52619a5da", "properties": {"chunk_index": "0", "chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "source_type": "chunk", "id": "c35df05545627694d3b4bbf52619a5da", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0", "chunk_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0"}, "labels": ["Document"]}, {"id": "888d0bd62e26d30498c9f50b218a6001", "properties": {"chunk_index": "2", "chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "source_type": "chunk", "id": "888d0bd62e26d30498c9f50b218a6001", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2", "chunk_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2"}, "labels": ["Document"]}, {"id": "36f927c2ec5951b1af0611a9728d214b", "properties": {"derived_from_chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "markdown_source": "attention_is_all_you_need_raw_with_image_ids_with_captions.md", "source_type": "markdown", "id": "36f927c2ec5951b1af0611a9728d214b", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions.md::images", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions.md::images"}, "labels": ["Document"]}, {"id": "img_attention_is_all_you_need_12_0", "properties": {"id": "img_attention_is_all_you_need_12_0", "source_path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png"}, "labels": ["Image"]}, {"id": "Transformer", "properties": {"id": "Transformer"}, "labels": ["Model"]}, {"id": "Encoder-decoder architectures", "properties": {"id": "Encoder-decoder architectures"}, "labels": ["Model"]}, {"id": "Active memory", "properties": {"id": "Active memory"}, "labels": ["Concept"]}, {"id": "93ec065e0391e99e3dd12c28af8c5ff9", "properties": {"chunk_index": "1", "chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "source_type": "chunk", "id": "93ec065e0391e99e3dd12c28af8c5ff9", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1", "chunk_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1"}, "labels": ["Document"]}, {"id": "img_attention_is_all_you_need_13_0", "properties": {"id": "img_attention_is_all_you_need_13_0", "source_path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png"}, "labels": ["Image"]}, {"id": "img_attention_is_all_you_need_14_0", "properties": {"id": "img_attention_is_all_you_need_14_0", "source_path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png"}, "labels": ["Image"]}], "edges": [{"source": "c35df05545627694d3b4bbf52619a5da", "type": "MENTIONS", "properties": {}, "target": "Attention mechanism"}, {"source": "888d0bd62e26d30498c9f50b218a6001", "type": "MENTIONS", "properties": {}, "target": "Attention mechanism"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "Attention mechanism"}, {"source": "img_attention_is_all_you_need_12_0", "type": "DEPICTS", "properties": {}, "target": "Attention mechanism"}, {"source": "Transformer", "type": "BUILDS_ON", "properties": {}, "target": "Attention mechanism"}, {"source": "Encoder-decoder architectures", "type": "BUILDS_ON", "properties": {}, "target": "Attention mechanism"}, {"source": "Active memory", "type": "COMPARED_WITH", "properties": {}, "target": "Attention mechanism"}, {"source": "Transformer", "type": "EXTENDS", "properties": {}, "target": "Attention mechanism"}, {"source": "93ec065e0391e99e3dd12c28af8c5ff9", "type": "MENTIONS", "properties": {}, "target": "attention heads"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "attention heads"}, {"source": "img_attention_is_all_you_need_13_0", "type": "DEPICTS", "properties": {}, "target": "attention heads"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "attention patterns"}, {"source": "img_attention_is_all_you_need_13_0", "type": "DEPICTS", "properties": {}, "target": "attention patterns"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "anaphora resolution"}, {"source": "img_attention_is_all_you_need_13_0", "type": "DEPICTS", "properties": {}, "target": "anaphora resolution"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "Attention weights"}, {"source": "img_attention_is_all_you_need_14_0", "type": "DEPICTS", "properties": {}, "target": "Attention weights"}]}, "final_answer": "While the provided text and graph contexts indicate a relationship between anaphora resolution and attention mechanisms, neither source explicitly details *how* anaphora resolution is done using attention.\n\nThe graph context shows that \"anaphora resolution\" is a concept mentioned in relation to \"Attention mechanism\" within the \"Attention Is All You Need\" paper. This paper introduces the Transformer model, which relies solely on attention mechanisms.\n\nThe text context, primarily from the \"Attention Is All You Need\" paper, explains the general workings of attention mechanisms, particularly self-attention:\n*   **Self-attention layers** in the encoder allow each position to attend to all positions in the previous layer, enabling the model to relate different positions of a single sequence to compute a representation.\n*   **Self-attention layers** in the decoder allow each position to attend to all preceding positions.\n*   Attention mechanisms allow models to focus on the most relevant observations and model dependencies without regard to their distance in the input or output sequences. This ability to connect distant parts of a sequence is crucial for tasks like anaphora resolution, where a pronoun might refer to an entity far earlier in the text.\n*   The Transformer uses multi-head attention, which allows the model to jointly attend to information from different representation subspaces at different positions.\n\nAlthough the specific steps for anaphora resolution using attention are not detailed, the underlying principle is that attention mechanisms, especially self-attention, provide a way for models to identify and weigh the relevance of different words or phrases in a sequence to each other, which is fundamental for resolving anaphoric references.\n\n**Image paths:**\n*   img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png\n*   img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png\n*   img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png\n*   img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png\n*   img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png\n*   img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png\n\n**Chunks used:**\n*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0 (source: attention_is_all_you_need_raw_with_image_ids_with_captions.md)\n*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1 (source: attention_is_all_you_need_raw_with_image_ids_with_captions.md)\n*   attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2 (source: attention_is_all_you_need_raw_with_image_ids_with_captions.md)", "token_usage": null, "latency_ms": {"rag": 3886, "graph": 10388, "synthesis": 8221, "total": 22502}, "internal": {"rag": {"query": "how is anaphora resolution done using attention mechanism?", "rewritten_or_decomposed_queries": ["anaphora resolution attention mechanism", "attention-based anaphora resolution models", "using attention for coreference resolution", "anaphora resolution with neural attention"], "k_per_subquery": 3, "retrieved_chunks": [{"chunk_id": "attention_is_all_you_need_raw_chunks_2k_2", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl", "metadata": {"source": "attention_is_all_you_need_raw.md", "chunk_id": "attention_is_all_you_need_raw_chunks_2k_2", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, "text": "[38, 2, 9].\n\n\n    - The encoder contains self-attention layers. In a self-attention layer all of the keys, values\nand queries come from the same place, in this case, the output of the previous layer in the\nencoder. Each position in the encoder can attend to all positions in the previous layer of the\nencoder.\n\n\n    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to\nall positions in the decoder up to and including that position. We need to prevent leftward\ninformation flow in the decoder to preserve the auto-regressive property. We implement this\ninside of scaled dot-product attention by masking out (setting to _−∞_ ) all values in the input\nof the softmax which correspond to illegal connections. See Figure 2.\n\n\n**3.3** **Position-wise Feed-Forward Networks**\n\n\nIn addition to attention sub-layers, each of the layers in our encoder and decoder contains a fully\nconnected feed-forward network, which is applied to each position separately and identically. This\nconsists of two linear transformations with a ReLU activation in between.\n\n\nFFN( _x_ ) = max(0 _, xW_ 1 + _b_ 1) _W_ 2 + _b_ 2 (2)\n\n\nWhile the linear transformations are the same across different positions, they use different parameters\nfrom layer to layer. Another way of describing this is as two convolutions with kernel size 1.\nThe dimensionality of input and output is _d_ model = 512, and the inner-layer has dimensionality\n_dff_ = 2048.\n\n\n**3.4** **Embeddings and Softmax**\n\n\nSimilarly to other sequence transduction models, we use learned embeddings to convert the input\ntokens and output tokens to vectors of dimension _d_ model. We also use the usual learned linear transformation and softmax function to convert the decoder output to predicted next-token probabilities. In\nour model, we share the same weight matrix between the two embedding layers and the pre-softmax\nlinear transformation, similar to [30]. In the embedding layers, we multiply those weights by _[√]_ _d_ model.\n\n\n5\n\n\nTable 1: Maximum path lengths, per-layer complexity and minimum number of sequential operations\nfor different layer types. _n_ is the sequence length, _d_ is the representation dimension, _k_ is the kernel\nsize of convolutions and _r_ the size of the neighborhood in restricted self-attention.\n\n\nLayer Type Complexity per Layer Sequential Maximum Path Length\nOperations\nSelf-Attention _O_ ( _n_ [2] _· d_ ) _O_ (1) _O_ (1)\nRecurrent _O_ ( _n · d_ [2] ) _O_ ( _n_ ) _O_ ( _n_ )\nConvolutional _O_ ( _k · n · d_ [2] ) _O_ (1) _O_ ( _logk_ ( _n_ ))\nSelf-Attention (restricted) _O_ ( _r · n · d_ ) _O_ (1) _O_ ( _n/r_ )\n\n\n**3.5** **Positional Encoding**\n\n\nSince our model contains no recurrence and no convolution, in order for the model to make use of the\norder of the sequence, we must inject some information about the relative or absolute position of the\ntokens in the sequence. To this end, we add \"positional encodings\" to the input embeddings at the\nbottoms of the encoder and decoder stacks. The positional encodings have the same dimension _d_ model\nas the embeddings, so that the two can be summed. There are many choices of positional encodings,\nlearned and fixed [9].\n\n\nIn this work, we use sine and cosine functions of different frequencies:\n\n\n_PE_ ( _pos,_ 2 _i_ ) = _sin_ ( _pos/_ 10000 [2] _[i/d]_ [model] )\n\n_PE_ ( _pos,_ 2 _i_ +1) = _cos_ ( _pos/_ 10000 [2] _[i/d]_ [model] )\n\n\nwhere _pos_ is the position and _i_ is the dimension. That is, each dimension of the positional encoding\ncorresponds to a sinusoid. The wavelengths form a geometric progression from 2 _π_ to 10000 _·_ 2 _π_ . We\nchose this function because we hypothesized it would allow the model to easily learn to attend by\nrelative positions, since for any fixed offset _k_, _PEpos_ + _k_ can be represented as a linear function of\n_PEpos_ .\n\n\nWe also experimented with using learned positional embeddings [9] instead, and found that the two\nversions produced nearly identical results (see Table 3 row (E)). We chose the sinusoidal version\nbecause it may allow the model to extrapolate to sequence lengths longer than the ones encountered\nduring training.\n\n\n**4** **Why Self-Attention**\n\n\nIn this section we compare various aspects of self-attention layers to the recurrent and convolutional layers commonly used for mapping one variable-length sequence of symbol representations\n( _x_ 1 _, ..., xn_ ) to another sequence of equal length ( _z_ 1 _, ..., zn_ ), with _xi, zi ∈_ R _[d]_, such as a hidden\nlayer in a typical sequence transduction encoder or decoder. Motivating our use of self-attention we\nconsider three desiderata.\n\n\nOne is the total computational complexity per layer. Another is the amount of computation that can\nbe parallelized, as measured by the minimum number of sequential operations required.\n\n\nThe third is the path length between long-range dependencies in the network. Learning long-range\ndependencies is a key challenge in many sequence transduction tasks. One key factor affecting the\nability to learn such dependencies is the length of the paths forward and backward signals have to\ntraverse in the network. The shorter these paths between any combination of positions in the input\nand output sequences, the easier it is to learn long-range dependencies [12]. Hence we also compare\nthe maximum path length between any two input and output positions in networks composed of the\ndifferent layer types.\n\n\nAs noted in Table 1, a self-attention layer connects all positions with a constant number of sequentially\nexecuted operations, whereas a recurrent layer requires _O_ ( _n_ ) sequential operations. In terms of\ncomputational complexity, self-attention layers are faster than recurrent layers when the sequence\n\n\n6\n\n\nlength _n_ is smaller than the representation dimensionality _d_, which is most often the case with\nsentence representations used by state-of-the-art models in machine translations, such as word-piece\n\n[38] and byte-pair [31] representations. To improve computational performance for tasks involving\nvery long sequences, self-attention could be restricted to considering only a neighborhood of size _r_ in\nthe input sequence centered around the respective output position. This would increase the maximum\npath length to _O_ ( _n/r_ ). We plan to investigate this approach further in future work.\n\n\nA single convolutional layer with kernel width _k < n_ does not connect all pairs of input and output\npositions. Doing so requires a stack of _O_ ( _n/k_ ) convolutional layers in the case of contiguous kernels,\nor _O_ ( _logk_ ( _n_ )) in the case of dilated convolutions [18], increasing the length of the longest paths\nbetween any two positions in the network. Convolutional layers are generally more expensive than\nrecurrent layers, by a factor of _k_ . Separable convolutions [6], however, decrease the complexity\nconsiderably, to _O_ ( _k · n · d_ + _n · d_ [2] ). Even with _k_ = _n_, however, the complexity of a separable\nconvolution is equal to the combination of a self-attention layer and a point-wise feed-forward layer,\nthe approach we take in our model.\n\n\nAs side benefit, self-attention could yield more interpretable models. We inspect attention distributions\nfrom our models and present and discuss examples in the appendix. Not only do individual attention\nheads clearly learn to perform different tasks, many appear to exhibit behavior related to the syntactic\nand semantic structure of the sentences.\n\n\n**5** **Training**\n\n\nThis section describes the training regime for our models.\n\n\n**5.1** **Training Data and Batching**"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_0", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl", "metadata": {"source": "neuronal_attention_circuits_raw.md", "chunk_id": "neuronal_attention_circuits_raw_chunks_2k_0", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, "text": "## **Neuronal Attention Circuit (NAC) for Representation Learning**\n\n**Waleed Razzaq** [1] **Izis Kankaraway** [1] **Yun-Bo Zhao** [1 2]\n\n\n\n**Abstract**\n\nAttention improves representation learning over\nRNNs, but its discrete nature limits continuoustime (CT) modeling. We introduce Neuronal Attention Circuit (NAC), a novel, biologically plausible CT-Attention mechanism that reformulates\n\nattention logits computation as the solution to a\nlinear first-order ODE with nonlinear interlinked\ngates derived from repurposing _C. elegans_ Neuronal Circuit Policies (NCPs) wiring mechanism.\nNAC replaces dense projections with sparse sensory gates for key-query projections and a sparse\nbackbone network with two heads for computing\n_content-target_ and _learnable time-constant_ gates,\nenabling efficient adaptive dynamics. NAC supports three attention logit computation modes: (i)\nexplicit Euler integration, (ii) exact closed-form\nsolution, and (iii) steady-state approximation. To\nimprove memory intensity, we implemented a\nsparse Top- _K_ pairwise concatenation scheme that\nselectively curates key-query interactions. We\nprovide rigorous theoretical guarantees, including\nstate stability, bounded approximation errors, and\nuniversal approximation. Empirically, we implemented NAC in diverse domains, including irregular time-series classification, lane-keeping for\nautonomous vehicles, and industrial prognostics.\nWe observed that NAC matches or outperforms\ncompeting baselines in accuracy and occupies an\nintermediate position in runtime and memory efficiency compared with several CT baselines.\n\n\n**1. Introduction**\n\n\nLearning representations of sequential data in temporal or\nspatio-temporal domains is essential for capturing patterns\nand enabling accurate forecasting. Discrete-time Recurrent neural networks (DT-RNNs) such as RNN (Rumelhart et al., 1985; Jordan, 1997), Long-short term memory\n\n\n1Department of Automation, University of Science & Technology of China, Hefei, China [2] Institute of Artificial Intelligence,\nHefei Comprehensive National Science Center. Correspondence to:\nYun-Bo Zhao _<_ ybzhao@ustc.edu.cn _>_, Waleed Razzaq _<_ waleedrazzaq@mail.ustc.edu.cn _>_ .\n\n\n_Preprint. December 12, 2025._\n\n\n\n(LSTM) (Hochreiter & Schmidhuber, 1997), and Gated Recurrent Unit (GRU) (Cho et al., 2014) model sequential dependencies by iteratively updating hidden states to represent\nor predict future elements in a sequence. While effective\nfor regularly sampled sequences, DT-RNNs face challenges\nwith irregularly sampled data because they assume uniform\ntime intervals. In addition, vanishing gradients can make\nit difficult to capture long-term dependencies (Hochreiter,\n1998).\nContinuous-time RNNs (CT-RNNs) (Rubanova et al., 2019)\nmodel hidden states as ordinary differential equations\n(ODEs), allowing them to process inputs that arrive at arbitrary or irregular time intervals. Mixed-memory RNNs\n(mmRNNs) (Lechner & Hasani, 2022) build on this idea\nby separating memory compartments from time-continuous\nstates, helping maintain stable error propagation while capturing continuous-time dynamics. Liquid neural networks\n(LNNs) (Hasani et al., 2021; 2022) take a biologically inspired approach by assigning variable time-constants to hidden states, improving adaptability and robustness, though\nvanishing gradients can still pose challenges during training.\nThe attention mechanisms (Vaswani et al., 2017) mitigate\nthis limitation by treating all time steps equally and allowing models to focus on the most relevant observations. It\ncomputes the similarity between queries ( _q_ ) and keys ( _k_ ),\nscaling by the key dimension to keep gradients stable. MultiHead Attention (MHA) (Vaswani et al., 2017) extends this\nby allowing the model to attend to different representation\nsubspaces in parallel. Variants like Sparse Attention (Tay\net al., 2020; Roy et al., 2021), BigBird (Zaheer et al., 2020),\nand Longformer (Beltagy et al., 2020) modify the attention\npattern to reduce computational cost, particularly for long sequences, by attending only to selected positions rather than\nall pairs. Even with these improvements, attention-based\nmethods still rely on discrete scaled dot-product operations,\nlimiting their ability to model continuous trajectories often\ncaptured by CT counterparts.\nRecent work has explored bridging this gap through NeuralODE (Chen et al., 2018) formulation. mTAN (Shukla &\nMarlin, 2021) learns CT embeddings and uses time-based\nattention to interpolate irregular observations into a fixedlength representation for downstream encoder-decoder modeling. ODEFormer (d’Ascoli et al., 2023) trains a sequenceto-sequence transformer on synthetic trajectories to directly\ninfer symbolic ODE systems from noisy, irregular data,\nthough it struggles with chaotic systems and generalization\n\n\n\n1\n\n\n**Neuronal Attention Circuit (NAC) for Representation Learning**\n\n\n\nbeyond observed conditions. Continuous-time Attention\n(CTA) (Chien & Chen, 2021) embeds a continuous-time\nattention mechanism within a Neural ODE, allowing attention weights and hidden states to evolve jointly over time.\nStill, it remains computationally intensive and sensitive to\nthe accuracy of the ODE solver. ContiFormer (Chen et al.,\n2023) builds a CT-transformer by pairing ODE-defined latent trajectories with a time-aware attention mechanism to\nmodel dynamic relationships in data.\nDespite these innovations, a persistent and underexplored\ngap remains in developing a biologically plausible attention\nmechanism that seamlessly integrates CT dynamics with the\nabstraction of the brain’s connectome to handle irregular sequences without prohibitive computational costs. Building\non this, we propose a novel attention mechanism called the\n_Neuronal Attention Circuit_ (NAC), in which attention logits\nare computed as the solution to a first-order ODE modulated\nby nonlinear, interlinked gates derived from repurposing\nNeuronal Circuit Policies (NCPs) from the nervous system\nof _C. elegans_ nematode (refer to Appendix A.2 for more\ninformation). Unlike standard attention, which projects keyquery pairs through a dense layer, NAC employs a sensory\ngate to transform input features and a backbone to model\nnonlinear interactions, with multiple heads producing outputs structured for attention logits computation. Based on\nthe solutions to ODE, we define three computation modes:\n(i) Exact, using the closed-form ODE solution; (ii) Euler,\napproximating the solution via _explicit Euler_ integration;\nand (iii) Steady, using only the steady-state solution, analogous to standard attention scores. To reduce computational\ncomplexity, we implemented a sparse Top- _K_ pairwise concatenation algorithm that selectively curates key-query inputs. We evaluate NAC across multiple domains, including\nirregularly sampled time series, autonomous vehicle lanekeeping, and Industry 4.0, comparing it to state-of-the-art\nbaselines. NAC consistently matches or outperforms these\nmodels, while runtime and peak memory benchmarks place\nit between CT-RNNs in terms of speed and CT-Attentions\nin terms of memory requirements.\n\n\n**2. Neuronal Attention Circuit (NAC)**\n\n\nWe propose a simple alternative formulation of the attention\nlogits _a_ (refer to Appendix A.1 for more information), interpreting them as the solution to a first-order linear ODE\nmodulated by nonlinear, interlinked gates:\n\n\n\nfrom repurposing NCPs. We refer to this formulation as\nthe Neuronal Attention Circuit (NAC). It enables the logits\n_at_ to evolve dynamically with input-dependent, variable\ntime constants, mirroring the adaptive temporal dynamics\nfound in _C. elegans_ nervous systems while improving\ncomputational efficiency and expressiveness. Moreover, it\nintroduces continuous depth into the attention mechanism,\nbridging discrete-layer computation with dynamic temporal\nevolution.\n\n**Motivation behind this formulation:** The proposed\nformulation is loosely motivated by the input-dependent\ntime-constant mechanism of Liquid Neural Networks\n(LNNs), a class of CT-RNNs inspired by biological nervous\nsystems and synaptic transmission. In this framework, the\ndynamics of non-spiking neurons are described by a linear\nODE with nonlinear, interlinked gates: _ddt_ **xt** = **[x]** _τ_ **[t]** [+] **[ S][t]** _[,]_"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_3", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl", "metadata": {"source": "neuronal_attention_circuits_raw.md", "chunk_id": "neuronal_attention_circuits_raw_chunks_2k_3", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, "text": "Scores: _S ←_ _Q · K_ _[⊤]_\n\nEffective Top- _K_ : _K_ eff _←_ min( _K, Tk_ )\nIndices: _I_ topk _←_ top ~~k~~ ( _S, K_ eff)\nGather: _K_ selected _←_ gather( _K, I_ topk) _∈_ R _[B][×][H][×][T][q]_ _[×][K]_ [eff] _[×][D]_\n\nTiled: _Q_ tiled _←_ tile( _Q, K_ eff) _∈_ R _[B][×][H][×][T][q]_ _[×][K]_ [eff] _[×][D]_\n\nConcatenate: _U_ topk _←_ [ _Q_ tiled; _K_ selected ] _∈_ R _[B][×][H][×][T][q]_ _[×][K]_ [eff] _[×]_ [2] _[D]_\n\n**return** _U_ topk\n\n\n**2.2. Designing the Neural Network**\n\n\nWe now outline the design of a neural network layer guided\nby the preceding analysis. The process involves five steps:\n(i) repurposing NCPs; (ii) input curation; (iii) construction\nof the time vector ( _t_ ); (iv) computing attention logits and\nweights; and (v) generating the attention output. Figure 2\nprovides a graphical overview of NAC.\n**Repurposing NCPs:** We repurpose the NCPs framework\nby converting its fixed, biologically derived wiring (see Figure 1(a)) into a flexible recurrent architecture that allows\nconfigurable input–output mappings. Instead of enforcing\na static connectome, our approach exposes adjacency matrices as modifiable structures defining sparse input and\nrecurrent connections. This enables selective information\n\nrouting across neuron groups while retaining the original circuit topology. Decoupling wiring specifications from model\ninstantiation allows dynamic connectivity adjustments to\naccommodate different input modalities without full retraining. Algorithm 1 summarizes the steps for repurposing the\nNCPs wiring mechanism. Key features include group-wise\nmasking for neuron isolation, adaptive remapping of inputs\nand outputs for task-specific adaptation, and tunable sparsity\n_s_ to balance expressiveness and efficiency.\nIn our implementation, the sensory neuron gate ( _NN_ sensory)\nprojects the _q_, _k_, and _v_ representations (see Figure 1(b)).\nThis enables sensory neurons to maintain structured, contextaware representations rather than collapsing inputs into fully\n\n\n\nconnected layers. As a result, the network preserves locality\nand modularity, which improves information routing.\n\n\n_NN_ sensory = NCPCell( _G_ input = [ _Ns_ ] _, G_ output = [ _Ns_ ] _,_\n\n_D_ = [ _Ni, Nc, Nm_ ] _, s_ )\n(13)\nThe inter-to-motor pathways form a backbone network\n( _NN_ backbone) with branches that compute _ϕ_ and _ωτ_ (see\nFigure 1(c)). Instead of learning _ϕ_ and _ωτ_ independently,\nthis backbone allows the model to learn shared representations, enabling multiple benefits: (i) separate head layers\nenable the system to capture temporal and structural dependencies independently; (ii) accelerates convergence during\ntraining.\n\n\n_NN_ backbone = NCPCell( _G_ input = [ _Ni_ ] _, G_ output = [ _Nm_ ] _,_\n\n_D_ = [ _Ns_ ] _, s_ )\n(14)\nThe output heads are defined as:\n\n\n_ϕ_ = _σ_ ( _NN_ backbone( **u** )) (15)\n\n_ωτ_ = softplus( _NN_ backbone( **u** )) + _ε,_ _ε >_ 0 (16)\n\n\nHere, _ϕ_ serves as a _content–target gate_ head, where the\nsigmoid function _σ_ ( _·_ ) determines the target signal strength.\nIn contrast, _ωτ_ is a strictly positive _time–constant gate_ head\nthat controls the rate of convergence and the steady-state\namplitude. Conceptually, this parallels recurrent gating: _ϕ_\nregulates _what_ content to emphasize, while _ωτ_ governs _how_\n_quickly_ and _to what extent_ it is expressed.\n**Input Curation:** We experimented with different\nstrategies for constructing query–key inputs. Initially, we implemented full pairwise concatenation,\nwhere queries _Q ∈_ R _[B][×][H][×][T][q][×][D]_ are combined with\nall keys _K_ _∈_ R _[B][×][H][×][T][k][×][D]_ to form a joint tensor\n_U ∈_ R _[B][×][H][×][T][q][×][T][k][×]_ [2] _[D]_ . While this preserved complete\nfeature information and enabled expressive, learnable\nsimilarity functions, it was memory-intensive, making it impractical for longer sequences. To mitigate this, we applied\na sparse Top- _K_ optimization: for each query, we compute\npairwise scores _S_ = _Q · K_ _[⊤]_ _∈_ R _[B][×][H][×][T][q][×][T][k]_, select the\nTop- _K_ eff = min( _K, Tk_ ) keys, and construct concatenated\npairs _U_ topk _∈_ R _[B][×][H][×][T][q][×][K]_ [eff] _[×]_ [2] _[D]_ . This approach preserves\nthe most relevant interactions while substantially reducing\nmemory requirements in the concatenation and subsequent\nbackbone processing stages, allowing the method to scale\nlinearly with the sequence length in those components.\nHowever, the initial computation of _S_ remains quadratic\n(see Appendix C.3). Algorithm 2 outlines the steps required\nfor input curation.\n**Time Vector:** NAC builds on continuous-depth models\nas (Hasani et al., 2022) that adapt their temporal dynamics to the task. It constructs an internal, normalized\npseudo-time vector _t_ pseudo using a sigmoidal transformation,\n_t_ pseudo = _σ_ ( _ta · t_ + _tb_ ), where _ta_ and _tb_ are learnable affine\n\n\n\n4\n\n\n**Neuronal Attention Circuit (NAC) for Representation Learning**\n\n\n\nparameters and _σ_ is the sigmoid function. For time-varying\ndatasets (e.g., irregularly sampled series), each time point\n_t_ is derived from the sample’s timestamp, while for tasks\nwithout meaningful timing, _t_ is set to 1. The resulting _t_ pseudo\nlies in [0 _,_ 1] and provides a smooth, bounded representation\nof time for modulating the network’s dynamics.\n**Attention logits and weights:** Starting from Eqn. 3,\nconsider the trajectory of a query–key pair with initial\ncondition _a_ 0 = 0:\n\n\n\n_at_ = _[ϕ]_\n\n_ωτ_\n\n\n\n�1 _−_ _e_ _[−][ω][τ][ t]_ [�] _,_ (17)\n\n\n\nfollowed by the _softmax_ normalization to calculate attention weights. The resulting attention weights _αt_ [(] _[h]_ [)] are then\nused to integrate with the value vector _v_ [(] _[h]_ [)], producing headspecific attention outputs. Finally, these outputs are concatenated and linearly projected back into the model dimension.\nThis formulation ensures that each head learns distinct dynamic compatibilities governed by its own parameterization\nof _ϕ_ and _ωτ_, while the aggregation across heads preserves\nthe expressive capacity of the standard multi-head attention\nmechanism.\n\n\n**2.3. NAC as Universal Approximator**\n\n\nWe now establish the universal approximation capability of\nNAC by extending the classical Universal Approximation\nTheorem (UAT) (Nishijima, 2021) to the proposed mechanism. For brevity, we consider a network with a single\nNAC layer processing fixed-dimensional inputs, though the\nargument generalizes to sequences."}, {"chunk_id": "attention_is_all_you_need_raw_chunks_2k_0", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl", "metadata": {"source": "attention_is_all_you_need_raw.md", "chunk_id": "attention_is_all_you_need_raw_chunks_2k_0", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, "text": "Provided proper attribution is provided, Google hereby grants permission to\nreproduce the tables and figures in this paper solely for use in journalistic or\nscholarly works.\n\n## **Attention Is All You Need**\n\n\n\n**Niki Parmar** _[∗]_\nGoogle Research\n```\nnikip@google.com\n\n```\n\n\n**Ashish Vaswani** _[∗]_\nGoogle Brain\n```\navaswani@google.com\n\n```\n\n**Llion Jones** _[∗]_\nGoogle Research\n```\n llion@google.com\n\n```\n\n\n**Noam Shazeer** _[∗]_\nGoogle Brain\n```\nnoam@google.com\n\n```\n\n\n**Jakob Uszkoreit** _[∗]_\nGoogle Research\n```\nusz@google.com\n\n```\n\n\n**Aidan N. Gomez** _[∗†]_\nUniversity of Toronto\n```\naidan@cs.toronto.edu\n\n```\n\n\n**Łukasz Kaiser** _[∗]_\nGoogle Brain\n```\nlukaszkaiser@google.com\n\n```\n\n\n**Illia Polosukhin** _[∗‡]_\n\n```\n             illia.polosukhin@gmail.com\n\n```\n\n**Abstract**\n\n\nThe dominant sequence transduction models are based on complex recurrent or\nconvolutional neural networks that include an encoder and a decoder. The best\nperforming models also connect the encoder and decoder through an attention\nmechanism. We propose a new simple network architecture, the Transformer,\nbased solely on attention mechanisms, dispensing with recurrence and convolutions\nentirely. Experiments on two machine translation tasks show these models to\nbe superior in quality while being more parallelizable and requiring significantly\nless time to train. Our model achieves 28.4 BLEU on the WMT 2014 Englishto-German translation task, improving over the existing best results, including\nensembles, by over 2 BLEU. On the WMT 2014 English-to-French translation task,\nour model establishes a new single-model state-of-the-art BLEU score of 41.8 after\ntraining for 3.5 days on eight GPUs, a small fraction of the training costs of the\nbest models from the literature. We show that the Transformer generalizes well to\nother tasks by applying it successfully to English constituency parsing both with\nlarge and limited training data.\n\n\n_∗_ Equal contribution. Listing order is random. Jakob proposed replacing RNNs with self-attention and started\nthe effort to evaluate this idea. Ashish, with Illia, designed and implemented the first Transformer models and\nhas been crucially involved in every aspect of this work. Noam proposed scaled dot-product attention, multi-head\nattention and the parameter-free position representation and became the other person involved in nearly every\ndetail. Niki designed, implemented, tuned and evaluated countless model variants in our original codebase and\ntensor2tensor. Llion also experimented with novel model variants, was responsible for our initial codebase, and\nefficient inference and visualizations. Lukasz and Aidan spent countless long days designing various parts of and\nimplementing tensor2tensor, replacing our earlier codebase, greatly improving results and massively accelerating\nour research.\n\n_†_ Work performed while at Google Brain.\n\n_‡_ Work performed while at Google Research.\n\n\n31st Conference on Neural Information Processing Systems (NIPS 2017), Long Beach, CA, USA.\n\n\n**1** **Introduction**\n\n\nRecurrent neural networks, long short-term memory [13] and gated recurrent [7] neural networks\nin particular, have been firmly established as state of the art approaches in sequence modeling and\ntransduction problems such as language modeling and machine translation [35, 2, 5]. Numerous\nefforts have since continued to push the boundaries of recurrent language models and encoder-decoder\narchitectures [38, 24, 15].\n\n\nRecurrent models typically factor computation along the symbol positions of the input and output\nsequences. Aligning the positions to steps in computation time, they generate a sequence of hidden\nstates _ht_, as a function of the previous hidden state _ht−_ 1 and the input for position _t_ . This inherently\nsequential nature precludes parallelization within training examples, which becomes critical at longer\nsequence lengths, as memory constraints limit batching across examples. Recent work has achieved\nsignificant improvements in computational efficiency through factorization tricks [21] and conditional\ncomputation [32], while also improving model performance in case of the latter. The fundamental\nconstraint of sequential computation, however, remains.\n\n\nAttention mechanisms have become an integral part of compelling sequence modeling and transduction models in various tasks, allowing modeling of dependencies without regard to their distance in\nthe input or output sequences [2, 19]. In all but a few cases [27], however, such attention mechanisms\nare used in conjunction with a recurrent network.\n\n\nIn this work we propose the Transformer, a model architecture eschewing recurrence and instead\nrelying entirely on an attention mechanism to draw global dependencies between input and output.\nThe Transformer allows for significantly more parallelization and can reach a new state of the art in\ntranslation quality after being trained for as little as twelve hours on eight P100 GPUs.\n\n\n**2** **Background**\n\n\nThe goal of reducing sequential computation also forms the foundation of the Extended Neural GPU\n\n[16], ByteNet [18] and ConvS2S [9], all of which use convolutional neural networks as basic building\nblock, computing hidden representations in parallel for all input and output positions. In these models,\nthe number of operations required to relate signals from two arbitrary input or output positions grows\nin the distance between positions, linearly for ConvS2S and logarithmically for ByteNet. This makes\nit more difficult to learn dependencies between distant positions [12]. In the Transformer this is\nreduced to a constant number of operations, albeit at the cost of reduced effective resolution due\nto averaging attention-weighted positions, an effect we counteract with Multi-Head Attention as\ndescribed in section 3.2.\n\n\nSelf-attention, sometimes called intra-attention is an attention mechanism relating different positions\nof a single sequence in order to compute a representation of the sequence. Self-attention has been\nused successfully in a variety of tasks including reading comprehension, abstractive summarization,\ntextual entailment and learning task-independent sentence representations [4, 27, 28, 22].\n\n\nEnd-to-end memory networks are based on a recurrent attention mechanism instead of sequencealigned recurrence and have been shown to perform well on simple-language question answering and\nlanguage modeling tasks [34].\n\n\nTo the best of our knowledge, however, the Transformer is the first transduction model relying\nentirely on self-attention to compute representations of its input and output without using sequencealigned RNNs or convolution. In the following sections, we will describe the Transformer, motivate\nself-attention and discuss its advantages over models such as [17, 18] and [9].\n\n\n**3** **Model Architecture**\n\n\nMost competitive neural sequence transduction models have an encoder-decoder structure [5, 2, 35].\nHere, the encoder maps an input sequence of symbol representations ( _x_ 1 _, ..., xn_ ) to a sequence\nof continuous representations **z** = ( _z_ 1 _, ..., zn_ ). Given **z**, the decoder then generates an output\nsequence ( _y_ 1 _, ..., ym_ ) of symbols one element at a time. At each step the model is auto-regressive\n\n[10], consuming the previously generated symbols as additional input when generating the next.\n\n\n2\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png)\n\nFigure 1: The Transformer - model architecture.\n\n\nThe Transformer follows this overall architecture using stacked self-attention and point-wise, fully\nconnected layers for both the encoder and decoder, shown in the left and right halves of Figure 1,\nrespectively.\n\n\n**3.1** **Encoder and Decoder Stacks**"}, {"chunk_id": "attention_functional_roles_raw_chunks_2k_0", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl", "metadata": {"source": "attention_functional_roles_raw.md", "chunk_id": "attention_functional_roles_raw_chunks_2k_0", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl"}, "text": "## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES\n\n**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**\n\n**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**\n\n1The University of Melbourne 2The University of Sydney\n_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au\n_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au\ntongliang.liu@sydney.edu.au\n\n\nABSTRACT\n\n\nDespite excelling on multimodal benchmarks, vision–language models (VLMs)\nlargely remain a black box. In this paper, we propose a novel interpretability framework to systematically analyze the internal mechanisms of VLMs, focusing on the functional roles of attention heads in multimodal reasoning. To\nthis end, we introduce CogVision, a dataset that decomposes complex multimodal questions into step-by-step subquestions designed to simulate human reasoning through a chain-of-thought paradigm, with each subquestion associated\nwith specific receptive or cognitive functions such as high-level visual reception and inference. Using a probing-based methodology, we identify attention\nheads that specialize in these functions and characterize them as functional heads.\nOur analysis across diverse VLM families reveals that these functional heads\nare universally sparse, vary in number and distribution across functions, and\nmediate interactions and hierarchical organization. Furthermore, intervention\nexperiments demonstrate their critical role in multimodal reasoning: removing\nfunctional heads leads to performance degradation, while emphasizing them enhances accuracy. These findings provide new insights into the cognitive organization of VLMs and suggest promising directions for designing models with more\nhuman-aligned perceptual and reasoning abilities. Code and data are available at\nhttps://github.com/YanbeiJiang/CogVision.\n\n\n1 INTRODUCTION\n\n\nLarge Vision-Language Models (VLMs) (Zhu et al., 2023; Liu et al., 2023; Lu et al., 2024a) have\ndemonstrated remarkable success across diverse multimodal tasks, ranging from image captioning\nto visual question answering. Although VLMs can solve mathematical reasoning problems with\nvisual context (as shown in Fig. 1), their internal mechanisms remain poorly understood.\n\n\nFor humans, solving such complex problems (illustrated in Fig. 1) typically requires the collaboration of vision and language, engaging multiple brain regions (Barsalou, 2014): the occipital lobe\nfor visual reception, capturing and processing the content of the images; the temporal lobe supports\nlong-term memory and the recall of relevant factual knowledge, such as chemical concentration formulas (Wheeler et al., 1997); and the parietal and prefrontal cortices are involved in higher-order\nreasoning (Hubbard et al., 2005), to produce the correct answer.\n\n\nRecent research in interpretability has begun probing the internal organization of large language\nmodels (LLMs), revealing specialized attention heads for specific functions (Wu et al.; Li et al.,\n2023a; Zheng et al.). In the case of VLMs, several studies (Kang et al., 2025; Bi et al., 2025) have\nidentified sparse attention heads with special functional roles in tasks such as grounding. However,\nstudying VLMs in complex, multi-step reasoning scenarios remains underexplored. A deeper under\n\n_∗_ Both authors contributed equally to this research.\n\n\n1\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png)\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png)\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png)\n\n\n\nDecision making\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png)\n\nHigh-level Vision Reception\n\n\n\nLanguage Knowledge Recall\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png)\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png)\n\n\n\nMath Reasoning\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png)\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png)\n\nOccipital lobe Temporal lobe Parietal lobe Frontal lobe\n\n\n\n\n\n\n\n\n\nBy dividing the number of Solution A has a higher\n\nparticles by the solvent concentration of A, Solution A.\n\n\n\n\n\n\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png)\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png)\n\nFigure 1: To answer a complex question, the human brain engages multiple regions, each performing\ndistinct cognitive functions. We investigate whether specific attention heads in large vision language\nmodels play analogous functional roles in generating responses.\n\n\nstanding of whether such specialized components exist, how they are organized, and what functional\nroles they play in multimodal reasoning is therefore critical.\n\n\nIn this paper, we propose a novel interpretability framework for systematically analyzing the functional roles of attention heads-parallel units in transformer models that compute token-to-token\nattention-an important component in VLMs, with a focus on their contributions to reception (perceptual processing) and cognition. To facilitate this, we introduce CogVision, a dataset that bridges the\ngap between model analysis and human cognitive processes. CogVision decomposes multimodal\nqueries into step-by-step subquestions, each aligned with specific cognitive functions (such as math\nreasoning, decision-masking), thus enabling a fine-grained evaluation of reasoning aligned with the\nchain-of-thought (CoT) paradigm. Leveraging CogVision, we develop a probing method to identify and characterize attention heads responsible for distinct cognitive operations across vision and\nlanguage within the transformer architecture.\n\n\nWe conduct extensive experiments on three major VLM families, including Intern (Zhu et al., 2025),\nQwen (Yang et al., 2025), and Gemma (Team et al., 2025) with different model scales. Our results\nreveal the existence of cognitive heads that consistently exhibit **universal**, **sparse**, and **intrinsic**\nproperties across architectures. Further analysis of the correlations among these functional heads\nreveals **cross-function interactions**, where a single head may support multiple functions or modalities, and uncovers a **hierarchical structure** in which lower-level functional heads modulate higherlevel ones, showing the complexity of neural networks (Barsalou, 2014; Ono et al., 2022).\n\n\nFurthermore, we validate the functional importance of these heads by showing that their removal\ndegrades performance on complex tasks and leads to specific error patterns, while their enhancement improves reasoning capabilities. Our findings provide compelling evidence that these attention\nheads play a critical role in multimodal reasoning. This insight not only deepens our understanding of the internal organization of VLMs but also suggests potential avenues for designing more\ninterpretable and cognitive-inspired multimodal AI systems.\n\n\n2 COGVISION\n\n\nIn this section, we present our dataset Cognitive Vision (CogVision) that contains cognitive process\nin multimodal reasoning. CogVision contains 1,409 main questions and 5,744 subquestions. Each\n\n\n2"}, {"chunk_id": "attention_functional_roles_raw_chunks_2k_2", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl", "metadata": {"source": "attention_functional_roles_raw.md", "chunk_id": "attention_functional_roles_raw_chunks_2k_2", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl"}, "text": "Let _Nt_ denote the number of tokens in the generated answer _a_ _[M]_ _i_ [. To isolate semantically informative]\ncontent relevant to reasoning, we select the top- _k_ most important tokens, determined by prompting\nQwen3-30B LLM (Yang et al., 2025), yielding an index set _Ik_ with _|Ik|_ = _k_ . For each index\n_j ∈Ik_, we extract the corresponding attention head activations _Xj_, and compute the averaged\nactivation feature for the _m_ -th head in layer _l_ as ¯ _x_ _[m]_ _l_ = _k_ [1] � _j ∈Ikxml_ [. This results in a full set of]\n\nhead-level features _X_ [¯] _i_ = _{x_ ¯ _[m]_ _l_ _[|][ l][ ∈]_ [1] _[, . . ., L, m][ ∈]_ [1] _[, . . ., M]_ _[}]_ [.]\n\n\n3.2 FUNCTION PROBING\n\n\nFor the dataset with _N_ subQAF triplets, we collect all activations to construct the probing dataset:\n\n\n_D_ probe = _{_ (¯ _x_ _[m]_ _l_ _[, c]_ [)] _[i][}][N]_ _i_ =1 _[, l][ ∈{]_ [1] _[, . . ., L][}][, m][ ∈{]_ [1] _[, . . ., M]_ _[}]_ (1)\n\n\nFor classification based on CogVision, the training set includes 1,124 main questions with 4,604\nsubQAF triplet, while the testing set has 285 main questions with 1,141 triplets. Our probe takes\nthe form _pθ_ ( _x_ _[m]_ _l_ [) = sigmoid (] _[⟨][θ, x][m]_ _l_ _[⟩]_ [)][. There is one probe per attention head per layer per function.]\nFor each target function, the probe is trained by treating the attention-head outputs that lead to\ncorrect answers for that function as the positive class, and those associated with correct answers\nfrom other functions as the negative class. To ensure data balance, we select an equal number of\nnegative samples to match the positive ones. Given prior findings suggesting that cognitive functions\nmay vary by layer depth (Zheng et al.), we incorporate layer-wise information by computing the\naverage activation ¯ _xl_ = _M_ 1 � _Mm_ =1 _[x]_ [¯] _l_ _[m]_ [for each layer. We then augment each head-level vector with]\n\n\n4\n\n\nits corresponding layer summary, resulting in enriched features _x_ _[m]_ _l_ _[′]_ = [¯ _x_ _[m]_ _l_ [; ¯] _[x][l]_ []][ for probing. The]\nimportance for each head are then calculated based on the accuracy of predicting target function. The\neffectiveness of top-k tokens and layer information, as well as the sensitivity analysis with respect\nto the parameter _k_ and the choice of LLM fused for top-k token extraction, and prompt format, can\nbe found in Appendix A.8.\n\n\n4 EXPERIMENTS\n\n\nWe conduct a series of experiments on three VLM families across various model scales, including\nIntern (Zhu et al., 2025) (InternVL3-8B and InternVL3-2B), Qwen (Yang et al., 2025) (Qwen2.5VL-7B and Qwen2.5-VL-3B), and Gemma (Team et al., 2025) (Gemma3-4B and Gemma3-2B).\nWe analyze the commonalities and differences of functional heads (Subsection 4.1), validate their\ncontributions (Subsection 4.2), and examine correlations, including cross-function interactions and\nhierarchical organization (Subsection 4.3). We also assess their causal impact on downstream reasoning tasks (Subsection 4.4). Results confirm the existence of sparse, function-specific heads and\nhighlight their critical contribution to structured cognitive processing within VLMs.\n\n\n4.1 PROPERTIES OF COGNITIVE HEADS\n\n\n**Sparsity, Universality, and Intrinsic Organization:** Fig 2 shows the heatmap of attention head\naccuracy across eight functions in Qwen2.5-VL-7B on the CogVision test set, revealing a sparse\ndistribution. In total, fewer than 7% of all heads achieve accuracies above 0.9 across the eight functions (about 2% for high-level visual reception and math reasoning, and less than 1% for the others),\nsuggesting that only a small subset of heads meaningfully contributes to different reasoning tasks.\nThese results demonstrate that VLMs rely on highly specialized, localized components for distinct\ncognitive abilities. Pearson correlations between head-activation heatmaps across the eight functions\n(Fig. 3) are generally low, confirming that different functions tend to depend on partially separable\nsubsets of heads. Moreover, this sparse functional organization is consistent across architectures\nand scales: heatmaps for five additional models (Appendix A.4) confirm its universality, and the\nrelatively high Pearson correlation coefficients between models further verify this consistency (in\nAppendix A.9). Within the same model family (e.g., Qwen2.5-VL-7B in Fig 2 vs. Qwen2.5-VL-3B\nin Fig 8), we observe similar distributions, suggesting that such specialization is intrinsic to VLMs.\n\n\n**Functional Personalization:** Beyond sparsity, attention heads exhibit a structured distribution\nacross model layers. Math-related heads are dispersed throughout the network, whereas inferencerelated heads appear more frequently in higher layers. This task-dependent localization suggests an\nemergent modular organization in which different layers support distinct cognitive operations. We\nalso observe notable variation in head counts across functions. For example, in the Qwen family,\nmath reasoning and high-level visual reception heads are more prevalent than others, reflecting differences in representational and computational complexity. Smaller models contain fewer functional\nheads compared to their larger counterparts.\n\n\n4.2 FUNCTIONAL CONTRIBUTIONS OF COGNITIVE HEADS\n\n\nAfter identifying the cognitive heads associated with each function, we examine their functional\nroles by evaluating the model’s behavior on the CogVision test set under targeted interventions. We\nperform head ablation by scaling the output of a specific attention head with a small factor _ϵ_ (e.g.,\n0.001), effectively suppressing its contribution:\n\n\n\n�\n\n\n\n_x_ [mask] _i_ = Softmax\n\n\n\n_Wq_ _[i][W][ iT]_ _k_\n� ~~�~~ _dk/n_\n\n\n\n\n_· ϵWv_ _[i]_ (2)\n\n\n\nSpecifically, we compare model performance when masking identified cognitive heads versus masking an equal number of randomly-selected heads. To quantify the impact, we employ both an LLMbased judge and an integrated accuracy metric. For LLM-based judge, we use LLM (Qwen3-30B\nLLM (Yang et al., 2025)) to judge the correctness of the output. For the integrated accuracy metric,\nan output is considered unaffected if its BLEU score (Papineni et al., 2002) exceeds 0.8, or if either\n\n\n5\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png)\n\nFigure 2: The existence of cognitive heads in Qwen2.5-VL-7B responsible for eight distinct functions in complex reasoning tasks. The x-axis represents the head index, while the y-axis indicates\nthe layer index. The values denote head importance scores, capped at a cutoff of 0.60.\n\n\nFigure 3: Pearson Correlation between different functions across two models.\n\n\nthe ROUGE score (Chin-Yew, 2004) or the semantic similarity score surpasses 0.6. This provides a\ncomprehensive evaluation of performance degradation."}, {"chunk_id": "attention_is_all_you_need_raw_chunks_2k_1", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl", "metadata": {"source": "attention_is_all_you_need_raw.md", "chunk_id": "attention_is_all_you_need_raw_chunks_2k_1", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, "text": "[10], consuming the previously generated symbols as additional input when generating the next.\n\n\n2\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png)\n\nFigure 1: The Transformer - model architecture.\n\n\nThe Transformer follows this overall architecture using stacked self-attention and point-wise, fully\nconnected layers for both the encoder and decoder, shown in the left and right halves of Figure 1,\nrespectively.\n\n\n**3.1** **Encoder and Decoder Stacks**\n\n\n**Encoder:** The encoder is composed of a stack of _N_ = 6 identical layers. Each layer has two\nsub-layers. The first is a multi-head self-attention mechanism, and the second is a simple, positionwise fully connected feed-forward network. We employ a residual connection [11] around each of\nthe two sub-layers, followed by layer normalization [1]. That is, the output of each sub-layer is\nLayerNorm( _x_ + Sublayer( _x_ )), where Sublayer( _x_ ) is the function implemented by the sub-layer\nitself. To facilitate these residual connections, all sub-layers in the model, as well as the embedding\nlayers, produce outputs of dimension _d_ model = 512.\n\n\n**Decoder:** The decoder is also composed of a stack of _N_ = 6 identical layers. In addition to the two\nsub-layers in each encoder layer, the decoder inserts a third sub-layer, which performs multi-head\nattention over the output of the encoder stack. Similar to the encoder, we employ residual connections\naround each of the sub-layers, followed by layer normalization. We also modify the self-attention\nsub-layer in the decoder stack to prevent positions from attending to subsequent positions. This\nmasking, combined with fact that the output embeddings are offset by one position, ensures that the\npredictions for position _i_ can depend only on the known outputs at positions less than _i_ .\n\n\n**3.2** **Attention**\n\n\nAn attention function can be described as mapping a query and a set of key-value pairs to an output,\nwhere the query, keys, values, and output are all vectors. The output is computed as a weighted sum\n\n\n3\n\n\nScaled Dot-Product Attention Multi-Head Attention\n\n\nFigure 2: (left) Scaled Dot-Product Attention. (right) Multi-Head Attention consists of several\nattention layers running in parallel.\n\n\nof the values, where the weight assigned to each value is computed by a compatibility function of the\nquery with the corresponding key.\n\n\n**3.2.1** **Scaled Dot-Product Attention**\n\n\nWe call our particular attention \"Scaled Dot-Product Attention\" (Figure 2). The input consists of\nqueries and keys of dimension _dk_, and values of dimension _dv_ . We compute the dot products of the\nquery with all keys, divide each by _[√]_ _dk_, and apply a softmax function to obtain the weights on the\nvalues.\n\n\nIn practice, we compute the attention function on a set of queries simultaneously, packed together\ninto a matrix _Q_ . The keys and values are also packed together into matrices _K_ and _V_ . We compute\nthe matrix of outputs as:\n\n\nAttention( _Q, K, V_ ) = softmax( _[Q][K]_ _[T]_ ) _V_ (1)\n\n~~_√_~~ _dk_\n\n\nThe two most commonly used attention functions are additive attention [2], and dot-product (multiplicative) attention. Dot-product attention is identical to our algorithm, except for the scaling factor\nof ~~_√_~~ 1 _dk_ . Additive attention computes the compatibility function using a feed-forward network with\na single hidden layer. While the two are similar in theoretical complexity, dot-product attention is\nmuch faster and more space-efficient in practice, since it can be implemented using highly optimized\nmatrix multiplication code.\n\n\nWhile for small values of _dk_ the two mechanisms perform similarly, additive attention outperforms\ndot product attention without scaling for larger values of _dk_ [3]. We suspect that for large values of\n_dk_, the dot products grow large in magnitude, pushing the softmax function into regions where it has\nextremely small gradients [4] . To counteract this effect, we scale the dot products by ~~_√_~~ 1 _dk_ .\n\n\n**3.2.2** **Multi-Head Attention**\n\n\nInstead of performing a single attention function with _d_ model-dimensional keys, values and queries,\nwe found it beneficial to linearly project the queries, keys and values _h_ times with different, learned\nlinear projections to _dk_, _dk_ and _dv_ dimensions, respectively. On each of these projected versions of\nqueries, keys and values we then perform the attention function in parallel, yielding _dv_ -dimensional\n\n\n4To illustrate why the dot products get large, assume that the components of _q_ and _k_ are independent random\nvariables with mean 0 and variance 1. Then their dot product, _q · k_ = [�] _[d]_ _i_ =1 _[k]_ _[q][i][k][i]_ [, has mean][ 0][ and variance] _[ d][k]_ [.]\n\n\n4\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png)\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png)\noutput values. These are concatenated and once again projected, resulting in the final values, as\ndepicted in Figure 2.\n\n\nMulti-head attention allows the model to jointly attend to information from different representation\nsubspaces at different positions. With a single attention head, averaging inhibits this.\n\n\nMultiHead( _Q, K, V_ ) = Concat(head1 _, ...,_ headh) _W_ _[O]_\n\nwhere headi = Attention( _QWi_ _[Q][, KW][ K]_ _i_ _[, V W][ V]_ _i_ [)]\n\n\nWhere the projections are parameter matrices _Wi_ _[Q]_ _∈_ R _[d]_ [model] _[×][d][k]_, _Wi_ _[K]_ _∈_ R _[d]_ [model] _[×][d][k]_, _Wi_ _[V]_ _∈_ R _[d]_ [model] _[×][d][v]_\nand _W_ _[O]_ _∈_ R _[hd][v][×][d]_ [model] .\n\n\nIn this work we employ _h_ = 8 parallel attention layers, or heads. For each of these we use\n_dk_ = _dv_ = _d_ model _/h_ = 64. Due to the reduced dimension of each head, the total computational cost\nis similar to that of single-head attention with full dimensionality.\n\n\n**3.2.3** **Applications of Attention in our Model**\n\n\nThe Transformer uses multi-head attention in three different ways:\n\n\n    - In \"encoder-decoder attention\" layers, the queries come from the previous decoder layer,\nand the memory keys and values come from the output of the encoder. This allows every\nposition in the decoder to attend over all positions in the input sequence. This mimics the\ntypical encoder-decoder attention mechanisms in sequence-to-sequence models such as\n\n[38, 2, 9].\n\n\n    - The encoder contains self-attention layers. In a self-attention layer all of the keys, values\nand queries come from the same place, in this case, the output of the previous layer in the\nencoder. Each position in the encoder can attend to all positions in the previous layer of the\nencoder.\n\n\n    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to\nall positions in the decoder up to and including that position. We need to prevent leftward\ninformation flow in the decoder to preserve the auto-regressive property. We implement this\ninside of scaled dot-product attention by masking out (setting to _−∞_ ) all values in the input\nof the softmax which correspond to illegal connections. See Figure 2."}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_4", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl", "metadata": {"source": "neuronal_attention_circuits_raw.md", "chunk_id": "neuronal_attention_circuits_raw_chunks_2k_4", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, "text": "**2.3. NAC as Universal Approximator**\n\n\nWe now establish the universal approximation capability of\nNAC by extending the classical Universal Approximation\nTheorem (UAT) (Nishijima, 2021) to the proposed mechanism. For brevity, we consider a network with a single\nNAC layer processing fixed-dimensional inputs, though the\nargument generalizes to sequences.\n\n\n**Theorem 2** (Universal Approximation by NAC) **.** _Let K ⊂_\nR _[n]_ _be a compact set and f_ : _K →_ R _[m]_ _be a continuous_\n_function. For any ϵ >_ 0 _, there exists a neural network_\n_consisting of a single NAC layer, with sufficiently large_\n_model dimension dmodel, number of heads H, sparsity s,_\n_and nonlinear activations, such that the network’s output_\n_g_ : R _[n]_ _→_ R _[m]_ _satisfies_\n\n\nsup _∥f_ ( _x_ ) _−_ _g_ ( _x_ ) _∥_ _< ϵ._ (20)\n_x∈K_\n\n\n_The proof is provided in Appendix B.3._\n\n\n**3. Evaluation**\n\n\nWe evaluate the proposed architecture against a range of\nbaselines, including (DT & CT) RNN, (DT & CT) attention,\nand multiple NAC ablation configurations. Experiments\nare conducted across diverse domains, including irregular\ntime-series modeling, lane keeping of autonomous vehicles,\nand Industry 4.0 prognostics. All results are obtained using 5-fold cross-validation, where models are trained using\nBPTT (see Appendix C.2) on each fold and evaluated across\nall folds. We report the mean ( _µ_ ) and standard deviation ( _σ_ )\nto capture variability and quantify uncertainty in the predictions. Table 1 provides results for all experiments, and the\ndetails of the baselines, ablation, environment utilized, the\ndata curation and preprocessing, and neural network architectures for all experiments are provided in the Appendix\nD.3.\n\n\n**3.1. Irregular Time-series**\n\n\nWe evaluate the proposed architecture on two irregular timeseries datasets: (i) Event-based MNIST; and (ii) Person\nActivity Recognition (PAR).\n\n\n\nFor finite _t_, the exponential factor (1 _−_ _e_ _[−][ω][τ][ t]_ ) regulates the\nbuildup of attention, giving _ωτ_ a temporal gating role. Normalizing across all keys via _softmax_ yields attention weights\n_αt_ = softmax( _at_ ), defining a valid probability distribution\nwhere _ϕ_ amplifies or suppresses content alignments, and _ωτ_\nshapes both the speed and saturation of these preferences.\nAs _t →∞_, the trajectory converges to the steady state\n\n\n_a_ _[∗]_ _t_ [=] _[ϕ]_ _≈_ _[q][⊤][k]_ _,_ (18)\n\n_ωτ_ ~~_√_~~ _dk_\n\n\nwhich is analogous to scaled-dot attention under specific\nparameterization when the backbone _NN_ backbone is configured as a linear projection such that _ϕ_ ( **u** ) = _q_ _[⊤]_ _k_ and\n_ωτ_ ( _u_ ) = _[√]_ _dk_ (e.g., by setting NCP weights to emulate\nbilinear forms and disabling nonlinearities). In general, the\nnonlinear backbone allows for more expressive similarities,\nwith the approximation holding when trained to mimic dot\nproducts.\n**Attention output:** Finally, the attention output is computed\nby integrating the attention weights with the value matrix:\n\n\nNAC( _q, k, v_ ) = _αtvtdt_ (19)\n� _T_\n\n\nIn practice, the integration is approximated using a Riemannstyle approach, where the weighted elements are computed\nby multiplying each _vt_ with its corresponding _αt_ . These are\nthen summed and multiplied by a fixed pseudo-time step\n_δt_, chosen as a scalar (typically between 0.5–1.0) hyperparameter during layer initialization. This yields a continuous\nanalogue of standard weighted sums, giving finer resolution\nof the attention trajectory without altering the underlying\nvalues. Sensitivity to attention output w.r.t _δt_ is visualized\nin Appendix D.2.\n\n\n2.2.1. EXTENSION TO MULTI-HEAD\n\n\nTo scale this mechanism to multi-head attention, we project\nthe input sequence into _H_ independent subspaces (heads)\nof dimension _d_ model _/H_, yielding query, key, and value tensors ( _q_ [(] _[h]_ [)] _, k_ [(] _[h]_ [)] _, v_ [(] _[h]_ [)] ) for _h ∈{_ 1 _, . . ., H}_ . For each head,\npairwise logits are computed according to Eqns. 2,3 or 18,\n\n\n\n5\n\n\n**Neuronal Attention Circuit (NAC) for Representation Learning**\n\n\n_Figure 2._ Illustration of the architecture of **(a)** Neuronal Attention Circuit mechanism ; **(b)** Multi-Head Extension\n\n\n\n![](E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png)\n\n**Event-based MNIST:** Event-based MNIST is the trans\nformation of the widely recognized MNIST dataset with\nirregular sampling added originally proposed in (Lechner\n& Hasani, 2022). The transformation was done in two\nsteps: (i) flattening each 28×28 image into a time series\nof length 784, and (ii) encoding the binary time series into\nan event-based format by collapsing consecutive identical\nvalues (e.g., 1,1,1,1 → (1, t=4)). This representation requires models to handle temporal dependencies effectively.\nNAC-PW achieved first place with an accuracy of 96.64%,\nfollowed by NAC-Exact/05s/8k at 96.12%. GRU-ODE and\nContiFormer ranked third with 96.04%.\n\n**Person Activity Recognition (PAR):** We employed the\nLocalized Person Activity dataset from UC Irvine (Vidulin\net al., 2010). The dataset contains data from five participants,\neach equipped with inertial measurement sensors sampled\nevery 211 ms. The goal of this experiment is to predict a\nperson’s activity from a set of predefined actions, making it\na classification task. All models performed well on this task,\nwith NAC-PW achieving 89.15% accuracy and taking first\nplace. NAC-Exact/05s/8k and GRU-ODE ranked second\nwith 89.01% accuracy, while NAC-02s ranked third with\n88.84% mean accuracy.\n\n\n**3.2. Lane-Keeping of Autonomous Vehicles**\n\n\nLane keeping in autonomous vehicles (AVs) is a fundamental problem in robotics and AI. Early works (Tiang et al.,\n2018; Park et al., 2021) primarily emphasized accuracy,\noften relying on large models. More recent research (Lechner et al., 2020; Razzaq & Hongwei, 2023) has shifted toward designing compact architectures suitable for resourceconstrained devices. The goal of this experiment is to create\na long causal structure between the road’s horizon and the"}], "retrieved_by_subquery": [{"subquery": "anaphora resolution attention mechanism", "hits": [{"chunk_id": "attention_is_all_you_need_raw_chunks_2k_2", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_0", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_3", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}]}, {"subquery": "attention-based anaphora resolution models", "hits": [{"chunk_id": "attention_is_all_you_need_raw_chunks_2k_0", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, {"chunk_id": "attention_is_all_you_need_raw_chunks_2k_2", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, {"chunk_id": "attention_functional_roles_raw_chunks_2k_0", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl"}]}, {"subquery": "using attention for coreference resolution", "hits": [{"chunk_id": "attention_functional_roles_raw_chunks_2k_2", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl"}, {"chunk_id": "attention_is_all_you_need_raw_chunks_2k_1", "source_file": "attention_is_all_you_need_raw_chunks_2k.jsonl"}, {"chunk_id": "attention_functional_roles_raw_chunks_2k_0", "source_file": "attention_functional_roles_raw_chunks_2k.jsonl"}]}, {"subquery": "anaphora resolution with neural attention", "hits": [{"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_3", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_0", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}, {"chunk_id": "neuronal_attention_circuits_raw_chunks_2k_4", "source_file": "neuronal_attention_circuits_raw_chunks_2k.jsonl"}]}], "error": null, "latency_ms": 3872}, "graph": {"query": "how is anaphora resolution done using attention mechanism?", "grounded_entities": [{"labels": ["Concept"], "name": "anaphora resolution", "score": 4.364219665527344}, {"labels": ["Concept"], "name": "Attention mechanism", "score": 1.0319732427597046}, {"labels": ["Concept"], "name": "attention heads", "score": 1.0319732427597046}, {"labels": ["Concept"], "name": "attention patterns", "score": 1.0319732427597046}, {"labels": ["Concept"], "name": "Attention weights", "score": 1.0319732427597046}], "generated_cypher": "MATCH (c1:Concept {id:'anaphora resolution'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(c2:Concept {id:'Attention mechanism'})\nWHERE d.source_type = 'chunk'\nRETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text\nLIMIT 10", "raw_context_rows": [], "fallback_used": true, "retrieved_subgraph": {"nodes": [{"id": "Attention mechanism", "properties": {"id": "Attention mechanism"}, "labels": ["Concept"]}, {"id": "attention heads", "properties": {"id": "attention heads"}, "labels": ["Concept"]}, {"id": "attention patterns", "properties": {"id": "attention patterns"}, "labels": ["Concept"]}, {"id": "anaphora resolution", "properties": {"id": "anaphora resolution"}, "labels": ["Concept"]}, {"id": "Attention weights", "properties": {"id": "Attention weights"}, "labels": ["Concept"]}, {"id": "c35df05545627694d3b4bbf52619a5da", "properties": {"chunk_index": "0", "chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "source_type": "chunk", "id": "c35df05545627694d3b4bbf52619a5da", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0", "chunk_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0"}, "labels": ["Document"]}, {"id": "888d0bd62e26d30498c9f50b218a6001", "properties": {"chunk_index": "2", "chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "source_type": "chunk", "id": "888d0bd62e26d30498c9f50b218a6001", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2", "chunk_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2"}, "labels": ["Document"]}, {"id": "36f927c2ec5951b1af0611a9728d214b", "properties": {"derived_from_chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "markdown_source": "attention_is_all_you_need_raw_with_image_ids_with_captions.md", "source_type": "markdown", "id": "36f927c2ec5951b1af0611a9728d214b", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions.md::images", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions.md::images"}, "labels": ["Document"]}, {"id": "img_attention_is_all_you_need_12_0", "properties": {"id": "img_attention_is_all_you_need_12_0", "source_path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png"}, "labels": ["Image"]}, {"id": "Transformer", "properties": {"id": "Transformer"}, "labels": ["Model"]}, {"id": "Encoder-decoder architectures", "properties": {"id": "Encoder-decoder architectures"}, "labels": ["Model"]}, {"id": "Active memory", "properties": {"id": "Active memory"}, "labels": ["Concept"]}, {"id": "93ec065e0391e99e3dd12c28af8c5ff9", "properties": {"chunk_index": "1", "chunk_file": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl", "source_type": "chunk", "id": "93ec065e0391e99e3dd12c28af8c5ff9", "text": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1", "source_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1", "chunk_id": "attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1"}, "labels": ["Document"]}, {"id": "img_attention_is_all_you_need_13_0", "properties": {"id": "img_attention_is_all_you_need_13_0", "source_path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png"}, "labels": ["Image"]}, {"id": "img_attention_is_all_you_need_14_0", "properties": {"id": "img_attention_is_all_you_need_14_0", "source_path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png"}, "labels": ["Image"]}], "edges": [{"source": "c35df05545627694d3b4bbf52619a5da", "type": "MENTIONS", "properties": {}, "target": "Attention mechanism"}, {"source": "888d0bd62e26d30498c9f50b218a6001", "type": "MENTIONS", "properties": {}, "target": "Attention mechanism"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "Attention mechanism"}, {"source": "img_attention_is_all_you_need_12_0", "type": "DEPICTS", "properties": {}, "target": "Attention mechanism"}, {"source": "Transformer", "type": "BUILDS_ON", "properties": {}, "target": "Attention mechanism"}, {"source": "Encoder-decoder architectures", "type": "BUILDS_ON", "properties": {}, "target": "Attention mechanism"}, {"source": "Active memory", "type": "COMPARED_WITH", "properties": {}, "target": "Attention mechanism"}, {"source": "Transformer", "type": "EXTENDS", "properties": {}, "target": "Attention mechanism"}, {"source": "93ec065e0391e99e3dd12c28af8c5ff9", "type": "MENTIONS", "properties": {}, "target": "attention heads"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "attention heads"}, {"source": "img_attention_is_all_you_need_13_0", "type": "DEPICTS", "properties": {}, "target": "attention heads"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "attention patterns"}, {"source": "img_attention_is_all_you_need_13_0", "type": "DEPICTS", "properties": {}, "target": "attention patterns"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "anaphora resolution"}, {"source": "img_attention_is_all_you_need_13_0", "type": "DEPICTS", "properties": {}, "target": "anaphora resolution"}, {"source": "36f927c2ec5951b1af0611a9728d214b", "type": "MENTIONS", "properties": {}, "target": "Attention weights"}, {"source": "img_attention_is_all_you_need_14_0", "type": "DEPICTS", "properties": {}, "target": "Attention weights"}]}, "error": null, "latency_ms": 10376}}}
2026-01-02 12:10:46,692 - __main__ - INFO - Processing query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:10:46,692 - __main__ - INFO - Initializing LLM for query agent...
2026-01-02 12:10:46,807 - __main__ - INFO - Loading vector store...
2026-01-02 12:10:46,808 - query_agent - INFO - Loading EmbeddingGemma model...
2026-01-02 12:10:46,811 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-02 12:10:46,812 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2026-01-02 12:10:55,806 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2026-01-02 12:10:55,806 - query_agent - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2026-01-02 12:10:55,860 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-02 12:10:56,473 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-02 12:10:56,530 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:10:56,540 - query_agent - INFO - RAG Tool invoked with user query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:10:57,313 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:10:57,371 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:10:57,371 - query_agent - INFO -   Subquery 1: Neuronal Attention Circuit (NAC) attention logit computation modes
2026-01-02 12:10:57,371 - query_agent - INFO -   Subquery 2: NAC supported attention logit modes
2026-01-02 12:10:57,372 - query_agent - INFO -   Subquery 3: attention logit computation in Neuronal Attention Circuit
2026-01-02 12:10:57,372 - query_agent - INFO - RAG internal retrieval query: Neuronal Attention Circuit (NAC) attention logit computation modes
2026-01-02 12:10:59,930 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Attention Circuit (NAC) attention logit computation modes'
2026-01-02 12:10:59,930 - query_agent - INFO - RAG internal retrieval query: NAC supported attention logit modes
2026-01-02 12:11:00,017 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC supported attention logit modes'
2026-01-02 12:11:00,017 - query_agent - INFO - RAG internal retrieval query: attention logit computation in Neuronal Attention Circuit
2026-01-02 12:11:00,100 - query_agent - INFO - RAG retrieved 3 documents for subquery 'attention logit computation in Neuronal Attention Circuit'
2026-01-02 12:11:00,101 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:11:00,101 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:11:00,101 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:11:00,101 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:11:00,101 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:11:00,102 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:11:00,102 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:11:00,102 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=39665
2026-01-02 12:11:00,102 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:11:00,103 - query_agent - INFO - Graph Tool invoked with user query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:11:00,103 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:11:03,079 - query_agent - INFO - Resolving entities from graph for query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:11:03,467 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Neuronal Attention Circuit (NAC) (Concept)
- Neuronal Attention Circuit (NAC) (Model)
- Multi-Head Neuronal Attention Circuit (Concept)
- Neuronal circuit (Concept)
- Neuronal Circuit Policies (NCPs) (Concept)
2026-01-02 12:11:03,710 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:11:27,594 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: Concept OR nac)} {position: line: 2, column: 60, offset: 71} for query: "MATCH (nac)\nWHERE nac.id = 'Neuronal Attention Circuit (NAC)' AND (nac:`Concept OR nac`:Model)\nMATCH (nac)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(mode:Concept)\nWHERE d.source_type = 'chunk'\nRETURN DISTINCT mode.id\nLIMIT 3"
2026-01-02 12:11:28,873 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:11:28,874 - query_agent - INFO - MATCH (nac)
WHERE nac.id = 'Neuronal Attention Circuit (NAC)' AND (nac:`Concept OR nac`:Model)
MATCH (nac)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(mode:Concept)
WHERE d.source_type = 'chunk'
RETURN DISTINCT mode.id
LIMIT 3
2026-01-02 12:11:28,875 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:11:28,876 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:11:30,407 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Neuronal Attention Circuit (NAC)'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-Head Neuronal Attention Circuit'}]}

Neighborhood of Concept 'Neuronal Attention Circuit (NAC)':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_neuronal_attention_circuits_5_0'}

Images (from graph):
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Multi-Head Neuronal Attention Circuit

Chunks (inferred from derived_from_chunk_file):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## **Neuronal Attention Circuit (NAC) for Representation Learning**

**Waleed Razzaq** [1] **Izis Kankaraway** [1] **Yun-Bo Zhao** [1 2]



**Abstract**

Attention improves representation learning over
RNNs, but its discrete nature limits continuoustime (CT) modeling. We introduce Neuronal Attention Circuit (NAC), a novel, biologically plausible CT-Attention mechanism that reformulates

attention logits computation as the solution to a
linear first-order ODE with nonlinear interlinked
gates derived from repurposing _C. elegans_ Neuronal Circuit Policies (NCPs) wiring mechanism.
NAC replaces de…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _|at −_ _a_ _[∗]_ _| ≤_ _Me_ _[−][ω][τ][ t]_ _._ (10)


_Remark:_ This bound highlights that exponential convergence holds uniformly across all admissible initial
conditions, with the constant _M_ capturing the worst-case
deviation.


**Corollary 3** (Sample complexity to _δ_ -accuracy) **.** _A natural_
_operational question is the time required to achieve a target_
_tolerance δ >_ 0 _. Solving_


_|a_ 0 _−_ _a_ _[∗]_ _|e_ _[−][ω][τ][ t]_ _≤_ _δ,_ (11)


_We obtain the threshold_




[1] ln _[|][a]_ [0] _[ −]_ _[a][∗][|]_

_ωτ_ _δ_



_t ≥_ [1]



_._ (12)
_δ_



_Remark:_ The convergence rat…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ```json
"img_neuronal_attention_circuits_5_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png",
    "page": 5,
    "section": "Abstract",
    "image_relevance": "high",
    "image_type": "architecture",
    "semantic_role": "defines",
    "caption": "The image presents two architectural diagrams: a Neuronal Attention Circuit (NAC) and a Multi-Head Neuronal Attention Circuit. The single-head NAC processes time-series Query, Key, and Value inputs through Sparse Topk-Pairwise, a Backbone module, a logit computation…
2026-01-02 12:11:30,887 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:11:36,539 - __main__ - INFO - Saved 1 results to E:\Python Stuff\MAS-for-multimodal-knowledge-graph\test\outputs\test_case_single.csv
2026-01-02 12:15:42,527 - __main__ - INFO - Processing query: How is the entity "DeepSeek-R1" related to the concept of "Chain-of-Thought" in the context of SWA adaptation?
2026-01-02 12:15:42,527 - __main__ - INFO - Initializing LLM for query agent...
2026-01-02 12:15:42,558 - __main__ - INFO - Loading vector store...
2026-01-02 12:15:42,559 - query_agent - INFO - Loading EmbeddingGemma model...
2026-01-02 12:15:42,564 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2026-01-02 12:15:42,564 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: google/embeddinggemma-300m
2026-01-02 12:15:48,992 - sentence_transformers.SentenceTransformer - INFO - 14 prompts are loaded, with the keys: ['query', 'document', 'BitextMining', 'Clustering', 'Classification', 'InstructionRetrieval', 'MultilabelClassification', 'PairClassification', 'Reranking', 'Retrieval', 'Retrieval-query', 'Retrieval-document', 'STS', 'Summarization']
2026-01-02 12:15:48,993 - query_agent - INFO - Loading vector store from E:\Python Stuff\MAS-for-multimodal-knowledge-graph\vector_store_outputs\index...
2026-01-02 12:15:49,000 - faiss.loader - INFO - Loading faiss with AVX2 support.
2026-01-02 12:15:49,560 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2026-01-02 12:15:49,568 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:15:49,568 - query_agent - INFO - RAG Tool invoked with user query: How is the entity "DeepSeek-R1" related to the concept of "Chain-of-Thought" in the context of SWA adaptation?
2026-01-02 12:15:49,909 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:15:49,940 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:15:49,941 - query_agent - INFO -   Subquery 1: DeepSeek-R1 Chain-of-Thought SWA adaptation
2026-01-02 12:15:49,941 - query_agent - INFO -   Subquery 2: DeepSeek-R1 SWA adaptation Chain-of-Thought reasoning
2026-01-02 12:15:49,941 - query_agent - INFO -   Subquery 3: Chain-of-Thought DeepSeek-R1 model adaptation SWA
2026-01-02 12:15:49,942 - query_agent - INFO - RAG internal retrieval query: DeepSeek-R1 Chain-of-Thought SWA adaptation
2026-01-02 12:15:50,107 - query_agent - INFO - RAG retrieved 3 documents for subquery 'DeepSeek-R1 Chain-of-Thought SWA adaptation'
2026-01-02 12:15:50,108 - query_agent - INFO - RAG internal retrieval query: DeepSeek-R1 SWA adaptation Chain-of-Thought reasoning
2026-01-02 12:15:50,202 - query_agent - INFO - RAG retrieved 3 documents for subquery 'DeepSeek-R1 SWA adaptation Chain-of-Thought reasoning'
2026-01-02 12:15:50,202 - query_agent - INFO - RAG internal retrieval query: Chain-of-Thought DeepSeek-R1 model adaptation SWA
2026-01-02 12:15:50,294 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Chain-of-Thought DeepSeek-R1 model adaptation SWA'
2026-01-02 12:15:50,294 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 3
2026-01-02 12:15:50,294 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:15:50,294 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:15:50,295 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:15:50,295 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=3, total_chars=21113
2026-01-02 12:15:50,295 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:15:50,295 - query_agent - INFO - Graph Tool invoked with user query: How is the entity "DeepSeek-R1" related to the concept of "Chain-of-Thought" in the context of SWA adaptation?
2026-01-02 12:15:50,296 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:15:52,661 - query_agent - INFO - Resolving entities from graph for query: How is the entity "DeepSeek-R1" related to the concept of "Chain-of-Thought" in the context of SWA adaptation?
2026-01-02 12:15:52,911 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Chain-of-Thought (Concept)
- Chain-of-thought (CoT) format (Concept)
- Chain of Thought (CoT) format (Concept)
- Chain of Thought (CoT) prompting (Concept)
- Deepseek-r1 (Model)
2026-01-02 12:15:53,141 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:16:04,189 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Statement.CartesianProduct} {category: PERFORMANCE} {title: This query builds a cartesian product between disconnected patterns.} {description: If a part of a query contains multiple disconnected patterns, this will build a cartesian product between all those parts. This may produce a large amount of data and slow down query processing. While occasionally intended, it may often be possible to reformulate the query that avoids the use of this cross product, perhaps by adding a relationship between the different parts or by using OPTIONAL MATCH (identifier is: (c))} {position: line: 1, column: 1, offset: 0} for query: 'MATCH (m:Model {id: "Deepseek-r1"}), (c:Concept {id: "Chain-of-Thought"})\nMATCH p = shortestPath((m)-[*..4]-(c))\nRETURN p'
2026-01-02 12:16:09,232 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:16:09,233 - query_agent - INFO - MATCH (m:Model {id: "Deepseek-r1"}), (c:Concept {id: "Chain-of-Thought"})
MATCH p = shortestPath((m)-[*..4]-(c))
RETURN p
2026-01-02 12:16:09,233 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'p': [{'id': 'Deepseek-r1'}, 'AUTHORED_BY', {'id': 'DeepSeek-AI, 2025a'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Chain-of-Thought'}]}]
2026-01-02 12:16:09,533 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'p': [{'id': 'Deepseek-r1'}, 'AUTHORED_BY', {'id': 'DeepSeek-AI, 2025a'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Chain-of-Thought'}]}

Images (from graph):
- img_attention_functional_roles_21_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-21-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Chain-of-thought (CoT) format

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: ## **Sliding Window Attention Adaptation**

Yijiong Yu [a], Jiale Liu [b], Qingyun Wu [b], Huazheng Wang [a], and Ji Pei [c]


aOregon State University, {yuyiji, huazheng.wang}@oregonstate.edu
bPenn State University, {jiale.liu, qingyun.wu}@psu.edu
cDeepSolution, research@deepsolution.chat



**Abstract**


The self-attention mechanism in Transformer
based Large Language Models (LLMs) scales
quadratically with input length, making longcontext inference expensive. Sliding window attention (SWA) reduces this cost to linear complexity, but naively enabling complete
SWA at inference-time for model…
2026-01-02 12:16:09,979 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:16:18,949 - __main__ - INFO - Processing query: What is the relationship between "Flash-Attention-2" and the "Keep First k Tokens" implementation in SWAA?
2026-01-02 12:16:18,949 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:16:18,950 - query_agent - INFO - RAG Tool invoked with user query: What is the relationship between "Flash-Attention-2" and the "Keep First k Tokens" implementation in SWAA?
2026-01-02 12:16:19,197 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:16:19,201 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:16:19,202 - query_agent - INFO -   Subquery 1: Flash-Attention-2 SWAA Keep First k Tokens
2026-01-02 12:16:19,203 - query_agent - INFO -   Subquery 2: SWAA Keep First k Tokens implementation details
2026-01-02 12:16:19,203 - query_agent - INFO -   Subquery 3: Flash-Attention-2 relationship to SWAA
2026-01-02 12:16:19,204 - query_agent - INFO -   Subquery 4: Keep First k Tokens SWAA Flash-Attention-2
2026-01-02 12:16:19,205 - query_agent - INFO - RAG internal retrieval query: Flash-Attention-2 SWAA Keep First k Tokens
2026-01-02 12:16:19,302 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Flash-Attention-2 SWAA Keep First k Tokens'
2026-01-02 12:16:19,302 - query_agent - INFO - RAG internal retrieval query: SWAA Keep First k Tokens implementation details
2026-01-02 12:16:19,397 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA Keep First k Tokens implementation details'
2026-01-02 12:16:19,397 - query_agent - INFO - RAG internal retrieval query: Flash-Attention-2 relationship to SWAA
2026-01-02 12:16:19,478 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Flash-Attention-2 relationship to SWAA'
2026-01-02 12:16:19,478 - query_agent - INFO - RAG internal retrieval query: Keep First k Tokens SWAA Flash-Attention-2
2026-01-02 12:16:19,563 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Keep First k Tokens SWAA Flash-Attention-2'
2026-01-02 12:16:19,563 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:16:19,564 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:16:19,564 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:16:19,564 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:16:19,564 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:16:19,565 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=29232
2026-01-02 12:16:19,565 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:16:19,565 - query_agent - INFO - Graph Tool invoked with user query: What is the relationship between "Flash-Attention-2" and the "Keep First k Tokens" implementation in SWAA?
2026-01-02 12:16:19,565 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:16:21,496 - query_agent - INFO - Resolving entities from graph for query: What is the relationship between "Flash-Attention-2" and the "Keep First k Tokens" implementation in SWAA?
2026-01-02 12:16:21,695 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Keep First k Tokens (Algorithm)
- Flash-Attention-2 (Algorithm)
- In-Domain Data (Concept)
- Multimodal Understanding and Reasoning (Task)
- Information Understanding and Extraction (Concept)
2026-01-02 12:16:21,876 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:16:24,165 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.algo.shortestPath` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
neo4j.exceptions.GqlError: {gql_status: 42N08} {gql_status_description: error: syntax error or access rule violation - no such procedure. The procedure apoc.algo.shortestPath() was not found. Verify that the spelling is correct.} {message: 42N08: The procedure apoc.algo.shortestPath() was not found. Verify that the spelling is correct.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.ClientError: {code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.algo.shortestPath` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
2026-01-02 12:16:24,377 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:16:28,074 - __main__ - INFO - Processing query: How does the "sensory neuron" entity in NAC interact with the "backbone" entity to compute attention logits?
2026-01-02 12:16:28,074 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:16:28,075 - query_agent - INFO - RAG Tool invoked with user query: How does the "sensory neuron" entity in NAC interact with the "backbone" entity to compute attention logits?
2026-01-02 12:16:28,328 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:16:28,331 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:16:28,332 - query_agent - INFO -   Subquery 1: NAC sensory neuron backbone attention logits
2026-01-02 12:16:28,333 - query_agent - INFO -   Subquery 2: sensory neuron interaction with backbone in NAC
2026-01-02 12:16:28,333 - query_agent - INFO -   Subquery 3: NAC attention mechanism backbone sensory neuron
2026-01-02 12:16:28,334 - query_agent - INFO -   Subquery 4: backbone and sensory neuron computation NAC
2026-01-02 12:16:28,335 - query_agent - INFO - RAG internal retrieval query: NAC sensory neuron backbone attention logits
2026-01-02 12:16:28,447 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC sensory neuron backbone attention logits'
2026-01-02 12:16:28,447 - query_agent - INFO - RAG internal retrieval query: sensory neuron interaction with backbone in NAC
2026-01-02 12:16:28,528 - query_agent - INFO - RAG retrieved 3 documents for subquery 'sensory neuron interaction with backbone in NAC'
2026-01-02 12:16:28,528 - query_agent - INFO - RAG internal retrieval query: NAC attention mechanism backbone sensory neuron
2026-01-02 12:16:28,615 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC attention mechanism backbone sensory neuron'
2026-01-02 12:16:28,616 - query_agent - INFO - RAG internal retrieval query: backbone and sensory neuron computation NAC
2026-01-02 12:16:28,695 - query_agent - INFO - RAG retrieved 3 documents for subquery 'backbone and sensory neuron computation NAC'
2026-01-02 12:16:28,696 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:16:28,696 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:16:28,696 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:16:28,696 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:16:28,696 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:16:28,696 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:16:28,697 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=33531
2026-01-02 12:16:28,697 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:16:28,697 - query_agent - INFO - Graph Tool invoked with user query: How does the "sensory neuron" entity in NAC interact with the "backbone" entity to compute attention logits?
2026-01-02 12:16:28,698 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:16:30,953 - query_agent - INFO - Resolving entities from graph for query: How does the "sensory neuron" entity in NAC interact with the "backbone" entity to compute attention logits?
2026-01-02 12:16:31,178 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Sensory neuron (Concept)
- Backbone (Concept)
- Compute logits (Concept)
- Backbone circuit (Concept)
- In-Domain Data (Concept)
2026-01-02 12:16:31,396 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:16:54,437 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:16:54,437 - query_agent - INFO - MATCH (s:Concept {id: 'Sensory neuron'})
MATCH (b:Concept {id: 'Backbone'})
MATCH (cl:Concept {id: 'Compute logits'})
MATCH (d:Document)-[:MENTIONS]->(s)
MATCH (d)-[:MENTIONS]->(b)
MATCH (d)-[:MENTIONS]->(cl)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index LIMIT 10
2026-01-02 12:16:54,438 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:16:54,440 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:16:55,572 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Sensory neuron'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Backbone'}]}

Neighborhood of Concept 'Sensory neuron':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_neuronal_attention_circuits_2_0'}

Images (from graph):
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Sensory neuron
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Sensory neuron
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Sensory neuron
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Sensory neuron
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Sensory neuron
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Sensory neuron
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Backbone
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Backbone
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Backbone
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Backbone
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Backbone
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Backbone

Chunks (inferred from derived_from_chunk_file):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## **Neuronal Attention Circuit (NAC) for Representation Learning**

**Waleed Razzaq** [1] **Izis Kankaraway** [1] **Yun-Bo Zhao** [1 2]



**Abstract**

Attention improves representation learning over
RNNs, but its discrete nature limits continuoustime (CT) modeling. We introduce Neuronal Attention Circuit (NAC), a novel, biologically plausible CT-Attention mechanism that reformulates

attention logits computation as the solution to a
linear first-order ODE with nonlinear interlinked
gates derived from repurposing _C. elegans_ Neuronal Circuit Policies (NCPs) wiring mechanism.
NAC replaces de…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _|at −_ _a_ _[∗]_ _| ≤_ _Me_ _[−][ω][τ][ t]_ _._ (10)


_Remark:_ This bound highlights that exponential convergence holds uniformly across all admissible initial
conditions, with the constant _M_ capturing the worst-case
deviation.


**Corollary 3** (Sample complexity to _δ_ -accuracy) **.** _A natural_
_operational question is the time required to achieve a target_
_tolerance δ >_ 0 _. Solving_


_|a_ 0 _−_ _a_ _[∗]_ _|e_ _[−][ω][τ][ t]_ _≤_ _δ,_ (11)


_We obtain the threshold_




[1] ln _[|][a]_ [0] _[ −]_ _[a][∗][|]_

_ωτ_ _δ_



_t ≥_ [1]



_._ (12)
_δ_



_Remark:_ The convergence rat…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ```json
"img_neuronal_attention_circuits_5_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png",
    "page": 5,
    "section": "Abstract",
    "image_relevance": "high",
    "image_type": "architecture",
    "semantic_role": "defines",
    "caption": "The image presents two architectural diagrams: a Neuronal Attention Circuit (NAC) and a Multi-Head Neuronal Attention Circuit. The single-head NAC processes time-series Query, Key, and Value inputs through Sparse Topk-Pairwise, a Backbone module, a logit computation…
2026-01-02 12:16:55,823 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:17:07,418 - __main__ - INFO - Processing query: What connects the "occipital lobe" entity to the "High-Level Visual Reception" function in the CogVision framework?
2026-01-02 12:17:07,419 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:17:07,421 - query_agent - INFO - RAG Tool invoked with user query: What connects the "occipital lobe" entity to the "High-Level Visual Reception" function in the CogVision framework?
2026-01-02 12:17:07,820 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:17:07,822 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:17:07,823 - query_agent - INFO -   Subquery 1: CogVision framework occipital lobe High-Level Visual Reception
2026-01-02 12:17:07,824 - query_agent - INFO -   Subquery 2: occipital lobe role in High-Level Visual Reception
2026-01-02 12:17:07,825 - query_agent - INFO -   Subquery 3: CogVision High-Level Visual Reception entity connections
2026-01-02 12:17:07,825 - query_agent - INFO -   Subquery 4: occipital lobe function in CogVision
2026-01-02 12:17:07,826 - query_agent - INFO -   Subquery 5: High-Level Visual Reception and occipital lobe in CogVision
2026-01-02 12:17:07,827 - query_agent - INFO - RAG internal retrieval query: CogVision framework occipital lobe High-Level Visual Reception
2026-01-02 12:17:07,932 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision framework occipital lobe High-Level Visual Reception'
2026-01-02 12:17:07,932 - query_agent - INFO - RAG internal retrieval query: occipital lobe role in High-Level Visual Reception
2026-01-02 12:17:08,018 - query_agent - INFO - RAG retrieved 3 documents for subquery 'occipital lobe role in High-Level Visual Reception'
2026-01-02 12:17:08,018 - query_agent - INFO - RAG internal retrieval query: CogVision High-Level Visual Reception entity connections
2026-01-02 12:17:08,112 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision High-Level Visual Reception entity connections'
2026-01-02 12:17:08,112 - query_agent - INFO - RAG internal retrieval query: occipital lobe function in CogVision
2026-01-02 12:17:08,192 - query_agent - INFO - RAG retrieved 3 documents for subquery 'occipital lobe function in CogVision'
2026-01-02 12:17:08,192 - query_agent - INFO - RAG internal retrieval query: High-Level Visual Reception and occipital lobe in CogVision
2026-01-02 12:17:08,270 - query_agent - INFO - RAG retrieved 3 documents for subquery 'High-Level Visual Reception and occipital lobe in CogVision'
2026-01-02 12:17:08,270 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:17:08,270 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:17:08,270 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:17:08,270 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_8
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:17:08,270 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:17:08,271 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=28947
2026-01-02 12:17:08,271 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:17:08,271 - query_agent - INFO - Graph Tool invoked with user query: What connects the "occipital lobe" entity to the "High-Level Visual Reception" function in the CogVision framework?
2026-01-02 12:17:08,272 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:17:10,553 - query_agent - INFO - Resolving entities from graph for query: What connects the "occipital lobe" entity to the "High-Level Visual Reception" function in the CogVision framework?
2026-01-02 12:17:10,767 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Occipital lobe (Concept)
- High-Level Visual Reception (Task)
- High-Level Visual Reception (Concept)
- High-level Visual Reception (Task)
- High-Level Visual Reception task (Concept)
2026-01-02 12:17:10,949 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:17:14,305 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.algo.shortestPath` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
neo4j.exceptions.GqlError: {gql_status: 42N08} {gql_status_description: error: syntax error or access rule violation - no such procedure. The procedure apoc.algo.shortestPath() was not found. Verify that the spelling is correct.} {message: 42N08: The procedure apoc.algo.shortestPath() was not found. Verify that the spelling is correct.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.ClientError: {code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.algo.shortestPath` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
2026-01-02 12:17:14,312 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:17:18,278 - __main__ - INFO - Processing query: How does the "Adam optimizer" entity function differently in the training regimes of the Transformer and NAC models?
2026-01-02 12:17:18,279 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:17:18,279 - query_agent - INFO - RAG Tool invoked with user query: How does the "Adam optimizer" entity function differently in the training regimes of the Transformer and NAC models?
2026-01-02 12:17:18,560 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:17:18,561 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:17:18,562 - query_agent - INFO -   Subquery 1: Adam optimizer Transformer training
2026-01-02 12:17:18,562 - query_agent - INFO -   Subquery 2: Adam optimizer NAC model training
2026-01-02 12:17:18,562 - query_agent - INFO -   Subquery 3: Transformer vs NAC Adam optimizer differences
2026-01-02 12:17:18,562 - query_agent - INFO - RAG internal retrieval query: Adam optimizer Transformer training
2026-01-02 12:17:18,639 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Adam optimizer Transformer training'
2026-01-02 12:17:18,639 - query_agent - INFO - RAG internal retrieval query: Adam optimizer NAC model training
2026-01-02 12:17:18,788 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Adam optimizer NAC model training'
2026-01-02 12:17:18,790 - query_agent - INFO - RAG internal retrieval query: Transformer vs NAC Adam optimizer differences
2026-01-02 12:17:18,886 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer vs NAC Adam optimizer differences'
2026-01-02 12:17:18,886 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:17:18,886 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_3
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:17:18,887 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:17:18,887 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:17:18,887 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_13
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:17:18,887 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:17:18,887 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:17:18,888 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:17:18,888 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=42050
2026-01-02 12:17:18,888 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:17:18,889 - query_agent - INFO - Graph Tool invoked with user query: How does the "Adam optimizer" entity function differently in the training regimes of the Transformer and NAC models?
2026-01-02 12:17:18,889 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:17:21,094 - query_agent - INFO - Resolving entities from graph for query: How does the "Adam optimizer" entity function differently in the training regimes of the Transformer and NAC models?
2026-01-02 12:17:21,324 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Adam optimizer (Algorithm)
- Transformer (Model)
- Self-training (Algorithm)
- Transformer architecture (Concept)
- Transformer architecture (Model)
2026-01-02 12:17:21,324 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:17:40,536 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:17:40,537 - query_agent - INFO - MATCH (adam:Algorithm {id: "Adam optimizer"})
MATCH (transformer:Model {id: "Transformer"})
OPTIONAL MATCH (adam)-[r1:APPLIED_TO]->(transformer)
OPTIONAL MATCH (transformer)-[r2:BUILDS_ON]->(adam)
RETURN adam.id AS AdamOptimizer,
       COLLECT(DISTINCT type(r1)) AS AppliedToRelationships,
       COLLECT(DISTINCT type(r2)) AS BuildsOnRelationships,
       transformer.id AS TransformerModel
2026-01-02 12:17:40,538 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'AdamOptimizer': 'Adam optimizer', 'AppliedToRelationships': [], 'BuildsOnRelationships': [], 'TransformerModel': 'Transformer'}]
2026-01-02 12:17:40,811 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'AdamOptimizer': 'Adam optimizer', 'AppliedToRelationships': [], 'BuildsOnRelationships': [], 'TransformerModel': 'Transformer'}
2026-01-02 12:17:41,191 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:17:46,377 - __main__ - INFO - Processing query: What is the relationship between "LongBench-V2" and "LongMemEval" in the evaluation of SWA adaptation strategies?
2026-01-02 12:17:46,378 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:17:46,380 - query_agent - INFO - RAG Tool invoked with user query: What is the relationship between "LongBench-V2" and "LongMemEval" in the evaluation of SWA adaptation strategies?
2026-01-02 12:17:46,728 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:17:46,731 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:17:46,731 - query_agent - INFO -   Subquery 1: LongBench-V2 SWA adaptation strategies evaluation
2026-01-02 12:17:46,732 - query_agent - INFO -   Subquery 2: LongMemEval SWA adaptation strategies
2026-01-02 12:17:46,733 - query_agent - INFO -   Subquery 3: LongBench-V2 vs LongMemEval SWA
2026-01-02 12:17:46,734 - query_agent - INFO -   Subquery 4: SWA adaptation strategies LongBench-V2 LongMemEval
2026-01-02 12:17:46,735 - query_agent - INFO - RAG internal retrieval query: LongBench-V2 SWA adaptation strategies evaluation
2026-01-02 12:17:46,844 - query_agent - INFO - RAG retrieved 3 documents for subquery 'LongBench-V2 SWA adaptation strategies evaluation'
2026-01-02 12:17:46,844 - query_agent - INFO - RAG internal retrieval query: LongMemEval SWA adaptation strategies
2026-01-02 12:17:46,923 - query_agent - INFO - RAG retrieved 3 documents for subquery 'LongMemEval SWA adaptation strategies'
2026-01-02 12:17:46,924 - query_agent - INFO - RAG internal retrieval query: LongBench-V2 vs LongMemEval SWA
2026-01-02 12:17:47,008 - query_agent - INFO - RAG retrieved 3 documents for subquery 'LongBench-V2 vs LongMemEval SWA'
2026-01-02 12:17:47,008 - query_agent - INFO - RAG internal retrieval query: SWA adaptation strategies LongBench-V2 LongMemEval
2026-01-02 12:17:47,092 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWA adaptation strategies LongBench-V2 LongMemEval'
2026-01-02 12:17:47,092 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:17:47,092 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:17:47,093 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_8
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:17:47,093 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:17:47,093 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:17:47,093 - query_agent - INFO - RAG Unique Doc 5:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:17:47,093 - query_agent - INFO - RAG Unique Doc 6:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_7
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:17:47,093 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=42001
2026-01-02 12:17:47,094 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:17:47,094 - query_agent - INFO - Graph Tool invoked with user query: What is the relationship between "LongBench-V2" and "LongMemEval" in the evaluation of SWA adaptation strategies?
2026-01-02 12:17:47,094 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:17:49,209 - query_agent - INFO - Resolving entities from graph for query: What is the relationship between "LongBench-V2" and "LongMemEval" in the evaluation of SWA adaptation strategies?
2026-01-02 12:17:49,435 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- LongBench-V2 (Task)
- SWA adaptation (Algorithm)
- Evaluation of Evidence (Concept)
- LongMemEval (Task)
- SWA (Model)
2026-01-02 12:17:49,436 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:18:14,692 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:18:14,693 - query_agent - INFO - cypher
MATCH (t1:Task {id: 'LongBench-V2'})
MATCH (t2:Task {id: 'LongMemEval'})

OPTIONAL MATCH p_via_algo = (t1)<-[:APPLIED_TO]-(algo:Algorithm {id: 'SWA adaptation'})-[:APPLIED_TO]->(t2)
OPTIONAL MATCH p_via_model_applied = (t1)<-[:APPLIED_TO]-(model:Model {id: 'SWA'})-[:APPLIED_TO]->(t2)
OPTIONAL MATCH p_via_model_compared = (t1)-[:COMPARED_WITH]->(model_c:Model {id: 'SWA'})<-[:COMPARED_WITH]-(t2)

RETURN p_via_algo, p_via_model_applied, p_via_model_compared

2026-01-02 12:18:14,694 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'p_via_algo': None, 'p_via_model_applied': None, 'p_via_model_compared': None}]
2026-01-02 12:18:14,968 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'p_via_algo': None, 'p_via_model_applied': None, 'p_via_model_compared': None}
2026-01-02 12:18:15,238 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:18:20,205 - __main__ - INFO - Processing query: How does the "Multi-Head Attention" entity relate to the "sub-layers" entity in the Transformer architecture?
2026-01-02 12:18:20,206 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:18:20,208 - query_agent - INFO - RAG Tool invoked with user query: How does the "Multi-Head Attention" entity relate to the "sub-layers" entity in the Transformer architecture?
2026-01-02 12:18:20,427 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:18:20,428 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:18:20,428 - query_agent - INFO -   Subquery 1: Transformer architecture Multi-Head Attention sub-layers
2026-01-02 12:18:20,429 - query_agent - INFO -   Subquery 2: Multi-Head Attention mechanism in Transformer
2026-01-02 12:18:20,429 - query_agent - INFO -   Subquery 3: Transformer sub-layers with Multi-Head Attention
2026-01-02 12:18:20,429 - query_agent - INFO - RAG internal retrieval query: Transformer architecture Multi-Head Attention sub-layers
2026-01-02 12:18:20,519 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer architecture Multi-Head Attention sub-layers'
2026-01-02 12:18:20,519 - query_agent - INFO - RAG internal retrieval query: Multi-Head Attention mechanism in Transformer
2026-01-02 12:18:20,597 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Multi-Head Attention mechanism in Transformer'
2026-01-02 12:18:20,597 - query_agent - INFO - RAG internal retrieval query: Transformer sub-layers with Multi-Head Attention
2026-01-02 12:18:20,681 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer sub-layers with Multi-Head Attention'
2026-01-02 12:18:20,681 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:18:20,681 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:18:20,682 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:18:20,682 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:18:20,682 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:18:20,682 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=29095
2026-01-02 12:18:20,682 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:18:20,683 - query_agent - INFO - Graph Tool invoked with user query: How does the "Multi-Head Attention" entity relate to the "sub-layers" entity in the Transformer architecture?
2026-01-02 12:18:20,683 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:18:22,624 - query_agent - INFO - Resolving entities from graph for query: How does the "Multi-Head Attention" entity relate to the "sub-layers" entity in the Transformer architecture?
2026-01-02 12:18:22,812 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Multi-Head Attention (Concept)
- Multi-Head Attention (Model)
- Multi-head attention (Concept)
- Masked Multi-Head Attention (Concept)
- MHA (Multi-Head Attention) (Concept)
2026-01-02 12:18:22,998 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:18:26,397 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:18:26,398 - query_agent - INFO - None
2026-01-02 12:18:26,398 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:18:26,399 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:18:27,435 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Multi-Head Attention'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-head attention'}]}

Neighborhood of Concept 'Multi-Head Attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'c35df05545627694d3b4bbf52619a5da'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '888d0bd62e26d30498c9f50b218a6001'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '8b83039a78b7cb477ca7090ed45387fd'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_2_0'}
{'rel': 'INTRODUCED_BY', 'n_labels': ['Person'], 'n_id': 'Noam Shazeer'}
{'rel': 'BUILDS_ON', 'n_labels': ['Concept'], 'n_id': 'Scaled Dot-Product Attention'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Transformer'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Encoder'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Decoder'}

Images (from graph):
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Multi-head attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Multi-head attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Multi-head attention

Chunks (inferred from derived_from_chunk_file):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.

## **Attention Is All You Need**



**Niki Parmar** _[∗]_
Google Research
```
nikip@google.com

```


**Ashish Vaswani** _[∗]_
Google Brain
```
avaswani@google.com

```

**Llion Jones** _[∗]_
Google Research
```
 llion@google.com

```


**Noam Shazeer** _[∗]_
Google Brain
```
noam@google.com

```


**Jakob Uszkoreit** _[∗]_
Google Research
```
usz@google.com

```


**Aidan N. Gomez** _[∗†]_
University of Toronto
```
aidan…
2026-01-02 12:18:27,687 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:18:36,923 - __main__ - INFO - Processing query: What is the connection between "C. elegans" and the "Neuronal Circuit Policies (NCPs)" entity in the NAC paper?
2026-01-02 12:18:36,923 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:18:36,925 - query_agent - INFO - RAG Tool invoked with user query: What is the connection between "C. elegans" and the "Neuronal Circuit Policies (NCPs)" entity in the NAC paper?
2026-01-02 12:18:37,197 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:18:37,199 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:18:37,199 - query_agent - INFO -   Subquery 1: C. elegans Neuronal Circuit Policies NCPs
2026-01-02 12:18:37,200 - query_agent - INFO -   Subquery 2: NAC paper C. elegans
2026-01-02 12:18:37,200 - query_agent - INFO -   Subquery 3: Neuronal Circuit Policies NCPs C. elegans connection
2026-01-02 12:18:37,200 - query_agent - INFO -   Subquery 4: C. elegans NCPs NAC
2026-01-02 12:18:37,201 - query_agent - INFO -   Subquery 5: Neuronal Circuit Policies C. elegans
2026-01-02 12:18:37,201 - query_agent - INFO - RAG internal retrieval query: C. elegans Neuronal Circuit Policies NCPs
2026-01-02 12:18:37,290 - query_agent - INFO - RAG retrieved 3 documents for subquery 'C. elegans Neuronal Circuit Policies NCPs'
2026-01-02 12:18:37,290 - query_agent - INFO - RAG internal retrieval query: NAC paper C. elegans
2026-01-02 12:18:37,371 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC paper C. elegans'
2026-01-02 12:18:37,371 - query_agent - INFO - RAG internal retrieval query: Neuronal Circuit Policies NCPs C. elegans connection
2026-01-02 12:18:37,448 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Circuit Policies NCPs C. elegans connection'
2026-01-02 12:18:37,448 - query_agent - INFO - RAG internal retrieval query: C. elegans NCPs NAC
2026-01-02 12:18:37,527 - query_agent - INFO - RAG retrieved 3 documents for subquery 'C. elegans NCPs NAC'
2026-01-02 12:18:37,527 - query_agent - INFO - RAG internal retrieval query: Neuronal Circuit Policies C. elegans
2026-01-02 12:18:37,607 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Circuit Policies C. elegans'
2026-01-02 12:18:37,607 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:18:37,607 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_10
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:18:37,607 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:18:37,608 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:18:37,608 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:18:37,608 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:18:37,608 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=32344
2026-01-02 12:18:37,609 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:18:37,609 - query_agent - INFO - Graph Tool invoked with user query: What is the connection between "C. elegans" and the "Neuronal Circuit Policies (NCPs)" entity in the NAC paper?
2026-01-02 12:18:37,609 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:18:39,517 - query_agent - INFO - Resolving entities from graph for query: What is the connection between "C. elegans" and the "Neuronal Circuit Policies (NCPs)" entity in the NAC paper?
2026-01-02 12:18:39,693 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Neuronal Circuit Policies (NCPs) (Model)
- Neuronal Circuit Policies (NCPs) (Concept)
- In-Domain Data (Concept)
- NAC (Model)
- NAC-Euler (Concept)
2026-01-02 12:18:39,884 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:18:56,189 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:18:56,189 - query_agent - INFO - MATCH (c_elegans:Concept {id: 'C. elegans'})
MATCH (nac_model:Model {id: 'NAC'})-[:INTRODUCED_BY]->(nac_publication:Publication)
MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(c_elegans)
  AND ( (d)-[:MENTIONS]->(:Concept {id: 'Neuronal Circuit Policies (NCPs)'}) OR (d)-[:MENTIONS]->(:Model {id: 'Neuronal Circuit Policies (NCPs)'}) )
  AND d.source_id = nac_publication.id
  AND d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:18:56,190 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:18:56,190 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:18:57,224 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Neuronal Circuit Policies (NCPs)'}, 'BUILDS_ON', {'id': 'NAC'}, 'APPLIED_TO', {'id': 'Score'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'In-Domain Data'}]}

Neighborhood of Concept 'Neuronal Circuit Policies (NCPs)':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '9e26fe9e41f7cc77ecb7392a194a23a7'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '9d2969dea07b7778f828d6fa2ed11f60'}
{'rel': 'INTRODUCED_BY', 'n_labels': ['Publication'], 'n_id': 'Lechner et al., 2020'}
{'rel': 'INTRODUCED_BY', 'n_labels': ['Publication'], 'n_id': 'Razzaq & Hongwei, 2023'}
{'rel': 'INTRODUCED_BY', 'n_labels': ['Publication'], 'n_id': 'Lechner et al., 2018'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'NAC'}
{'rel': 'INSPIRED_BY', 'n_labels': ['Model'], 'n_id': 'Neuronal Attention Circuit (NAC)'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_index: 7
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 25



```json
"img_attention_functional_roles_25_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-25-0.png",
    "page": 25,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "semantic_role": "illustrates",
    "caption": "A grid of eight correlation matrices displays the relationships between four distinct models (Qwen2.5VL-7B, Qwen2.5VL-3B, Intern3VL-8B, Intern3VL-2B) ac…
2026-01-02 12:18:57,507 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:19:05,415 - __main__ - INFO - Processing query: How does the "KV cache" entity relate to the "FA Decode" method's efficiency in SWAA?
2026-01-02 12:19:05,415 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:19:05,418 - query_agent - INFO - RAG Tool invoked with user query: How does the "KV cache" entity relate to the "FA Decode" method's efficiency in SWAA?
2026-01-02 12:19:05,654 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:19:05,657 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:19:05,658 - query_agent - INFO -   Subquery 1: KV cache FA Decode SWAA
2026-01-02 12:19:05,659 - query_agent - INFO -   Subquery 2: FA Decode method efficiency with KV cache
2026-01-02 12:19:05,660 - query_agent - INFO -   Subquery 3: SWAA KV cache optimization
2026-01-02 12:19:05,660 - query_agent - INFO - RAG internal retrieval query: KV cache FA Decode SWAA
2026-01-02 12:19:05,756 - query_agent - INFO - RAG retrieved 3 documents for subquery 'KV cache FA Decode SWAA'
2026-01-02 12:19:05,756 - query_agent - INFO - RAG internal retrieval query: FA Decode method efficiency with KV cache
2026-01-02 12:19:05,845 - query_agent - INFO - RAG retrieved 3 documents for subquery 'FA Decode method efficiency with KV cache'
2026-01-02 12:19:05,846 - query_agent - INFO - RAG internal retrieval query: SWAA KV cache optimization
2026-01-02 12:19:05,928 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA KV cache optimization'
2026-01-02 12:19:05,928 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:19:05,928 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:19:05,928 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:19:05,928 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:19:05,929 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_9
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:19:05,929 - query_agent - INFO - RAG Unique Doc 5:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:19:05,929 - query_agent - INFO - RAG Unique Doc 6:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:19:05,929 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=41480
2026-01-02 12:19:05,929 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:19:05,930 - query_agent - INFO - Graph Tool invoked with user query: How does the "KV cache" entity relate to the "FA Decode" method's efficiency in SWAA?
2026-01-02 12:19:05,930 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:19:07,835 - query_agent - INFO - Resolving entities from graph for query: How does the "KV cache" entity relate to the "FA Decode" method's efficiency in SWAA?
2026-01-02 12:19:08,028 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- KV cache (Concept)
- FA Decode (Algorithm)
- FA Decode (Concept)
- KV cache eviction (Mechanism)
- KV cache reusability (Concept)
2026-01-02 12:19:08,213 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:19:30,585 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.algo.shortestPath` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
neo4j.exceptions.GqlError: {gql_status: 42N08} {gql_status_description: error: syntax error or access rule violation - no such procedure. The procedure apoc.algo.shortestPath() was not found. Verify that the spelling is correct.} {message: 42N08: The procedure apoc.algo.shortestPath() was not found. Verify that the spelling is correct.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.ClientError: {code: Neo.ClientError.Procedure.ProcedureNotFound} {message: There is no procedure with the name `apoc.algo.shortestPath` registered for this database instance. Please ensure you've spelled the procedure name correctly and that the procedure is properly deployed.}
2026-01-02 12:19:30,592 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:19:37,640 - __main__ - INFO - Processing query: What relationship exists between "GPT-4.1" and the "CogVision" dataset construction process?
2026-01-02 12:19:37,641 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:19:37,643 - query_agent - INFO - RAG Tool invoked with user query: What relationship exists between "GPT-4.1" and the "CogVision" dataset construction process?
2026-01-02 12:19:37,914 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:19:37,915 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:19:37,915 - query_agent - INFO -   Subquery 1: GPT-4.1 CogVision dataset construction
2026-01-02 12:19:37,916 - query_agent - INFO -   Subquery 2: CogVision dataset creation process GPT-4.1
2026-01-02 12:19:37,916 - query_agent - INFO -   Subquery 3: GPT-4.1 role in CogVision dataset
2026-01-02 12:19:37,916 - query_agent - INFO -   Subquery 4: CogVision dataset methodology GPT-4.1 involvement
2026-01-02 12:19:37,916 - query_agent - INFO - RAG internal retrieval query: GPT-4.1 CogVision dataset construction
2026-01-02 12:19:37,999 - query_agent - INFO - RAG retrieved 3 documents for subquery 'GPT-4.1 CogVision dataset construction'
2026-01-02 12:19:38,000 - query_agent - INFO - RAG internal retrieval query: CogVision dataset creation process GPT-4.1
2026-01-02 12:19:38,090 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset creation process GPT-4.1'
2026-01-02 12:19:38,090 - query_agent - INFO - RAG internal retrieval query: GPT-4.1 role in CogVision dataset
2026-01-02 12:19:38,172 - query_agent - INFO - RAG retrieved 3 documents for subquery 'GPT-4.1 role in CogVision dataset'
2026-01-02 12:19:38,172 - query_agent - INFO - RAG internal retrieval query: CogVision dataset methodology GPT-4.1 involvement
2026-01-02 12:19:38,262 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset methodology GPT-4.1 involvement'
2026-01-02 12:19:38,263 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:19:38,263 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:19:38,263 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_8
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:19:38,263 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_9
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:19:38,263 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:19:38,263 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=28266
2026-01-02 12:19:38,263 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:19:38,264 - query_agent - INFO - Graph Tool invoked with user query: What relationship exists between "GPT-4.1" and the "CogVision" dataset construction process?
2026-01-02 12:19:38,264 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:19:40,272 - query_agent - INFO - Resolving entities from graph for query: What relationship exists between "GPT-4.1" and the "CogVision" dataset construction process?
2026-01-02 12:19:40,467 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- CogVision Dataset (Dataset)
- CogVision Dataset (Concept)
- CogVision (Dataset)
- MNIST dataset (Concept)
- okvqa Dataset (Concept)
2026-01-02 12:19:40,656 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:19:43,709 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:19:43,709 - query_agent - INFO - None
2026-01-02 12:19:43,709 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:19:43,709 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:19:44,754 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'CogVision Dataset'}, 'MENTIONS', {'chunk_index': '5', 'chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '8b83039a78b7cb477ca7090ed45387fd', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5', 'chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5'}, 'MENTIONS', {'id': 'TopK'}, 'MENTIONS', {'chunk_index': '5', 'chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '9b044b7451050bca38d39e5e1b14111e', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5', 'chunk_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5'}, 'MENTIONS', {'id': 'MNIST dataset'}]}

Neighborhood of Concept 'CogVision Dataset':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'd11ea42ea84f64f79324d9d9907a5e64'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'aed6cdc4707517e631fbdd3214804411'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '8b83039a78b7cb477ca7090ed45387fd'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Inference'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Math Reasoning'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Language Knowledge Recall'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Decision-Making'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Vision Knowledge Recall'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'multimodal reasoning'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'High-Level Vision Reception'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Semantic Understanding'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Low-Level Vision Reception'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Chain of Thought (CoT) prompting'}
{'rel': 'APPLIED_TO', 'n_labels': ['Model'], 'n_id': 'InternVL3-8B'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Intervention'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Positive Intervention'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'annotation pipeline'}
{'rel': 'ADDRESSES', 'n_labels': ['Concept'], 'n_id': 'Hierarchical structure'}
{'rel': 'INSPIRED_BY', 'n_labels': ['Concept'], 'n_id': 'Human cognitive processes'}

Chunks (resolved from Document.source_id):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_index: 5
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: _dadt_ _[≥]_ [0][. Thus trajectories cannot cross below] _[ m]_ [. Therefore,]

the interval [ _m, M_ ] is forward-invariant.


To see this explicitly under Euler discretization with step
size ∆ _t >_ 0,


_a_ ( _t_ + ∆ _t_ ) = _at_ + ∆ _t ·_ _[da]_ (36)

_dt_ _[.]_



At _a_ = _M_, _[da]_ _dt_ _[≤]_ [0 =] _[⇒]_ _[a]_ [(] _[t]_ [ + ∆] _[t]_ [)] _[ ≤]_ _[M]_ [. At] _[ a]_ [ =] _[ m]_ [,]

_dadt_ _[≥]_ [0 =] _[⇒]_ _[a]_ [(] _[t]_ [ + ∆] _[t]_ [)] _[ ≥]_ _[m]_ [. By induction over steps,]

_at ∈_ [ _m, M_ ] for all _t ∈_ [0 _, T_ ].



12


**Neuronal Attention Circuit (NAC) for Representation Le…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_index: 5
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: The statistics for the CogVision dataset is shown in Table 8


16


Table 8: Dataset Statistics


**Metric** **Training** **Testing**


Main Questions 1,124 285
Sub-questions 4,603 1,141


**Cognitive Skills Distribution**


High-Level Vision Reception 1,262 (27.42%) 336 (29.45%)
Math Reasoning 570 (12.38%) 125 (10.96%)
Semantic Understanding 545 (11.84%) 152 (13.32%)
Inference 544 (11.82%) 126 (11.04%)
Decision-Making 454 (9.86%) 111 (9.73%)
Language Knowledge Recall 424 (9.21%) 102 (8.94%)
Vision Knowledge Recall 403 (8.76%) 96 (8.41%)
Low-Level Vision Reception 401 (8.71%) 92 (8.06%)


A.4 …
2026-01-02 12:19:45,039 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:19:50,099 - __main__ - INFO - Processing query: What specific "activation function" is used in the "Feed Forward Network" of the Transformer?
2026-01-02 12:19:50,100 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:19:50,102 - query_agent - INFO - RAG Tool invoked with user query: What specific "activation function" is used in the "Feed Forward Network" of the Transformer?
2026-01-02 12:19:50,344 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:19:50,345 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:19:50,345 - query_agent - INFO -   Subquery 1: Transformer Feed Forward Network activation function
2026-01-02 12:19:50,345 - query_agent - INFO -   Subquery 2: Transformer FFN activation function
2026-01-02 12:19:50,345 - query_agent - INFO -   Subquery 3: activation function used in Transformer Feed Forward layer
2026-01-02 12:19:50,346 - query_agent - INFO - RAG internal retrieval query: Transformer Feed Forward Network activation function
2026-01-02 12:19:50,421 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer Feed Forward Network activation function'
2026-01-02 12:19:50,421 - query_agent - INFO - RAG internal retrieval query: Transformer FFN activation function
2026-01-02 12:19:50,503 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer FFN activation function'
2026-01-02 12:19:50,504 - query_agent - INFO - RAG internal retrieval query: activation function used in Transformer Feed Forward layer
2026-01-02 12:19:50,594 - query_agent - INFO - RAG retrieved 3 documents for subquery 'activation function used in Transformer Feed Forward layer'
2026-01-02 12:19:50,594 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:19:50,594 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:19:50,594 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:19:50,595 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:19:50,595 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_5
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:19:50,595 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:19:50,595 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=33351
2026-01-02 12:19:50,595 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:19:50,596 - query_agent - INFO - Graph Tool invoked with user query: What specific "activation function" is used in the "Feed Forward Network" of the Transformer?
2026-01-02 12:19:50,596 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:19:52,569 - query_agent - INFO - Resolving entities from graph for query: What specific "activation function" is used in the "Feed Forward Network" of the Transformer?
2026-01-02 12:19:52,766 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Feed Forward Network (Model)
- Feed Forward Network (Concept)
- Activation function (Concept)
- In-Domain Data (Concept)
- Chain-of-of-thought (Concept)
2026-01-02 12:19:52,974 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:20:01,561 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:20:01,561 - query_agent - INFO - MATCH (ffn:Model {id: "Feed Forward Network"})-[:USES]->(specific_af:Concept)-[:IS_A]->(general_af:Concept {id: "Activation function"})
RETURN specific_af.id
2026-01-02 12:20:01,562 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:20:01,563 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:20:02,732 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Direct Concept-Concept edges:
{'a': 'Feed Forward Network', 'rel': 'BUILDS_ON', 'b': 'Activation function'}

Co-mention via Document evidence:
{'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4', 'source_type': 'chunk', 'chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'chunk_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4', 'chunk_index': '4', 'markdown_source': None}

Shortest paths (<=4 hops):
{'p': [{'id': 'Feed Forward Network'}, 'BUILDS_ON', {'id': 'Activation function'}]}

Neighborhood of Concept 'Feed Forward Network':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'c35df05545627694d3b4bbf52619a5da'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '4e87a758911b5ed6da32ce7e17b0bbf5'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_2_0'}
{'rel': 'BUILDS_ON', 'n_labels': ['Concept'], 'n_id': 'Activation function'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Encoder'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Decoder'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Model'], 'n_id': 'Neuronal Attention Circuit (NAC)'}

Images (from graph):
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Feed Forward Network
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Feed Forward Network
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Feed Forward Network
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Feed Forward Network
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Feed Forward Network
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Feed Forward Network
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Activation function
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Activation function
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Activation function
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Activation function
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Activation function
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Activation function

Chunks (resolved from Document.source_id):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_index: 4
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: Rubanova, Y., Chen, R. T., and Duvenaud, D. K. Latent
ordinary differential equations for irregularly-sampled
time series. _Advances in neural information processing_
_systems_, 32, 2019.


Rumelhart, D. E., Hinton, G. E., and Williams, R. J. Learning internal representations by error propagation. Technical report, 1985.


Shibuya, N. Car behavioral cloning, 2017. URL
[https://github.com/naokishibuya/](https://github.com/naokishibuya/car-behavioral-cloning)
[car-behavioral-cloning.](https://github.com/naokishibuya/car-behavioral-cloning) Accessed: 202510-05.


Shukla, S. N. and Marlin, B. M. M…
2026-01-02 12:20:02,939 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:20:09,650 - __main__ - INFO - Processing query: What is the "sampling rate" associated with the "PRONOSTIA dataset" in the NAC experiments?
2026-01-02 12:20:09,650 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:20:09,651 - query_agent - INFO - RAG Tool invoked with user query: What is the "sampling rate" associated with the "PRONOSTIA dataset" in the NAC experiments?
2026-01-02 12:20:09,892 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:20:09,894 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:20:09,894 - query_agent - INFO -   Subquery 1: PRONOSTIA dataset sampling rate NAC experiments
2026-01-02 12:20:09,895 - query_agent - INFO -   Subquery 2: sampling frequency PRONOSTIA dataset
2026-01-02 12:20:09,895 - query_agent - INFO -   Subquery 3: NAC experiments PRONOSTIA dataset data acquisition rate
2026-01-02 12:20:09,895 - query_agent - INFO - RAG internal retrieval query: PRONOSTIA dataset sampling rate NAC experiments
2026-01-02 12:20:10,059 - query_agent - INFO - RAG retrieved 3 documents for subquery 'PRONOSTIA dataset sampling rate NAC experiments'
2026-01-02 12:20:10,059 - query_agent - INFO - RAG internal retrieval query: sampling frequency PRONOSTIA dataset
2026-01-02 12:20:10,150 - query_agent - INFO - RAG retrieved 3 documents for subquery 'sampling frequency PRONOSTIA dataset'
2026-01-02 12:20:10,151 - query_agent - INFO - RAG internal retrieval query: NAC experiments PRONOSTIA dataset data acquisition rate
2026-01-02 12:20:10,244 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC experiments PRONOSTIA dataset data acquisition rate'
2026-01-02 12:20:10,244 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:20:10,244 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_6
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:20:10,244 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:20:10,245 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_15
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:20:10,245 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_16
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:20:10,245 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=18619
2026-01-02 12:20:10,245 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:20:10,246 - query_agent - INFO - Graph Tool invoked with user query: What is the "sampling rate" associated with the "PRONOSTIA dataset" in the NAC experiments?
2026-01-02 12:20:10,246 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:20:12,426 - query_agent - INFO - Resolving entities from graph for query: What is the "sampling rate" associated with the "PRONOSTIA dataset" in the NAC experiments?
2026-01-02 12:20:12,655 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- PRONOSTIA dataset (Concept)
- In-Domain Data (Concept)
- NAC (Model)
- Fine-tuning with SWA (Algorithm)
- NAC-Euler (Concept)
2026-01-02 12:20:12,851 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:20:25,020 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:20:25,020 - query_agent - INFO - MATCH (pronostia:Concept {id: 'PRONOSTIA dataset'})
MATCH (nac:Model {id: 'NAC'})
MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(pronostia)
  AND (d)-[:MENTIONS]->(nac)
  AND d.source_type = 'chunk'
RETURN d.text, d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:20:25,020 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'d.text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'd.source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_index': '3'}]
2026-01-02 12:20:25,295 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'d.text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'd.source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_index': '3'}

Images (from graph):
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=PRONOSTIA dataset
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=PRONOSTIA dataset
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=PRONOSTIA dataset
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=PRONOSTIA dataset
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=PRONOSTIA dataset
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=PRONOSTIA dataset
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_index: 3
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: _Figure 3._ Degradation Estimation Results.


compact architecture suitable for resource-constrained devices, thereby supporting localized safety.
We utilized three benchmark datasets: (i) PRONOSTIA
(Nectoux et al., 2012), (ii) XJTU-SY (Wang et al., 2018),
and (iii) HUST (Thuan & Hong, 2023). Training is performed on PRONOSTIA, while XJTU-SY and HUST are

used to assess cross-validation. We used the Score met
ric (Nectoux et al., 2012) to assess the performance. We
evaluate generalization using _Bearing 1_ from the first operating condition of each dataset. Figure 3 visualizes the
expected deg…
2026-01-02 12:20:25,601 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:20:31,668 - __main__ - INFO - Processing query: Identify the "rank r" parameter value used for "LoRA" fine-tuning in the SWAA experiments.
2026-01-02 12:20:31,669 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:20:31,669 - query_agent - INFO - RAG Tool invoked with user query: Identify the "rank r" parameter value used for "LoRA" fine-tuning in the SWAA experiments.
2026-01-02 12:20:32,086 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:20:32,086 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:20:32,087 - query_agent - INFO -   Subquery 1: SWAA experiments LoRA fine-tuning rank r
2026-01-02 12:20:32,087 - query_agent - INFO -   Subquery 2: LoRA rank r SWAA
2026-01-02 12:20:32,087 - query_agent - INFO -   Subquery 3: SWAA LoRA fine-tuning parameters
2026-01-02 12:20:32,087 - query_agent - INFO - RAG internal retrieval query: SWAA experiments LoRA fine-tuning rank r
2026-01-02 12:20:32,183 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA experiments LoRA fine-tuning rank r'
2026-01-02 12:20:32,183 - query_agent - INFO - RAG internal retrieval query: LoRA rank r SWAA
2026-01-02 12:20:32,266 - query_agent - INFO - RAG retrieved 3 documents for subquery 'LoRA rank r SWAA'
2026-01-02 12:20:32,267 - query_agent - INFO - RAG internal retrieval query: SWAA LoRA fine-tuning parameters
2026-01-02 12:20:32,366 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA LoRA fine-tuning parameters'
2026-01-02 12:20:32,367 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:20:32,367 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:20:32,367 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:20:32,367 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:20:32,367 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:20:32,368 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=28890
2026-01-02 12:20:32,368 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:20:32,368 - query_agent - INFO - Graph Tool invoked with user query: Identify the "rank r" parameter value used for "LoRA" fine-tuning in the SWAA experiments.
2026-01-02 12:20:32,368 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:20:34,201 - query_agent - INFO - Resolving entities from graph for query: Identify the "rank r" parameter value used for "LoRA" fine-tuning in the SWAA experiments.
2026-01-02 12:20:34,381 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- LoRA (Algorithm)
- long-context fine-tuning (Task)
- SWA-aware fine-tuning (Algorithm)
- Language model fine-tuning (Task)
- Fine-tuning with SWA (Algorithm)
2026-01-02 12:20:34,381 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:20:39,588 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'lora': expected '(' (line 4, column 35 (offset: 158))
"MATCH (doc:Document)-[:MENTIONS]->lora"
                                   ^}
neo4j.exceptions.GqlError: {gql_status: 42I06} {gql_status_description: error: syntax error or access rule violation - invalid input. Invalid input 'lora', expected: '('.} {message: 42I06: Invalid input 'lora', expected: '('.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', '_position': {'offset': 158, 'column': 35, 'line': 4}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.CypherSyntaxError: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'lora': expected '(' (line 4, column 35 (offset: 158))
"MATCH (doc:Document)-[:MENTIONS]->lora"
                                   ^}
2026-01-02 12:20:39,604 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:20:41,919 - __main__ - INFO - Processing query: What "model scales" of the "Qwen" family were tested in the "Investigating the Functional Roles..." paper?
2026-01-02 12:20:41,920 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:20:41,921 - query_agent - INFO - RAG Tool invoked with user query: What "model scales" of the "Qwen" family were tested in the "Investigating the Functional Roles..." paper?
2026-01-02 12:20:42,176 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:20:42,177 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:20:42,178 - query_agent - INFO -   Subquery 1: Qwen model scales in Investigating the Functional Roles paper
2026-01-02 12:20:42,178 - query_agent - INFO -   Subquery 2: Investigating the Functional Roles Qwen model sizes
2026-01-02 12:20:42,178 - query_agent - INFO -   Subquery 3: Qwen family model scales tested in Investigating the Functional Roles
2026-01-02 12:20:42,179 - query_agent - INFO - RAG internal retrieval query: Qwen model scales in Investigating the Functional Roles paper
2026-01-02 12:20:42,262 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Qwen model scales in Investigating the Functional Roles paper'
2026-01-02 12:20:42,263 - query_agent - INFO - RAG internal retrieval query: Investigating the Functional Roles Qwen model sizes
2026-01-02 12:20:42,344 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Investigating the Functional Roles Qwen model sizes'
2026-01-02 12:20:42,345 - query_agent - INFO - RAG internal retrieval query: Qwen family model scales tested in Investigating the Functional Roles
2026-01-02 12:20:42,438 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Qwen family model scales tested in Investigating the Functional Roles'
2026-01-02 12:20:42,439 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:20:42,439 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_3
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:20:42,439 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_10
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:20:42,439 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:20:42,440 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_11
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:20:42,440 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=24457
2026-01-02 12:20:42,440 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:20:42,440 - query_agent - INFO - Graph Tool invoked with user query: What "model scales" of the "Qwen" family were tested in the "Investigating the Functional Roles..." paper?
2026-01-02 12:20:42,441 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:20:44,483 - query_agent - INFO - Resolving entities from graph for query: What "model scales" of the "Qwen" family were tested in the "Investigating the Functional Roles..." paper?
2026-01-02 12:20:44,675 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Qwen Family (Model)
- Qwen (Model)
- Llama Family (Model)
- Model Family (Concept)
- In-Domain Data (Concept)
2026-01-02 12:20:44,850 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:20:57,972 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:20:57,973 - query_agent - INFO - cypher
MATCH (pub:Publication {id: "Investigating the Functional Roles of Large Language Models in Scientific Discovery"})
MATCH (d:Document)-[:MENTIONS]->(pub)
MATCH (d)-[:MENTIONS]->(qwenModel:Model)
WHERE qwenModel.id CONTAINS "Qwen"
RETURN DISTINCT qwenModel.id

2026-01-02 12:20:57,974 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:20:57,975 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:20:59,037 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Model Family'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '96cbda833066473ad1bb09119ce583e3', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'Chain of Thought (CoT) prompting'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'In-Domain Data'}]}

Neighborhood of Concept 'Model Family':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '96cbda833066473ad1bb09119ce583e3'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: 4


For additional validation of generalizability, as
shown in Appendix D, we also experiment on
LongBench-V2 (Bai et al., 2024b), a more modern and challenging benchmark that requires deep
reasoning across various real-world tasks.


**4.3** **Training Details**


For the fine-tuning dataset, we initially considered LongAlign (Bai et al., 2024a), a widely used
long-context fine-tuning dataset for adapt a regularlength model to long-context tasks. However, since

_∼_
its sample count ( 10,000) is insufficient, we incorporate an additional 6,000 samples from Fusangv1-long (Pan, 2024), a more co…
2026-01-02 12:20:59,236 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:21:06,055 - __main__ - INFO - Processing query: What is the "dimension d_model" used for the base model in "Attention Is All You Need"?
2026-01-02 12:21:06,055 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:21:06,056 - query_agent - INFO - RAG Tool invoked with user query: What is the "dimension d_model" used for the base model in "Attention Is All You Need"?
2026-01-02 12:21:06,285 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:21:06,288 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:21:06,289 - query_agent - INFO -   Subquery 1: Attention Is All You Need base model d_model
2026-01-02 12:21:06,290 - query_agent - INFO -   Subquery 2: d_model dimension in Transformer base model
2026-01-02 12:21:06,291 - query_agent - INFO -   Subquery 3: Transformer base model dimensions
2026-01-02 12:21:06,291 - query_agent - INFO - RAG internal retrieval query: Attention Is All You Need base model d_model
2026-01-02 12:21:06,393 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Attention Is All You Need base model d_model'
2026-01-02 12:21:06,393 - query_agent - INFO - RAG internal retrieval query: d_model dimension in Transformer base model
2026-01-02 12:21:06,472 - query_agent - INFO - RAG retrieved 3 documents for subquery 'd_model dimension in Transformer base model'
2026-01-02 12:21:06,473 - query_agent - INFO - RAG internal retrieval query: Transformer base model dimensions
2026-01-02 12:21:06,554 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer base model dimensions'
2026-01-02 12:21:06,554 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:21:06,555 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:21:06,555 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:21:06,555 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_5
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:21:06,555 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:21:06,555 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_3
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:21:06,555 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=33395
2026-01-02 12:21:06,556 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:21:06,556 - query_agent - INFO - Graph Tool invoked with user query: What is the "dimension d_model" used for the base model in "Attention Is All You Need"?
2026-01-02 12:21:06,556 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:21:08,548 - query_agent - INFO - Resolving entities from graph for query: What is the "dimension d_model" used for the base model in "Attention Is All You Need"?
2026-01-02 12:21:08,733 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- lane-keeping for autonomous vehicles (Task)
- Model Architectures (Concept)
- model accuracy (Concept)
- Model Output (Concept)
2026-01-02 12:21:08,920 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:21:18,644 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:21:18,645 - query_agent - INFO - MATCH (d:Document)
WHERE d.text CONTAINS "Attention Is All You Need"
  AND d.text CONTAINS "dimension d_model"
  AND d.text CONTAINS "base model"
RETURN d.text, d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:21:18,645 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:21:18,646 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:21:19,724 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain of Thought (CoT) prompting'}, 'MENTIONS', {'chunk_index': '2', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'aeb58d067782fbf07367eb644b06ca8b', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2'}, 'MENTIONS', {'id': 'Model Architectures'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: Yushi Bai, Shangqing Tu, Jiajie Zhang, Hao Peng, Xiaozhi Wang, Xin Lv, Shulin Cao, Jiazheng Xu, Lei
Hou, Yuxiao Dong, Jie Tang, and Juanzi Li. 2024b.
[Longbench v2: Towards deeper understanding and](https://arxiv.org/abs/2412.15204)
[reasoning on realistic long-context multitasks.](https://arxiv.org/abs/2412.15204)


Iz Beltagy, Matthew E. Peters, and Arman Cohan. 2020.

[Longformer: The long-document transformer.](https://arxiv.org/abs/2004.05150)


[Tri Dao. 2024. Flashattention-2: Faster attention with](https://openreview.net/forum?id=mZn2Xyh9Ec)
[better parallelism and work partitioning.](…
2026-01-02 12:21:19,926 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:21:23,027 - __main__ - INFO - Processing query: Which "baseline models" were used for comparison in the "Lane-Keeping of Autonomous Vehicles" experiment for NAC?
2026-01-02 12:21:23,027 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:21:23,028 - query_agent - INFO - RAG Tool invoked with user query: Which "baseline models" were used for comparison in the "Lane-Keeping of Autonomous Vehicles" experiment for NAC?
2026-01-02 12:21:23,482 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:21:23,485 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:21:23,486 - query_agent - INFO -   Subquery 1: NAC Lane-Keeping Autonomous Vehicles baseline models
2026-01-02 12:21:23,487 - query_agent - INFO -   Subquery 2: Lane-Keeping Autonomous Vehicles experiment baseline models NAC
2026-01-02 12:21:23,487 - query_agent - INFO -   Subquery 3: baseline models used in NAC Lane-Keeping Autonomous Vehicles comparison
2026-01-02 12:21:23,488 - query_agent - INFO - RAG internal retrieval query: NAC Lane-Keeping Autonomous Vehicles baseline models
2026-01-02 12:21:23,592 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC Lane-Keeping Autonomous Vehicles baseline models'
2026-01-02 12:21:23,593 - query_agent - INFO - RAG internal retrieval query: Lane-Keeping Autonomous Vehicles experiment baseline models NAC
2026-01-02 12:21:23,675 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Lane-Keeping Autonomous Vehicles experiment baseline models NAC'
2026-01-02 12:21:23,675 - query_agent - INFO - RAG internal retrieval query: baseline models used in NAC Lane-Keeping Autonomous Vehicles comparison
2026-01-02 12:21:23,771 - query_agent - INFO - RAG retrieved 3 documents for subquery 'baseline models used in NAC Lane-Keeping Autonomous Vehicles comparison'
2026-01-02 12:21:23,771 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 3
2026-01-02 12:21:23,771 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_5
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:21:23,772 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:21:23,772 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:21:23,772 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=3, total_chars=17947
2026-01-02 12:21:23,772 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:21:23,773 - query_agent - INFO - Graph Tool invoked with user query: Which "baseline models" were used for comparison in the "Lane-Keeping of Autonomous Vehicles" experiment for NAC?
2026-01-02 12:21:23,773 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:21:25,631 - query_agent - INFO - Resolving entities from graph for query: Which "baseline models" were used for comparison in the "Lane-Keeping of Autonomous Vehicles" experiment for NAC?
2026-01-02 12:21:25,823 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- lane-keeping for autonomous vehicles (Task)
- Comparison (Task)
- In-Domain Data (Concept)
2026-01-02 12:21:25,825 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:21:38,243 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:21:38,244 - query_agent - INFO - MATCH (t:Task {id: "lane-keeping for autonomous vehicles"})
MATCH (m:Model)-[:COMPARED_WITH]->(t)
RETURN m.id
2026-01-02 12:21:38,245 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:21:38,245 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:21:39,237 - query_agent - INFO - Graph context returned to LLM:
No graph connections found (even after fallbacks).
2026-01-02 12:21:39,420 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:21:43,703 - __main__ - INFO - Processing query: What "window size" was primarily used for the "aggressive" SWA settings in the SWAA experiments?
2026-01-02 12:21:43,704 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:21:43,706 - query_agent - INFO - RAG Tool invoked with user query: What "window size" was primarily used for the "aggressive" SWA settings in the SWAA experiments?
2026-01-02 12:21:43,952 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:21:43,953 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:21:43,953 - query_agent - INFO -   Subquery 1: SWA experiments SWAA aggressive settings window size
2026-01-02 12:21:43,953 - query_agent - INFO -   Subquery 2: SWAA experiments aggressive SWA settings window size used
2026-01-02 12:21:43,953 - query_agent - INFO -   Subquery 3: aggressive SWA settings SWAA window size
2026-01-02 12:21:43,954 - query_agent - INFO - RAG internal retrieval query: SWA experiments SWAA aggressive settings window size
2026-01-02 12:21:44,037 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWA experiments SWAA aggressive settings window size'
2026-01-02 12:21:44,037 - query_agent - INFO - RAG internal retrieval query: SWAA experiments aggressive SWA settings window size used
2026-01-02 12:21:44,130 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA experiments aggressive SWA settings window size used'
2026-01-02 12:21:44,130 - query_agent - INFO - RAG internal retrieval query: aggressive SWA settings SWAA window size
2026-01-02 12:21:44,221 - query_agent - INFO - RAG retrieved 3 documents for subquery 'aggressive SWA settings SWAA window size'
2026-01-02 12:21:44,221 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:21:44,221 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:21:44,222 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:21:44,222 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:21:44,222 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:21:44,222 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=29447
2026-01-02 12:21:44,222 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:21:44,223 - query_agent - INFO - Graph Tool invoked with user query: What "window size" was primarily used for the "aggressive" SWA settings in the SWAA experiments?
2026-01-02 12:21:44,223 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:21:46,261 - query_agent - INFO - Resolving entities from graph for query: What "window size" was primarily used for the "aggressive" SWA settings in the SWAA experiments?
2026-01-02 12:21:46,457 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- window size (Concept)
- Sliding window size (Concept)
- SWA (Model)
- In-Domain Data (Concept)
- SWA adaptation (Algorithm)
2026-01-02 12:21:46,635 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:21:58,107 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:21:58,108 - query_agent - INFO - MATCH (swa:Model {id: 'SWA'})
MATCH (swaa:Algorithm {id: 'SWA adaptation'})
MATCH (c_ws:Concept)
WHERE c_ws.id IN ['window size', 'Sliding window size']

MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(swa)
  AND (d)-[:MENTIONS]->(swaa)
  AND (d)-[:MENTIONS]->(c_ws)
  AND d.text CONTAINS 'aggressive'

RETURN c_ws.id AS aggressive_window_size_concept
LIMIT 1
2026-01-02 12:21:58,109 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:21:58,110 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:21:59,164 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'window size'}, 'EXTENDS', {'id': 'Inference'}, 'APPLIED_TO', {'id': 'vLLM'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '96cbda833066473ad1bb09119ce583e3', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'Sliding window size'}]}

Neighborhood of Concept 'window size':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36d6d3991d7661965006df25ff1dab26'}
{'rel': 'EXTENDS', 'n_labels': ['Concept'], 'n_id': 'Inference'}

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: 4


For additional validation of generalizability, as
shown in Appendix D, we also experiment on
LongBench-V2 (Bai et al., 2024b), a more modern and challenging benchmark that requires deep
reasoning across various real-world tasks.


**4.3** **Training Details**


For the fine-tuning dataset, we initially considered LongAlign (Bai et al., 2024a), a widely used
long-context fine-tuning dataset for adapt a regularlength model to long-context tasks. However, since

_∼_
its sample count ( 10,000) is insufficient, we incorporate an additional 6,000 samples from Fusangv1-long (Pan, 2024), a more co…
2026-01-02 12:21:59,397 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:22:02,160 - __main__ - INFO - Processing query: Who are the "correspondence authors" listed for the "Neuronal Attention Circuit" paper?
2026-01-02 12:22:02,161 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:22:02,163 - query_agent - INFO - RAG Tool invoked with user query: Who are the "correspondence authors" listed for the "Neuronal Attention Circuit" paper?
2026-01-02 12:22:02,389 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:22:02,392 - query_agent - INFO - Generated 2 RAG subqueries:
2026-01-02 12:22:02,392 - query_agent - INFO -   Subquery 1: Neuronal Attention Circuit paper correspondence authors
2026-01-02 12:22:02,393 - query_agent - INFO -   Subquery 2: "Neuronal Attention Circuit" correspondence authors
2026-01-02 12:22:02,394 - query_agent - INFO - RAG internal retrieval query: Neuronal Attention Circuit paper correspondence authors
2026-01-02 12:22:02,485 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Attention Circuit paper correspondence authors'
2026-01-02 12:22:02,486 - query_agent - INFO - RAG internal retrieval query: "Neuronal Attention Circuit" correspondence authors
2026-01-02 12:22:02,566 - query_agent - INFO - RAG retrieved 3 documents for subquery '"Neuronal Attention Circuit" correspondence authors'
2026-01-02 12:22:02,567 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 3
2026-01-02 12:22:02,567 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:02,567 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_10
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:02,567 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:02,567 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=3, total_chars=20324
2026-01-02 12:22:02,568 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:22:02,568 - query_agent - INFO - Graph Tool invoked with user query: Who are the "correspondence authors" listed for the "Neuronal Attention Circuit" paper?
2026-01-02 12:22:02,568 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:22:04,450 - query_agent - INFO - Resolving entities from graph for query: Who are the "correspondence authors" listed for the "Neuronal Attention Circuit" paper?
2026-01-02 12:22:04,626 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Neuronal Attention Circuit (NAC) (Model)
- Neuronal Attention Circuit (NAC) (Concept)
- Multi-Head Neuronal Attention Circuit (Concept)
- lane-keeping for autonomous vehicles (Task)
2026-01-02 12:22:04,797 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:22:10,511 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: Model OR entity)} {position: line: 2, column: 66, offset: 80} for query: "MATCH (entity)\nWHERE entity.id = 'Neuronal Attention Circuit (NAC)' AND (entity:`Model OR entity`:Concept)\nMATCH (entity)-[:INTRODUCED_BY]->(pub:Publication)\nMATCH (author:Person)-[:AUTHORED_BY]->(pub)\nRETURN DISTINCT author.id"
2026-01-02 12:22:11,832 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:22:11,833 - query_agent - INFO - MATCH (entity)
WHERE entity.id = 'Neuronal Attention Circuit (NAC)' AND (entity:`Model OR entity`:Concept)
MATCH (entity)-[:INTRODUCED_BY]->(pub:Publication)
MATCH (author:Person)-[:AUTHORED_BY]->(pub)
RETURN DISTINCT author.id
2026-01-02 12:22:11,834 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:22:11,834 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:22:12,798 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Neuronal Attention Circuit (NAC)'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-Head Neuronal Attention Circuit'}]}

Neighborhood of Concept 'Neuronal Attention Circuit (NAC)':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_neuronal_attention_circuits_5_0'}

Images (from graph):
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Multi-Head Neuronal Attention Circuit

Chunks (inferred from derived_from_chunk_file):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## **Neuronal Attention Circuit (NAC) for Representation Learning**

**Waleed Razzaq** [1] **Izis Kankaraway** [1] **Yun-Bo Zhao** [1 2]



**Abstract**

Attention improves representation learning over
RNNs, but its discrete nature limits continuoustime (CT) modeling. We introduce Neuronal Attention Circuit (NAC), a novel, biologically plausible CT-Attention mechanism that reformulates

attention logits computation as the solution to a
linear first-order ODE with nonlinear interlinked
gates derived from repurposing _C. elegans_ Neuronal Circuit Policies (NCPs) wiring mechanism.
NAC replaces de…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _|at −_ _a_ _[∗]_ _| ≤_ _Me_ _[−][ω][τ][ t]_ _._ (10)


_Remark:_ This bound highlights that exponential convergence holds uniformly across all admissible initial
conditions, with the constant _M_ capturing the worst-case
deviation.


**Corollary 3** (Sample complexity to _δ_ -accuracy) **.** _A natural_
_operational question is the time required to achieve a target_
_tolerance δ >_ 0 _. Solving_


_|a_ 0 _−_ _a_ _[∗]_ _|e_ _[−][ω][τ][ t]_ _≤_ _δ,_ (11)


_We obtain the threshold_




[1] ln _[|][a]_ [0] _[ −]_ _[a][∗][|]_

_ωτ_ _δ_



_t ≥_ [1]



_._ (12)
_δ_



_Remark:_ The convergence rat…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ```json
"img_neuronal_attention_circuits_5_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png",
    "page": 5,
    "section": "Abstract",
    "image_relevance": "high",
    "image_type": "architecture",
    "semantic_role": "defines",
    "caption": "The image presents two architectural diagrams: a Neuronal Attention Circuit (NAC) and a Multi-Head Neuronal Attention Circuit. The single-head NAC processes time-series Query, Key, and Value inputs through Sparse Topk-Pairwise, a Backbone module, a logit computation…
2026-01-02 12:22:13,126 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:22:17,734 - __main__ - INFO - Processing query: What specific "GPU hardware" was used to train the "base models" in "Attention Is All You Need"?
2026-01-02 12:22:17,735 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:22:17,735 - query_agent - INFO - RAG Tool invoked with user query: What specific "GPU hardware" was used to train the "base models" in "Attention Is All You Need"?
2026-01-02 12:22:17,972 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:22:17,974 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:22:17,975 - query_agent - INFO -   Subquery 1: GPU hardware used to train base models in Attention Is All You Need
2026-01-02 12:22:17,975 - query_agent - INFO -   Subquery 2: Attention Is All You Need base model training hardware
2026-01-02 12:22:17,976 - query_agent - INFO -   Subquery 3: GPU used for Attention Is All You Need base models
2026-01-02 12:22:17,977 - query_agent - INFO - RAG internal retrieval query: GPU hardware used to train base models in Attention Is All You Need
2026-01-02 12:22:18,070 - query_agent - INFO - RAG retrieved 3 documents for subquery 'GPU hardware used to train base models in Attention Is All You Need'
2026-01-02 12:22:18,070 - query_agent - INFO - RAG internal retrieval query: Attention Is All You Need base model training hardware
2026-01-02 12:22:18,150 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Attention Is All You Need base model training hardware'
2026-01-02 12:22:18,150 - query_agent - INFO - RAG internal retrieval query: GPU used for Attention Is All You Need base models
2026-01-02 12:22:18,234 - query_agent - INFO - RAG retrieved 3 documents for subquery 'GPU used for Attention Is All You Need base models'
2026-01-02 12:22:18,235 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:22:18,235 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:22:18,235 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_3
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:22:18,235 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_5
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:22:18,235 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:18,236 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=25013
2026-01-02 12:22:18,236 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:22:18,236 - query_agent - INFO - Graph Tool invoked with user query: What specific "GPU hardware" was used to train the "base models" in "Attention Is All You Need"?
2026-01-02 12:22:18,236 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:22:20,275 - query_agent - INFO - Resolving entities from graph for query: What specific "GPU hardware" was used to train the "base models" in "Attention Is All You Need"?
2026-01-02 12:22:20,470 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- model-specific layer selection strategies (Concept)
- Sequence to sequence learning (Concept)
- Long-Term Domain-Specific Textual Knowledge (Concept)
- End-to-end memory networks (Model)
2026-01-02 12:22:20,645 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:22:27,238 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:22:27,239 - query_agent - INFO - MATCH (p:Publication {id: "Attention Is All You Need"})<-[:MENTIONS]-(d:Document)
WHERE toLower(d.text) CONTAINS toLower("GPU hardware")
  AND toLower(d.text) CONTAINS toLower("base models")
RETURN d.text, d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:22:27,240 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:22:27,241 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:22:28,267 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain of Thought (CoT) prompting'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '96cbda833066473ad1bb09119ce583e3', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'model-specific layer selection strategies'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: 4


For additional validation of generalizability, as
shown in Appendix D, we also experiment on
LongBench-V2 (Bai et al., 2024b), a more modern and challenging benchmark that requires deep
reasoning across various real-world tasks.


**4.3** **Training Details**


For the fine-tuning dataset, we initially considered LongAlign (Bai et al., 2024a), a widely used
long-context fine-tuning dataset for adapt a regularlength model to long-context tasks. However, since

_∼_
its sample count ( 10,000) is insufficient, we incorporate an additional 6,000 samples from Fusangv1-long (Pan, 2024), a more co…
2026-01-02 12:22:28,508 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:22:31,973 - __main__ - INFO - Processing query: What is the "Pearson correlation" value observed between "cognitive masking" and "random masking" effects in VLMs?
2026-01-02 12:22:31,973 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:22:31,973 - query_agent - INFO - RAG Tool invoked with user query: What is the "Pearson correlation" value observed between "cognitive masking" and "random masking" effects in VLMs?
2026-01-02 12:22:32,206 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:22:32,209 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:22:32,210 - query_agent - INFO -   Subquery 1: Pearson correlation between cognitive masking and random masking in VLMs
2026-01-02 12:22:32,211 - query_agent - INFO -   Subquery 2: cognitive masking vs random masking Pearson correlation coefficient VLMs
2026-01-02 12:22:32,212 - query_agent - INFO -   Subquery 3: VLMs Pearson correlation cognitive masking random masking
2026-01-02 12:22:32,212 - query_agent - INFO -   Subquery 4: correlation analysis cognitive masking and random masking VLMs
2026-01-02 12:22:32,213 - query_agent - INFO - RAG internal retrieval query: Pearson correlation between cognitive masking and random masking in VLMs
2026-01-02 12:22:32,311 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Pearson correlation between cognitive masking and random masking in VLMs'
2026-01-02 12:22:32,311 - query_agent - INFO - RAG internal retrieval query: cognitive masking vs random masking Pearson correlation coefficient VLMs
2026-01-02 12:22:32,405 - query_agent - INFO - RAG retrieved 3 documents for subquery 'cognitive masking vs random masking Pearson correlation coefficient VLMs'
2026-01-02 12:22:32,405 - query_agent - INFO - RAG internal retrieval query: VLMs Pearson correlation cognitive masking random masking
2026-01-02 12:22:32,484 - query_agent - INFO - RAG retrieved 3 documents for subquery 'VLMs Pearson correlation cognitive masking random masking'
2026-01-02 12:22:32,484 - query_agent - INFO - RAG internal retrieval query: correlation analysis cognitive masking and random masking VLMs
2026-01-02 12:22:32,574 - query_agent - INFO - RAG retrieved 3 documents for subquery 'correlation analysis cognitive masking and random masking VLMs'
2026-01-02 12:22:32,574 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 3
2026-01-02 12:22:32,574 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_3
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:22:32,574 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_11
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:22:32,575 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_4
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:22:32,575 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=3, total_chars=18876
2026-01-02 12:22:32,575 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:22:32,576 - query_agent - INFO - Graph Tool invoked with user query: What is the "Pearson correlation" value observed between "cognitive masking" and "random masking" effects in VLMs?
2026-01-02 12:22:32,576 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:22:34,840 - query_agent - INFO - Resolving entities from graph for query: What is the "Pearson correlation" value observed between "cognitive masking" and "random masking" effects in VLMs?
2026-01-02 12:22:35,069 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Pearson Correlation (Concept)
- Value (Concept)
- In-Domain Data (Concept)
- Value distribution (Concept)
- Value (V) (Concept)
2026-01-02 12:22:35,293 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:22:45,492 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:22:45,492 - query_agent - INFO - MATCH (pearsonCorrelation:Concept {id: 'Pearson Correlation'})
MATCH (valueConcept:Concept {id: 'Value'})
MATCH (pearsonCorrelation)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(valueConcept)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:22:45,493 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:22:45,494 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:22:46,671 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Pearson Correlation'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Line plot'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Value'}]}

Neighborhood of Concept 'Pearson Correlation':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '07a1595cd11229732de425a45b58a638'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '6f95d18c6c709c366aa4d5c1ef007925'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '090e6ada644008ce80b83c8ee0406515'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Inference task'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Decision-Making task'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Vision Knowledge Recall task'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Information Understanding & Extraction task'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Language Knowledge Recall task'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Math Reasoning task'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Sparsity Patterns'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Heatmap'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'High-Level Vision Reception task'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Low-Level Vision Reception task'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_22_0'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_23_0'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_23_1'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_24_0'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Model'], 'n_id': 'Qwen3-30B'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'TopK'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'Full Prompt'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'w/o Main Question'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Concept'], 'n_id': 'w/o CoT'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Model'], 'n_id': 'Llama3.3-70B'}
{'rel': 'COMPARED_WITH', 'n_labels': ['Model'], 'n_id': 'GPTS'}

Images (from graph):
- img_attention_functional_roles_22_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-22-0.png | related_to=Pearson Correlation
- img_attention_functional_roles_23_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-23-0.png | related_to=Pearson Correlation
- img_attention_functional_roles_23_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-23-1.png | related_to=Pearson Correlation
- img_attention_functional_roles_24_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-24-0.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Pearson Correlation
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Pearson Correlation
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Pearson Correlation

Chunks (inferred from derived_from_chunk_file):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _|at −_ _a_ _[∗]_ _| ≤_ _Me_ _[−][ω][τ][ t]_ _._ (10)


_Remark:_ This bound highlights that exponential convergence holds uniformly across all admissible initial
conditions, with the constant _M_ capturing the worst-case
deviation.


**Corollary 3** (Sample complexity to _δ_ -accuracy) **.** _A natural_
_operational question is the time required to achieve a target_
_tolerance δ >_ 0 _. Solving_


_|a_ 0 _−_ _a_ _[∗]_ _|e_ _[−][ω][τ][ t]_ _≤_ _δ,_ (11)


_We obtain the threshold_




[1] ln _[|][a]_ [0] _[ −]_ _[a][∗][|]_

_ωτ_ _δ_



_t ≥_ [1]



_._ (12)
_δ_



_Remark:_ The convergence rat…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ```json
"img_neuronal_attention_circuits_5_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png",
    "page": 5,
    "section": "Abstract",
    "image_relevance": "high",
    "image_type": "architecture",
    "semantic_role": "defines",
    "caption": "The image presents two architectural diagrams: a Neuronal Attention Circuit (NAC) and a Multi-Head Neuronal Attention Circuit. The single-head NAC processes time-series Query, Key, and Value inputs through Sparse Topk-Pairwise, a Backbone module, a logit computation…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_index: 4
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Rubanova, Y., Chen, R. T., and Duvenaud, D. K. Latent
ordinary differential equations for irregularly-sampled
time series. _Advances in neural information processing_
_systems_, 32, 2019.


Rumelhart, D. E., Hinton, G. E., and Williams, R. J. Learning internal representations by error propagation. Technical report, 1985.


Shibuya, N. Car behavioral cloning, 2017. URL
[https://github.com/naokishibuya/](https://github.com/naokishibuya/car-behavioral-cloning)
[car-behavioral-cloning.](https://github.com/naokishibuya/car-behavioral-cloning) Accessed: 202510-05.


Shukla, S. N. and Marlin, B. M. M…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: In addition to masking, we also conduct activation patching, where the activations of cognitive heads
associated with one function are replaced by those from another function using two strategies: ran

6




```json
"img_attention_functional_roles_5_1": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png",
    "page": 5,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_index: 4
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Tanik Saikh, Tirthankar Ghosal, Amish Mittal, Asif Ekbal, and Pushpak Bhattacharyya. Scienceqa:
A novel resource for question answering on scholarly articles. _International Journal on Digital_
_Libraries_, 23(3):289–301, 2022.


Martin Schrimpf, Idan Asher Blank, Greta Tuckute, Carina Kauf, Eghbal A Hosseini, Nancy Kanwisher, Joshua B Tenenbaum, and Evelina Fedorenko. The neural architecture of language: Integrative modeling converges on predictive processing. _Proceedings of the National Academy of_
_Sciences_, 118(45):e2105646118, 2021.


Luca M Schulze Buschoff, Elif Akata, Matthias Bethge…
2026-01-02 12:22:47,023 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:22:56,821 - __main__ - INFO - Processing query: Compare the computational complexity of the Neuronal Attention Circuit (NAC) with the standard self-attention mechanism described in "Attention Is All You Need".
2026-01-02 12:22:56,821 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:22:56,822 - query_agent - INFO - RAG Tool invoked with user query: Compare the computational complexity of the Neuronal Attention Circuit (NAC) with the standard self-attention mechanism described in "Attention Is All You Need".
2026-01-02 12:22:57,081 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:22:57,084 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:22:57,085 - query_agent - INFO -   Subquery 1: Neuronal Attention Circuit (NAC) computational complexity
2026-01-02 12:22:57,086 - query_agent - INFO -   Subquery 2: standard self-attention mechanism computational complexity 'Attention Is All You Need'
2026-01-02 12:22:57,086 - query_agent - INFO -   Subquery 3: NAC vs self-attention complexity comparison
2026-01-02 12:22:57,087 - query_agent - INFO - RAG internal retrieval query: Neuronal Attention Circuit (NAC) computational complexity
2026-01-02 12:22:57,187 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Attention Circuit (NAC) computational complexity'
2026-01-02 12:22:57,187 - query_agent - INFO - RAG internal retrieval query: standard self-attention mechanism computational complexity 'Attention Is All You Need'
2026-01-02 12:22:57,284 - query_agent - INFO - RAG retrieved 3 documents for subquery 'standard self-attention mechanism computational complexity 'Attention Is All You Need''
2026-01-02 12:22:57,284 - query_agent - INFO - RAG internal retrieval query: NAC vs self-attention complexity comparison
2026-01-02 12:22:57,364 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC vs self-attention complexity comparison'
2026-01-02 12:22:57,364 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:22:57,364 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:57,365 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:57,365 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:57,365 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:22:57,365 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:22:57,365 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:22:57,366 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:22:57,366 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=49164
2026-01-02 12:22:57,366 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:22:57,367 - query_agent - INFO - Graph Tool invoked with user query: Compare the computational complexity of the Neuronal Attention Circuit (NAC) with the standard self-attention mechanism described in "Attention Is All You Need".
2026-01-02 12:22:57,367 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:22:59,426 - query_agent - INFO - Resolving entities from graph for query: Compare the computational complexity of the Neuronal Attention Circuit (NAC) with the standard self-attention mechanism described in "Attention Is All You Need".
2026-01-02 12:22:59,624 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Neuronal Attention Circuit (NAC) (Concept)
- Neuronal Attention Circuit (NAC) (Model)
- Self-attention mechanism (Concept)
- self-attention mechanism (Concept)
- Attention mechanism (Concept)
2026-01-02 12:22:59,796 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:23:14,244 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Statement.SyntaxError} {message: All sub queries in an UNION must have the same return column names (line 8, column 1 (offset: 291))
"UNION"
 ^}
neo4j.exceptions.GqlError: {gql_status: 42N39} {gql_status_description: error: syntax error or access rule violation - incompatible return column names. All UNION subqueries must have the same return column names. Use `AS` to ensure columns have the same name.} {message: 42N39: All UNION subqueries must have the same return column names. Use `AS` to ensure columns have the same name.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', '_position': {'offset': 291, 'column': 1, 'line': 8}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.CypherSyntaxError: {code: Neo.ClientError.Statement.SyntaxError} {message: All sub queries in an UNION must have the same return column names (line 8, column 1 (offset: 291))
"UNION"
 ^}
2026-01-02 12:23:14,250 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:23:30,316 - __main__ - INFO - Processing query: How does the "Interleaving Layers" strategy in SWAA compare to the hierarchical organization of functional heads discussed in the CogVision paper?
2026-01-02 12:23:30,316 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:23:30,317 - query_agent - INFO - RAG Tool invoked with user query: How does the "Interleaving Layers" strategy in SWAA compare to the hierarchical organization of functional heads discussed in the CogVision paper?
2026-01-02 12:23:30,742 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:23:30,745 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:23:30,745 - query_agent - INFO -   Subquery 1: SWAA Interleaving Layers strategy
2026-01-02 12:23:30,745 - query_agent - INFO -   Subquery 2: CogVision hierarchical organization functional heads
2026-01-02 12:23:30,745 - query_agent - INFO -   Subquery 3: SWAA vs CogVision functional representation comparison
2026-01-02 12:23:30,746 - query_agent - INFO - RAG internal retrieval query: SWAA Interleaving Layers strategy
2026-01-02 12:23:30,840 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA Interleaving Layers strategy'
2026-01-02 12:23:30,840 - query_agent - INFO - RAG internal retrieval query: CogVision hierarchical organization functional heads
2026-01-02 12:23:30,918 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision hierarchical organization functional heads'
2026-01-02 12:23:30,918 - query_agent - INFO - RAG internal retrieval query: SWAA vs CogVision functional representation comparison
2026-01-02 12:23:31,005 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA vs CogVision functional representation comparison'
2026-01-02 12:23:31,005 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:23:31,005 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:23:31,005 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:23:31,006 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:23:31,006 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:23:31,006 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:23:31,006 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:23:31,007 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=42876
2026-01-02 12:23:31,007 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:23:31,007 - query_agent - INFO - Graph Tool invoked with user query: How does the "Interleaving Layers" strategy in SWAA compare to the hierarchical organization of functional heads discussed in the CogVision paper?
2026-01-02 12:23:31,008 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:23:32,915 - query_agent - INFO - Resolving entities from graph for query: How does the "Interleaving Layers" strategy in SWAA compare to the hierarchical organization of functional heads discussed in the CogVision paper?
2026-01-02 12:23:33,115 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- Interleaving Layers (Algorithm)
- Interleaving Layers (Concept)
- Cognitive organization of VLMs (Concept)
- CogVision (Dataset)
2026-01-02 12:23:33,291 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:23:55,146 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:23:55,147 - query_agent - INFO - MATCH (interleavingLayers:Concept {id: 'Interleaving Layers'})
MATCH (cognitiveOrg:Concept {id: 'Cognitive organization of VLMs'})
MATCH (cogVision:Dataset {id: 'CogVision'})
MATCH (d:Document)
WHERE (interleavingLayers)<-[:MENTIONS]-(d)
  AND (cognitiveOrg)<-[:MENTIONS]-(d)
  AND (cogVision)<-[:MENTIONS]-(d)
  AND d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:23:55,147 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:23:55,148 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:23:56,227 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain of Thought (CoT) prompting'}, 'MENTIONS', {'chunk_index': '2', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'aeb58d067782fbf07367eb644b06ca8b', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2'}, 'MENTIONS', {'id': 'Interleaving Layers'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: Yushi Bai, Shangqing Tu, Jiajie Zhang, Hao Peng, Xiaozhi Wang, Xin Lv, Shulin Cao, Jiazheng Xu, Lei
Hou, Yuxiao Dong, Jie Tang, and Juanzi Li. 2024b.
[Longbench v2: Towards deeper understanding and](https://arxiv.org/abs/2412.15204)
[reasoning on realistic long-context multitasks.](https://arxiv.org/abs/2412.15204)


Iz Beltagy, Matthew E. Peters, and Arman Cohan. 2020.

[Longformer: The long-document transformer.](https://arxiv.org/abs/2004.05150)


[Tri Dao. 2024. Flashattention-2: Faster attention with](https://openreview.net/forum?id=mZn2Xyh9Ec)
[better parallelism and work partitioning.](…
2026-01-02 12:23:56,487 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:24:13,000 - __main__ - INFO - Processing query: Discuss the differences in how "Attention Is All You Need" and "Neuronal Attention Circuit" handle positional information in sequence modeling.
2026-01-02 12:24:13,001 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:24:13,003 - query_agent - INFO - RAG Tool invoked with user query: Discuss the differences in how "Attention Is All You Need" and "Neuronal Attention Circuit" handle positional information in sequence modeling.
2026-01-02 12:24:13,290 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:24:13,291 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:24:13,291 - query_agent - INFO -   Subquery 1: "Attention Is All You Need" positional encoding
2026-01-02 12:24:13,291 - query_agent - INFO -   Subquery 2: "Neuronal Attention Circuit" position handling
2026-01-02 12:24:13,291 - query_agent - INFO -   Subquery 3: sequence modeling positional information
2026-01-02 12:24:13,292 - query_agent - INFO -   Subquery 4: transformer vs neuronal attention circuit position encoding
2026-01-02 12:24:13,292 - query_agent - INFO -   Subquery 5: attention mechanisms positional information handling
2026-01-02 12:24:13,292 - query_agent - INFO - RAG internal retrieval query: "Attention Is All You Need" positional encoding
2026-01-02 12:24:13,372 - query_agent - INFO - RAG retrieved 3 documents for subquery '"Attention Is All You Need" positional encoding'
2026-01-02 12:24:13,373 - query_agent - INFO - RAG internal retrieval query: "Neuronal Attention Circuit" position handling
2026-01-02 12:24:13,457 - query_agent - INFO - RAG retrieved 3 documents for subquery '"Neuronal Attention Circuit" position handling'
2026-01-02 12:24:13,457 - query_agent - INFO - RAG internal retrieval query: sequence modeling positional information
2026-01-02 12:24:13,539 - query_agent - INFO - RAG retrieved 3 documents for subquery 'sequence modeling positional information'
2026-01-02 12:24:13,539 - query_agent - INFO - RAG internal retrieval query: transformer vs neuronal attention circuit position encoding
2026-01-02 12:24:13,627 - query_agent - INFO - RAG retrieved 3 documents for subquery 'transformer vs neuronal attention circuit position encoding'
2026-01-02 12:24:13,627 - query_agent - INFO - RAG internal retrieval query: attention mechanisms positional information handling
2026-01-02 12:24:13,717 - query_agent - INFO - RAG retrieved 3 documents for subquery 'attention mechanisms positional information handling'
2026-01-02 12:24:13,717 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:24:13,718 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:24:13,718 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:24:13,718 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:24:13,718 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:24:13,719 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:24:13,719 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:24:13,719 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_13
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:24:13,719 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=50083
2026-01-02 12:24:13,719 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:24:13,720 - query_agent - INFO - Graph Tool invoked with user query: Discuss the differences in how "Attention Is All You Need" and "Neuronal Attention Circuit" handle positional information in sequence modeling.
2026-01-02 12:24:13,720 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:24:15,702 - query_agent - INFO - Resolving entities from graph for query: Discuss the differences in how "Attention Is All You Need" and "Neuronal Attention Circuit" handle positional information in sequence modeling.
2026-01-02 12:24:15,890 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- Sequence Modeling (Task)
- Neuronal Attention Circuit (NAC) (Model)
- Neuronal Attention Circuit (NAC) (Concept)
- Multi-Head Neuronal Attention Circuit (Concept)
2026-01-02 12:24:16,056 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:24:31,002 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:24:31,003 - query_agent - INFO - MATCH (pub:Publication {id: "Attention Is All You Need"})
MATCH (nac:Model {id: "Neuronal Attention Circuit (NAC)"})
MATCH (sm:Task {id: "Sequence Modeling"})
MATCH (d:Document)-[:MENTIONS]->(pub)
MATCH (d)-[:MENTIONS]->(nac)
MATCH (d)-[:MENTIONS]->(sm)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:24:31,003 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:24:31,003 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:24:31,986 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Query'}, 'DEPICTS', {'id': 'img_neuronal_attention_circuits_5_0', 'source_path': 'E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png'}, 'DEPICTS', {'id': 'Neuronal Attention Circuit (NAC)'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_index: 7
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 25



```json
"img_attention_functional_roles_25_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-25-0.png",
    "page": 25,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "semantic_role": "illustrates",
    "caption": "A grid of eight correlation matrices displays the relationships between four distinct models (Qwen2.5VL-7B, Qwen2.5VL-3B, Intern3VL-8B, Intern3VL-2B) ac…
2026-01-02 12:24:32,309 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:24:46,390 - __main__ - INFO - Processing query: Contrast the approach to long-context processing in "Sliding Window Attention Adaptation" with the "sparse Top-K pairwise concatenation" used in NAC.
2026-01-02 12:24:46,390 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:24:46,392 - query_agent - INFO - RAG Tool invoked with user query: Contrast the approach to long-context processing in "Sliding Window Attention Adaptation" with the "sparse Top-K pairwise concatenation" used in NAC.
2026-01-02 12:24:46,851 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:24:46,854 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:24:46,855 - query_agent - INFO -   Subquery 1: Sliding Window Attention Adaptation long-context processing
2026-01-02 12:24:46,855 - query_agent - INFO -   Subquery 2: NAC sparse Top-K pairwise concatenation
2026-01-02 12:24:46,856 - query_agent - INFO -   Subquery 3: long-context processing techniques comparison
2026-01-02 12:24:46,857 - query_agent - INFO -   Subquery 4: Sliding Window Attention vs sparse Top-K pairwise concatenation
2026-01-02 12:24:46,858 - query_agent - INFO - RAG internal retrieval query: Sliding Window Attention Adaptation long-context processing
2026-01-02 12:24:46,965 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Sliding Window Attention Adaptation long-context processing'
2026-01-02 12:24:46,966 - query_agent - INFO - RAG internal retrieval query: NAC sparse Top-K pairwise concatenation
2026-01-02 12:24:47,053 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC sparse Top-K pairwise concatenation'
2026-01-02 12:24:47,053 - query_agent - INFO - RAG internal retrieval query: long-context processing techniques comparison
2026-01-02 12:24:47,143 - query_agent - INFO - RAG retrieved 3 documents for subquery 'long-context processing techniques comparison'
2026-01-02 12:24:47,143 - query_agent - INFO - RAG internal retrieval query: Sliding Window Attention vs sparse Top-K pairwise concatenation
2026-01-02 12:24:47,222 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Sliding Window Attention vs sparse Top-K pairwise concatenation'
2026-01-02 12:24:47,223 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:24:47,223 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:24:47,223 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:24:47,223 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_7
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:24:47,223 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:24:47,224 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:24:47,224 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:24:47,224 - query_agent - INFO - RAG Unique Doc 7:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_5
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:24:47,224 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=45328
2026-01-02 12:24:47,224 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:24:47,225 - query_agent - INFO - Graph Tool invoked with user query: Contrast the approach to long-context processing in "Sliding Window Attention Adaptation" with the "sparse Top-K pairwise concatenation" used in NAC.
2026-01-02 12:24:47,225 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:24:49,387 - query_agent - INFO - Resolving entities from graph for query: Contrast the approach to long-context processing in "Sliding Window Attention Adaptation" with the "sparse Top-K pairwise concatenation" used in NAC.
2026-01-02 12:24:49,595 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Sparse Top-K Pairwise Concatenation (Concept)
- Sparse Top-K Pairwise Concatenation (Algorithm)
- sparse Top-K pairwise concatenation scheme (Algorithm)
- Sliding Window Attention Adaptation (Algorithm)
- long context processing (Task)
2026-01-02 12:24:49,595 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:25:03,111 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:25:03,112 - query_agent - INFO - MATCH (alg1:Algorithm {id: "Sliding Window Attention Adaptation"})
MATCH (alg2:Algorithm {id: "sparse Top-K pairwise concatenation scheme"})
MATCH (task:Task {id: "long context processing"})
OPTIONAL MATCH (alg1)-[r1_task]-(task)
OPTIONAL MATCH (alg2)-[r2_task]-(task)
OPTIONAL MATCH (alg1)-[r_compare]-(alg2)
RETURN alg1.id AS Algorithm1,
       type(r1_task) AS Algorithm1_to_Task_Relationship,
       task.id AS Task,
       alg2.id AS Algorithm2,
       type(r2_task) AS Algorithm2_to_Task_Relationship,
       type(r_compare) AS Algorithm1_to_Algorithm2_Relationship
2026-01-02 12:25:03,113 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'Algorithm1': 'Sliding Window Attention Adaptation', 'Algorithm1_to_Task_Relationship': None, 'Task': 'long context processing', 'Algorithm2': 'sparse Top-K pairwise concatenation scheme', 'Algorithm2_to_Task_Relationship': None, 'Algorithm1_to_Algorithm2_Relationship': None}]
2026-01-02 12:25:03,548 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'Algorithm1': 'Sliding Window Attention Adaptation', 'Algorithm1_to_Task_Relationship': None, 'Task': 'long context processing', 'Algorithm2': 'sparse Top-K pairwise concatenation scheme', 'Algorithm2_to_Task_Relationship': None, 'Algorithm1_to_Algorithm2_Relationship': None}
2026-01-02 12:25:03,804 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:25:17,189 - __main__ - INFO - Processing query: How do the findings regarding "sparse functional organization" in VLMs (CogVision paper) align with the sparsity principles used in the NAC architecture?
2026-01-02 12:25:17,190 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:25:17,192 - query_agent - INFO - RAG Tool invoked with user query: How do the findings regarding "sparse functional organization" in VLMs (CogVision paper) align with the sparsity principles used in the NAC architecture?
2026-01-02 12:25:17,436 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:25:17,438 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:25:17,439 - query_agent - INFO -   Subquery 1: sparse functional organization VLMs CogVision
2026-01-02 12:25:17,440 - query_agent - INFO -   Subquery 2: NAC architecture sparsity principles
2026-01-02 12:25:17,441 - query_agent - INFO -   Subquery 3: CogVision VLMs sparse organization
2026-01-02 12:25:17,441 - query_agent - INFO -   Subquery 4: sparsity principles NAC
2026-01-02 12:25:17,442 - query_agent - INFO - RAG internal retrieval query: sparse functional organization VLMs CogVision
2026-01-02 12:25:17,530 - query_agent - INFO - RAG retrieved 3 documents for subquery 'sparse functional organization VLMs CogVision'
2026-01-02 12:25:17,530 - query_agent - INFO - RAG internal retrieval query: NAC architecture sparsity principles
2026-01-02 12:25:17,621 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC architecture sparsity principles'
2026-01-02 12:25:17,621 - query_agent - INFO - RAG internal retrieval query: CogVision VLMs sparse organization
2026-01-02 12:25:17,700 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision VLMs sparse organization'
2026-01-02 12:25:17,700 - query_agent - INFO - RAG internal retrieval query: sparsity principles NAC
2026-01-02 12:25:17,777 - query_agent - INFO - RAG retrieved 3 documents for subquery 'sparsity principles NAC'
2026-01-02 12:25:17,777 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:25:17,777 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:25:17,777 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:25:17,778 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:25:17,778 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:25:17,778 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:25:17,778 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:25:17,778 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=38352
2026-01-02 12:25:17,778 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:25:17,779 - query_agent - INFO - Graph Tool invoked with user query: How do the findings regarding "sparse functional organization" in VLMs (CogVision paper) align with the sparsity principles used in the NAC architecture?
2026-01-02 12:25:17,779 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:25:19,922 - query_agent - INFO - Resolving entities from graph for query: How do the findings regarding "sparse functional organization" in VLMs (CogVision paper) align with the sparsity principles used in the NAC architecture?
2026-01-02 12:25:20,114 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- VLMs (Model)
- Sparsity (Concept)
- CogVision (Dataset)
- CogVision Dataset (Concept)
2026-01-02 12:25:20,321 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:25:35,388 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:25:35,389 - query_agent - INFO - MATCH (sparsity:Concept {id: 'Sparsity'})
MATCH (vlms:Model {id: 'VLMs'})
MATCH (cogvision_dataset:Concept {id: 'CogVision Dataset'})
MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(sparsity)
  AND (d)-[:MENTIONS]->(vlms)
  AND (d)-[:MENTIONS]->(cogvision_dataset)
  AND d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:25:35,390 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:25:35,391 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:25:36,489 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'TopK'}, 'MENTIONS', {'chunk_index': '5', 'chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '9b044b7451050bca38d39e5e1b14111e', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5', 'chunk_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5'}, 'MENTIONS', {'id': 'Sparsity'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_index: 5
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: _dadt_ _[≥]_ [0][. Thus trajectories cannot cross below] _[ m]_ [. Therefore,]

the interval [ _m, M_ ] is forward-invariant.


To see this explicitly under Euler discretization with step
size ∆ _t >_ 0,


_a_ ( _t_ + ∆ _t_ ) = _at_ + ∆ _t ·_ _[da]_ (36)

_dt_ _[.]_



At _a_ = _M_, _[da]_ _dt_ _[≤]_ [0 =] _[⇒]_ _[a]_ [(] _[t]_ [ + ∆] _[t]_ [)] _[ ≤]_ _[M]_ [. At] _[ a]_ [ =] _[ m]_ [,]

_dadt_ _[≥]_ [0 =] _[⇒]_ _[a]_ [(] _[t]_ [ + ∆] _[t]_ [)] _[ ≥]_ _[m]_ [. By induction over steps,]

_at ∈_ [ _m, M_ ] for all _t ∈_ [0 _, T_ ].



12


**Neuronal Attention Circuit (NAC) for Representation Le…
2026-01-02 12:25:36,834 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:25:47,676 - __main__ - INFO - Processing query: Compare the "Keep First k Tokens" method in SWAA with the "positional encoding" mechanism in the original Transformer paper in terms of preserving global context.
2026-01-02 12:25:47,677 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:25:47,679 - query_agent - INFO - RAG Tool invoked with user query: Compare the "Keep First k Tokens" method in SWAA with the "positional encoding" mechanism in the original Transformer paper in terms of preserving global context.
2026-01-02 12:25:47,937 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:25:47,939 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:25:47,939 - query_agent - INFO -   Subquery 1: SWAA Keep First k Tokens method
2026-01-02 12:25:47,939 - query_agent - INFO -   Subquery 2: Transformer original paper positional encoding
2026-01-02 12:25:47,939 - query_agent - INFO -   Subquery 3: preserving global context SWAA vs Transformer
2026-01-02 12:25:47,939 - query_agent - INFO -   Subquery 4: Keep First k Tokens global context
2026-01-02 12:25:47,940 - query_agent - INFO -   Subquery 5: positional encoding global context Transformer
2026-01-02 12:25:47,940 - query_agent - INFO - RAG internal retrieval query: SWAA Keep First k Tokens method
2026-01-02 12:25:48,017 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA Keep First k Tokens method'
2026-01-02 12:25:48,017 - query_agent - INFO - RAG internal retrieval query: Transformer original paper positional encoding
2026-01-02 12:25:48,109 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer original paper positional encoding'
2026-01-02 12:25:48,109 - query_agent - INFO - RAG internal retrieval query: preserving global context SWAA vs Transformer
2026-01-02 12:25:48,184 - query_agent - INFO - RAG retrieved 3 documents for subquery 'preserving global context SWAA vs Transformer'
2026-01-02 12:25:48,184 - query_agent - INFO - RAG internal retrieval query: Keep First k Tokens global context
2026-01-02 12:25:48,262 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Keep First k Tokens global context'
2026-01-02 12:25:48,262 - query_agent - INFO - RAG internal retrieval query: positional encoding global context Transformer
2026-01-02 12:25:48,345 - query_agent - INFO - RAG retrieved 3 documents for subquery 'positional encoding global context Transformer'
2026-01-02 12:25:48,345 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 9
2026-01-02 12:25:48,345 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:25:48,345 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:25:48,345 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:25:48,345 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:25:48,346 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:25:48,346 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:25:48,346 - query_agent - INFO - RAG Unique Doc 7:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:25:48,346 - query_agent - INFO - RAG Unique Doc 8:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_10
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:25:48,346 - query_agent - INFO - RAG Unique Doc 9:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_7
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:25:48,346 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=9, total_chars=63282
2026-01-02 12:25:48,347 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:25:48,347 - query_agent - INFO - Graph Tool invoked with user query: Compare the "Keep First k Tokens" method in SWAA with the "positional encoding" mechanism in the original Transformer paper in terms of preserving global context.
2026-01-02 12:25:48,347 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:25:50,229 - query_agent - INFO - Resolving entities from graph for query: Compare the "Keep First k Tokens" method in SWAA with the "positional encoding" mechanism in the original Transformer paper in terms of preserving global context.
2026-01-02 12:25:50,405 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- Keep First k Tokens (Algorithm)
- Positional Encoding (Concept)
- Transformer (Model)
- global attention (Concept)
2026-01-02 12:25:50,570 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:26:01,906 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:26:01,907 - query_agent - INFO - MATCH (a:Algorithm {id:'Keep First k Tokens'})
MATCH (b:Concept {id:'Positional Encoding'})
MATCH (d:Document)-[:MENTIONS]->(a)
MATCH (d)-[:MENTIONS]->(b)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:26:01,908 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'d.source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_index': '3', 'd.text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3'}]
2026-01-02 12:26:02,133 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'d.source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3', 'd.chunk_index': '3', 'd.text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_index: 3
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: 10


practice, however, many distributed LLM services
have to recompute the KV cache of the entire chat
history because storing and loading the KV cache
complicates engineering systems, making prefilling occurs more frequently than expected, thereby
amplifying the advantage of this method.
**Keep First** introduces very minor computational
overhead, but it complicates efficient KV cache
reuse. Due to positional encoding, a token’s KV
state depends on its position relative to the initial
_k_ tokens, hindering simple cache reuse across different requests. A position encoding separation or
offset…
2026-01-02 12:26:02,447 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:26:18,451 - __main__ - INFO - Processing query: How does the "Full Attention Decode" method in SWAA relate to the "decoder" structure described in "Attention Is All You Need"?
2026-01-02 12:26:18,451 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:26:18,453 - query_agent - INFO - RAG Tool invoked with user query: How does the "Full Attention Decode" method in SWAA relate to the "decoder" structure described in "Attention Is All You Need"?
2026-01-02 12:26:18,729 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:26:18,731 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:26:18,731 - query_agent - INFO -   Subquery 1: SWAA Full Attention Decode method
2026-01-02 12:26:18,731 - query_agent - INFO -   Subquery 2: Attention Is All You Need decoder structure
2026-01-02 12:26:18,731 - query_agent - INFO -   Subquery 3: SWAA vs Attention Is All You Need decoder
2026-01-02 12:26:18,732 - query_agent - INFO -   Subquery 4: "Full Attention Decode" SWAA
2026-01-02 12:26:18,732 - query_agent - INFO -   Subquery 5: "decoder" structure Attention Is All You Need
2026-01-02 12:26:18,732 - query_agent - INFO - RAG internal retrieval query: SWAA Full Attention Decode method
2026-01-02 12:26:18,813 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA Full Attention Decode method'
2026-01-02 12:26:18,813 - query_agent - INFO - RAG internal retrieval query: Attention Is All You Need decoder structure
2026-01-02 12:26:18,889 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Attention Is All You Need decoder structure'
2026-01-02 12:26:18,889 - query_agent - INFO - RAG internal retrieval query: SWAA vs Attention Is All You Need decoder
2026-01-02 12:26:18,972 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA vs Attention Is All You Need decoder'
2026-01-02 12:26:18,973 - query_agent - INFO - RAG internal retrieval query: "Full Attention Decode" SWAA
2026-01-02 12:26:19,054 - query_agent - INFO - RAG retrieved 3 documents for subquery '"Full Attention Decode" SWAA'
2026-01-02 12:26:19,054 - query_agent - INFO - RAG internal retrieval query: "decoder" structure Attention Is All You Need
2026-01-02 12:26:19,147 - query_agent - INFO - RAG retrieved 3 documents for subquery '"decoder" structure Attention Is All You Need'
2026-01-02 12:26:19,147 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:26:19,147 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:26:19,147 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:26:19,148 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:26:19,148 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:26:19,148 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:26:19,148 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:26:19,148 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=44145
2026-01-02 12:26:19,149 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:26:19,149 - query_agent - INFO - Graph Tool invoked with user query: How does the "Full Attention Decode" method in SWAA relate to the "decoder" structure described in "Attention Is All You Need"?
2026-01-02 12:26:19,149 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:26:21,307 - query_agent - INFO - Resolving entities from graph for query: How does the "Full Attention Decode" method in SWAA relate to the "decoder" structure described in "Attention Is All You Need"?
2026-01-02 12:26:21,487 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- Full Attention Decode (Algorithm)
- Decoder (Concept)
- Decoder (Model)
- Sentence structure (Concept)
2026-01-02 12:26:21,670 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:26:41,041 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:26:41,041 - query_agent - INFO - MATCH (fullAttentionDecode:Algorithm {id: "Full Attention Decode"})
MATCH (decoderConcept:Concept {id: "Decoder"})
MATCH (decoderModel:Model {id: "Decoder"})

OPTIONAL MATCH p_to_concept = shortestPath((fullAttentionDecode)-[*..4]-(decoderConcept))
OPTIONAL MATCH p_to_model = shortestPath((fullAttentionDecode)-[*..4]-(decoderModel))

RETURN
    CASE WHEN p_to_concept IS NOT NULL THEN p_to_concept ELSE NULL END AS path_to_decoder_concept,
    CASE WHEN p_to_model IS NOT NULL THEN p_to_model ELSE NULL END AS path_to_decoder_model
2026-01-02 12:26:41,042 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'path_to_decoder_concept': [{'id': 'Full Attention Decode'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Transformer'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '93ec065e0391e99e3dd12c28af8c5ff9', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'Decoder'}], 'path_to_decoder_model': [{'id': 'Full Attention Decode'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Transformer'}, 'BUILDS_ON', {'id': 'Decoder'}]}]
2026-01-02 12:26:41,269 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'path_to_decoder_concept': [{'id': 'Full Attention Decode'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Transformer'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '93ec065e0391e99e3dd12c28af8c5ff9', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'Decoder'}], 'path_to_decoder_model': [{'id': 'Full Attention Decode'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Transformer'}, 'BUILDS_ON', {'id': 'Decoder'}]}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: ## **Sliding Window Attention Adaptation**

Yijiong Yu [a], Jiale Liu [b], Qingyun Wu [b], Huazheng Wang [a], and Ji Pei [c]


aOregon State University, {yuyiji, huazheng.wang}@oregonstate.edu
bPenn State University, {jiale.liu, qingyun.wu}@psu.edu
cDeepSolution, research@deepsolution.chat



**Abstract**


The self-attention mechanism in Transformer
based Large Language Models (LLMs) scales
quadratically with input length, making longcontext inference expensive. Sliding window attention (SWA) reduces this cost to linear complexity, but naively enabling complete
SWA at inference-time for model…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: - The encoder contains self-attention layers. In a self-attention layer all of the keys, values
and queries come from the same place, in this case, the output of the previous layer in the
encoder. Each position in the encoder can attend to all positions in the previous layer of the
encoder.


    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to
all positions in the decoder up to and including that position. We need to prevent leftward
information flow in the decoder to preserve the auto-regressive property. We implement this
inside of scaled dot…
2026-01-02 12:26:41,486 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:26:52,392 - __main__ - INFO - Processing query: Evaluate the "Chain-of-Thought" (CoT) usage in SWAA against the CoT-based subquestion decomposition in the CogVision dataset.
2026-01-02 12:26:52,393 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:26:52,395 - query_agent - INFO - RAG Tool invoked with user query: Evaluate the "Chain-of-Thought" (CoT) usage in SWAA against the CoT-based subquestion decomposition in the CogVision dataset.
2026-01-02 12:26:52,674 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:26:52,675 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:26:52,676 - query_agent - INFO -   Subquery 1: Chain-of-Thought SWAA
2026-01-02 12:26:52,676 - query_agent - INFO -   Subquery 2: CogVision dataset subquestion decomposition
2026-01-02 12:26:52,676 - query_agent - INFO -   Subquery 3: CoT-based decomposition comparison
2026-01-02 12:26:52,676 - query_agent - INFO -   Subquery 4: SWAA vs CogVision CoT evaluation
2026-01-02 12:26:52,677 - query_agent - INFO -   Subquery 5: Chain-of-Thought usage in SWAA and CogVision
2026-01-02 12:26:52,677 - query_agent - INFO - RAG internal retrieval query: Chain-of-Thought SWAA
2026-01-02 12:26:52,752 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Chain-of-Thought SWAA'
2026-01-02 12:26:52,752 - query_agent - INFO - RAG internal retrieval query: CogVision dataset subquestion decomposition
2026-01-02 12:26:52,831 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset subquestion decomposition'
2026-01-02 12:26:52,831 - query_agent - INFO - RAG internal retrieval query: CoT-based decomposition comparison
2026-01-02 12:26:52,910 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CoT-based decomposition comparison'
2026-01-02 12:26:52,911 - query_agent - INFO - RAG internal retrieval query: SWAA vs CogVision CoT evaluation
2026-01-02 12:26:52,989 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA vs CogVision CoT evaluation'
2026-01-02 12:26:52,990 - query_agent - INFO - RAG internal retrieval query: Chain-of-Thought usage in SWAA and CogVision
2026-01-02 12:26:53,080 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Chain-of-Thought usage in SWAA and CogVision'
2026-01-02 12:26:53,080 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 10
2026-01-02 12:26:53,080 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:26:53,080 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:26:53,081 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:26:53,081 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:26:53,081 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_9
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:26:53,081 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_8
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:26:53,081 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:26:53,081 - query_agent - INFO - RAG Unique Doc 8:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_6
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:26:53,082 - query_agent - INFO - RAG Unique Doc 9:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_13
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:26:53,082 - query_agent - INFO - RAG Unique Doc 10:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:26:53,082 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=10, total_chars=64145
2026-01-02 12:26:53,082 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:26:53,083 - query_agent - INFO - Graph Tool invoked with user query: Evaluate the "Chain-of-Thought" (CoT) usage in SWAA against the CoT-based subquestion decomposition in the CogVision dataset.
2026-01-02 12:26:53,083 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:26:55,015 - query_agent - INFO - Resolving entities from graph for query: Evaluate the "Chain-of-Thought" (CoT) usage in SWAA against the CoT-based subquestion decomposition in the CogVision dataset.
2026-01-02 12:26:55,194 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Chain-of-thought (CoT) format (Concept)
- Chain of Thought (CoT) format (Concept)
- Chain of Thought (CoT) prompting (Concept)
- Chain-of-Thought (Concept)
- In-Domain Data (Concept)
2026-01-02 12:26:55,364 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:27:07,595 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:27:07,595 - query_agent - INFO - None
2026-01-02 12:27:07,595 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:27:07,595 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:27:08,696 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Chain-of-thought (CoT) format'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain of Thought (CoT) prompting'}, 'MENTIONS', {'chunk_index': '2', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'aeb58d067782fbf07367eb644b06ca8b', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2'}, 'MENTIONS', {'id': 'Chain of Thought (CoT) format'}]}

Neighborhood of Concept 'Chain-of-thought (CoT) format':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_21_0'}

Images (from graph):
- img_attention_functional_roles_21_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-21-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Chain-of-thought (CoT) format
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Chain-of-thought (CoT) format

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: Yushi Bai, Shangqing Tu, Jiajie Zhang, Hao Peng, Xiaozhi Wang, Xin Lv, Shulin Cao, Jiazheng Xu, Lei
Hou, Yuxiao Dong, Jie Tang, and Juanzi Li. 2024b.
[Longbench v2: Towards deeper understanding and](https://arxiv.org/abs/2412.15204)
[reasoning on realistic long-context multitasks.](https://arxiv.org/abs/2412.15204)


Iz Beltagy, Matthew E. Peters, and Arman Cohan. 2020.

[Longformer: The long-document transformer.](https://arxiv.org/abs/2004.05150)


[Tri Dao. 2024. Flashattention-2: Faster attention with](https://openreview.net/forum?id=mZn2Xyh9Ec)
[better parallelism and work partitioning.](…
2026-01-02 12:27:08,970 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:27:21,390 - __main__ - INFO - Processing query: Compare the "learning rate" schedules used for training the Transformer in "Attention Is All You Need" and the NAC models in their respective experiments.
2026-01-02 12:27:21,391 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:27:21,393 - query_agent - INFO - RAG Tool invoked with user query: Compare the "learning rate" schedules used for training the Transformer in "Attention Is All You Need" and the NAC models in their respective experiments.
2026-01-02 12:27:21,715 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:27:21,717 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:27:21,718 - query_agent - INFO -   Subquery 1: Transformer learning rate schedule Attention Is All You Need
2026-01-02 12:27:21,719 - query_agent - INFO -   Subquery 2: NAC models learning rate schedule
2026-01-02 12:27:21,720 - query_agent - INFO -   Subquery 3: "Attention Is All You Need" Transformer training hyperparameters
2026-01-02 12:27:21,721 - query_agent - INFO -   Subquery 4: NAC models training hyperparameters learning rate
2026-01-02 12:27:21,721 - query_agent - INFO - RAG internal retrieval query: Transformer learning rate schedule Attention Is All You Need
2026-01-02 12:27:21,833 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer learning rate schedule Attention Is All You Need'
2026-01-02 12:27:21,834 - query_agent - INFO - RAG internal retrieval query: NAC models learning rate schedule
2026-01-02 12:27:21,915 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC models learning rate schedule'
2026-01-02 12:27:21,915 - query_agent - INFO - RAG internal retrieval query: "Attention Is All You Need" Transformer training hyperparameters
2026-01-02 12:27:22,004 - query_agent - INFO - RAG retrieved 3 documents for subquery '"Attention Is All You Need" Transformer training hyperparameters'
2026-01-02 12:27:22,005 - query_agent - INFO - RAG internal retrieval query: NAC models training hyperparameters learning rate
2026-01-02 12:27:22,087 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC models training hyperparameters learning rate'
2026-01-02 12:27:22,087 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 8
2026-01-02 12:27:22,087 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:27:22,088 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:27:22,088 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_3
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:27:22,088 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_1
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:22,088 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:22,088 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_13
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:22,088 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:22,089 - query_agent - INFO - RAG Unique Doc 8:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:22,089 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=8, total_chars=49035
2026-01-02 12:27:22,089 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:27:22,090 - query_agent - INFO - Graph Tool invoked with user query: Compare the "learning rate" schedules used for training the Transformer in "Attention Is All You Need" and the NAC models in their respective experiments.
2026-01-02 12:27:22,090 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:27:24,198 - query_agent - INFO - Resolving entities from graph for query: Compare the "learning rate" schedules used for training the Transformer in "Attention Is All You Need" and the NAC models in their respective experiments.
2026-01-02 12:27:24,371 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- Transformer (Model)
- Transformer architecture (Concept)
- Self-training (Algorithm)
- Transformer architecture (Model)
2026-01-02 12:27:24,560 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:27:39,463 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Statement.SyntaxError} {message: All sub queries in an UNION must have the same return column names (line 12, column 1 (offset: 568))
"UNION ALL"
 ^}
neo4j.exceptions.GqlError: {gql_status: 42N39} {gql_status_description: error: syntax error or access rule violation - incompatible return column names. All UNION subqueries must have the same return column names. Use `AS` to ensure columns have the same name.} {message: 42N39: All UNION subqueries must have the same return column names. Use `AS` to ensure columns have the same name.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', '_position': {'offset': 568, 'column': 1, 'line': 12}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.CypherSyntaxError: {code: Neo.ClientError.Statement.SyntaxError} {message: All sub queries in an UNION must have the same return column names (line 12, column 1 (offset: 568))
"UNION ALL"
 ^}
2026-01-02 12:27:39,469 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:27:44,023 - __main__ - INFO - Processing query: How does the "Universal Approximation Theorem" proof for NAC compare to the theoretical justifications for self-attention provided in "Attention Is All You Need"?
2026-01-02 12:27:44,024 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:27:44,025 - query_agent - INFO - RAG Tool invoked with user query: How does the "Universal Approximation Theorem" proof for NAC compare to the theoretical justifications for self-attention provided in "Attention Is All You Need"?
2026-01-02 12:27:44,292 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:27:44,295 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:27:44,295 - query_agent - INFO -   Subquery 1: Universal Approximation Theorem NAC
2026-01-02 12:27:44,296 - query_agent - INFO -   Subquery 2: NAC Universal Approximation Theorem proof
2026-01-02 12:27:44,296 - query_agent - INFO -   Subquery 3: Attention Is All You Need self-attention theoretical justification
2026-01-02 12:27:44,297 - query_agent - INFO -   Subquery 4: self-attention mechanism theoretical foundations
2026-01-02 12:27:44,297 - query_agent - INFO -   Subquery 5: NAC vs self-attention theoretical comparisons
2026-01-02 12:27:44,298 - query_agent - INFO - RAG internal retrieval query: Universal Approximation Theorem NAC
2026-01-02 12:27:44,388 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Universal Approximation Theorem NAC'
2026-01-02 12:27:44,388 - query_agent - INFO - RAG internal retrieval query: NAC Universal Approximation Theorem proof
2026-01-02 12:27:44,480 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC Universal Approximation Theorem proof'
2026-01-02 12:27:44,480 - query_agent - INFO - RAG internal retrieval query: Attention Is All You Need self-attention theoretical justification
2026-01-02 12:27:44,557 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Attention Is All You Need self-attention theoretical justification'
2026-01-02 12:27:44,558 - query_agent - INFO - RAG internal retrieval query: self-attention mechanism theoretical foundations
2026-01-02 12:27:44,635 - query_agent - INFO - RAG retrieved 3 documents for subquery 'self-attention mechanism theoretical foundations'
2026-01-02 12:27:44,635 - query_agent - INFO - RAG internal retrieval query: NAC vs self-attention theoretical comparisons
2026-01-02 12:27:44,717 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC vs self-attention theoretical comparisons'
2026-01-02 12:27:44,717 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 9
2026-01-02 12:27:44,717 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:44,717 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_11
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:44,717 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_1
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:44,717 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_2
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:44,718 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:27:44,718 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:27:44,718 - query_agent - INFO - RAG Unique Doc 7:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:27:44,718 - query_agent - INFO - RAG Unique Doc 8:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:44,718 - query_agent - INFO - RAG Unique Doc 9:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:27:44,718 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=9, total_chars=56615
2026-01-02 12:27:44,719 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:27:44,719 - query_agent - INFO - Graph Tool invoked with user query: How does the "Universal Approximation Theorem" proof for NAC compare to the theoretical justifications for self-attention provided in "Attention Is All You Need"?
2026-01-02 12:27:44,719 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:27:46,640 - query_agent - INFO - Resolving entities from graph for query: How does the "Universal Approximation Theorem" proof for NAC compare to the theoretical justifications for self-attention provided in "Attention Is All You Need"?
2026-01-02 12:27:46,824 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Universal Approximation Theorem (UAT) (Concept)
- lane-keeping for autonomous vehicles (Task)
- self-attention mechanism (Concept)
- Self-attention mechanism (Concept)
- In-Domain Data (Concept)
2026-01-02 12:27:46,995 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:28:09,308 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:28:09,308 - query_agent - INFO - MATCH (uat:Concept {id: "Universal Approximation Theorem (UAT)"})
MATCH (sa:Concept {id: "self-attention mechanism"})
MATCH (pub:Publication {id: "Attention Is All You Need"})
MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(uat)
  AND (d)-[:MENTIONS]->(sa)
  AND (d)-[:MENTIONS]->(pub)
  AND d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:28:09,309 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:28:09,309 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:28:10,360 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Universal Approximation Theorem (UAT)'}, 'MENTIONS', {'chunk_index': '4', 'chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '4e87a758911b5ed6da32ce7e17b0bbf5', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4', 'chunk_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4'}, 'MENTIONS', {'id': 'Vaswani et al., 2017'}, 'INTRODUCED_BY', {'id': 'self-attention mechanism'}]}

Neighborhood of Concept 'Universal Approximation Theorem (UAT)':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'bda033365926e0bd06c92622aef961b6'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '9d2969dea07b7778f828d6fa2ed11f60'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '4e87a758911b5ed6da32ce7e17b0bbf5'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '9b044b7451050bca38d39e5e1b14111e'}
{'rel': 'APPLIED_TO', 'n_labels': ['Model'], 'n_id': 'Neuronal Attention Circuit (NAC)'}
{'rel': 'SUPPORTS', 'n_labels': ['Model'], 'n_id': 'NAC'}
{'rel': 'SUPPORTS', 'n_labels': ['Publication'], 'n_id': 'Stinchcomb, 1989'}

Chunks (resolved from Document.source_id):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_4
  chunk_index: 4
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: Rubanova, Y., Chen, R. T., and Duvenaud, D. K. Latent
ordinary differential equations for irregularly-sampled
time series. _Advances in neural information processing_
_systems_, 32, 2019.


Rumelhart, D. E., Hinton, G. E., and Williams, R. J. Learning internal representations by error propagation. Technical report, 1985.


Shibuya, N. Car behavioral cloning, 2017. URL
[https://github.com/naokishibuya/](https://github.com/naokishibuya/car-behavioral-cloning)
[car-behavioral-cloning.](https://github.com/naokishibuya/car-behavioral-cloning) Accessed: 202510-05.


Shukla, S. N. and Marlin, B. M. M…
2026-01-02 12:28:10,653 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:28:23,517 - __main__ - INFO - Processing query: If "Full Attention Decode" is applied to a "Qwen3-4B-Thinking" model, how does this specifically impact the "performance-efficiency trade-off" compared to naive SWA?
2026-01-02 12:28:23,518 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:28:23,519 - query_agent - INFO - RAG Tool invoked with user query: If "Full Attention Decode" is applied to a "Qwen3-4B-Thinking" model, how does this specifically impact the "performance-efficiency trade-off" compared to naive SWA?
2026-01-02 12:28:23,788 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:28:23,791 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:28:23,792 - query_agent - INFO -   Subquery 1: Full Attention Decode Qwen3-4B-Thinking performance-efficiency trade-off
2026-01-02 12:28:23,793 - query_agent - INFO -   Subquery 2: Qwen3-4B-Thinking Full Attention Decode vs naive SWA
2026-01-02 12:28:23,793 - query_agent - INFO -   Subquery 3: performance-efficiency trade-off Full Attention Decode vs SWA Qwen3-4B-Thinking
2026-01-02 12:28:23,794 - query_agent - INFO - RAG internal retrieval query: Full Attention Decode Qwen3-4B-Thinking performance-efficiency trade-off
2026-01-02 12:28:23,895 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Full Attention Decode Qwen3-4B-Thinking performance-efficiency trade-off'
2026-01-02 12:28:23,895 - query_agent - INFO - RAG internal retrieval query: Qwen3-4B-Thinking Full Attention Decode vs naive SWA
2026-01-02 12:28:23,993 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Qwen3-4B-Thinking Full Attention Decode vs naive SWA'
2026-01-02 12:28:23,994 - query_agent - INFO - RAG internal retrieval query: performance-efficiency trade-off Full Attention Decode vs SWA Qwen3-4B-Thinking
2026-01-02 12:28:24,088 - query_agent - INFO - RAG retrieved 3 documents for subquery 'performance-efficiency trade-off Full Attention Decode vs SWA Qwen3-4B-Thinking'
2026-01-02 12:28:24,088 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:28:24,088 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:28:24,089 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_9
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:28:24,089 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:28:24,089 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:28:24,089 - query_agent - INFO - RAG Unique Doc 5:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:28:24,089 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=33703
2026-01-02 12:28:24,090 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:28:24,090 - query_agent - INFO - Graph Tool invoked with user query: If "Full Attention Decode" is applied to a "Qwen3-4B-Thinking" model, how does this specifically impact the "performance-efficiency trade-off" compared to naive SWA?
2026-01-02 12:28:24,090 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:28:26,382 - query_agent - INFO - Resolving entities from graph for query: If "Full Attention Decode" is applied to a "Qwen3-4B-Thinking" model, how does this specifically impact the "performance-efficiency trade-off" compared to naive SWA?
2026-01-02 12:28:26,591 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- performance-efficiency trade-off (Concept)
- Qwen3-4B-Thinking (Model)
- Full Attention Decode (Algorithm)
- Sequence to sequence learning (Concept)
- Solution A (Concept)
2026-01-02 12:28:26,793 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:28:38,826 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:28:38,826 - query_agent - INFO - cypher
MATCH (algo:Algorithm {id: "Full Attention Decode"})
MATCH (model:Model {id: "Qwen3-4B-Thinking"})
MATCH (concept:Concept {id: "performance-efficiency trade-off"})
MATCH p = (algo)-[:APPLIED_TO]->(model)-[r:ADDRESSES|IMPROVES|MITIGATES]->(concept)
RETURN p

2026-01-02 12:28:38,827 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:28:38,828 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:28:39,984 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'performance-efficiency trade-off'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '96cbda833066473ad1bb09119ce583e3', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'Over-fitting'}, 'MENTIONS', {'chunk_index': '2', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '888d0bd62e26d30498c9f50b218a6001', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2'}, 'MENTIONS', {'id': 'Sequence to sequence learning'}]}

Neighborhood of Concept 'performance-efficiency trade-off':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '96cbda833066473ad1bb09119ce583e3'}

Chunks (resolved from Document.source_id):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: [37]. We used a vocabulary of 16K tokens for the WSJ only setting and a vocabulary of 32K tokens
for the semi-supervised setting.


We performed only a small number of experiments to select the dropout, both attention and residual
(section 5.4), learning rates and beam size on the Section 22 development set, all other parameters
remained unchanged from the English-to-German base translation model. During inference, we


9


Table 4: The Transformer generalizes well to English constituency parsing (Results are on Section 23
of WSJ)

|Parser|Training|WSJ23F1|
|---|---|---|
|Vinyals & Kaiser el a…

- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: 4


For additional validation of generalizability, as
shown in Appendix D, we also experiment on
LongBench-V2 (Bai et al., 2024b), a more modern and challenging benchmark that requires deep
reasoning across various real-world tasks.


**4.3** **Training Details**


For the fine-tuning dataset, we initially considered LongAlign (Bai et al., 2024a), a widely used
long-context fine-tuning dataset for adapt a regularlength model to long-context tasks. However, since

_∼_
its sample count ( 10,000) is insufficient, we incorporate an additional 6,000 samples from Fusangv1-long (Pan, 2024), a more co…
2026-01-02 12:28:40,241 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:28:53,307 - __main__ - INFO - Processing query: Trace the flow of information from "input embeddings" to "output probabilities" in the Transformer architecture, explicitly mentioning the role of "Add & Norm" layers.
2026-01-02 12:28:53,307 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:28:53,309 - query_agent - INFO - RAG Tool invoked with user query: Trace the flow of information from "input embeddings" to "output probabilities" in the Transformer architecture, explicitly mentioning the role of "Add & Norm" layers.
2026-01-02 12:28:53,556 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:28:53,558 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:28:53,559 - query_agent - INFO -   Subquery 1: Transformer architecture input embeddings to output probabilities
2026-01-02 12:28:53,560 - query_agent - INFO -   Subquery 2: Transformer encoder decoder Add & Norm layers
2026-01-02 12:28:53,561 - query_agent - INFO -   Subquery 3: Transformer information flow input embeddings output probabilities
2026-01-02 12:28:53,562 - query_agent - INFO - RAG internal retrieval query: Transformer architecture input embeddings to output probabilities
2026-01-02 12:28:53,654 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer architecture input embeddings to output probabilities'
2026-01-02 12:28:53,654 - query_agent - INFO - RAG internal retrieval query: Transformer encoder decoder Add & Norm layers
2026-01-02 12:28:53,747 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer encoder decoder Add & Norm layers'
2026-01-02 12:28:53,747 - query_agent - INFO - RAG internal retrieval query: Transformer information flow input embeddings output probabilities
2026-01-02 12:28:53,827 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer information flow input embeddings output probabilities'
2026-01-02 12:28:53,827 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:28:53,827 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:28:53,827 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:28:53,827 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:28:53,828 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:28:53,828 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=29095
2026-01-02 12:28:53,828 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:28:53,828 - query_agent - INFO - Graph Tool invoked with user query: Trace the flow of information from "input embeddings" to "output probabilities" in the Transformer architecture, explicitly mentioning the role of "Add & Norm" layers.
2026-01-02 12:28:53,829 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:28:55,658 - query_agent - INFO - Resolving entities from graph for query: Trace the flow of information from "input embeddings" to "output probabilities" in the Transformer architecture, explicitly mentioning the role of "Add & Norm" layers.
2026-01-02 12:28:55,832 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Output Probabilities (Concept)
- Add & Norm layer (Concept)
- Transformer architecture (Concept)
- Transformer architecture (Model)
- Neural Architecture of Language (Concept)
2026-01-02 12:28:55,996 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:29:24,734 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:29:24,734 - query_agent - INFO - MATCH (transformer:Model {id: 'Transformer architecture'})
MATCH (addNorm:Concept {id: 'Add & Norm layer'})
MATCH (outputProbs:Concept {id: 'Output Probabilities'})

// Trace the flow from the Transformer architecture to the Add & Norm layer,
// representing how the Add & Norm layer is a component or is used within the Transformer.
// (Note: "input embeddings" cannot be represented as a node in the graph based on the provided schema and known entities.
// The trace begins from the Transformer architecture itself, which processes such inputs.)
MATCH p1 = (transformer)-[r1:USES|BUILDS_ON|SUPPORTS|APPLIED_TO]->(addNorm)

// Trace the flow from the Add & Norm layer to the Output Probabilities.
// This path may be indirect, as there might be no direct edge between these two concepts.
// Relationships are filtered to represent a progression or contribution in the flow of information.
MATCH p2 = shortestPath((addNorm)-[r2*1..4]-(outputProbs))
WHERE ALL (rel IN relationships(p2) WHERE type(rel) IN [
    'APPLIED_TO', 'SUPPORTS', 'BUILDS_ON', 'EXTENDS', 'IMPROVES', 'IMPROVES_VIA', 'DEPICTS', 'OCCURS_IN', 'USES', 'ADDRESSES', 'PRODUCES'
])

// Return the two paths, which together illustrate the flow of information
// from the Transformer architecture, through the Add & Norm layer, to the Output Probabilities.
RETURN p1, p2
2026-01-02 12:29:24,736 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:29:24,737 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:29:25,736 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Output Probabilities'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Add & Norm layer'}]}

Neighborhood of Concept 'Output Probabilities':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '93ec065e0391e99e3dd12c28af8c5ff9'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_2_0'}

Images (from graph):
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Output Probabilities
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Output Probabilities
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Output Probabilities
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Output Probabilities
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Output Probabilities
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Output Probabilities
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Add & Norm layer
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Add & Norm layer
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Add & Norm layer
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Add & Norm layer
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Add & Norm layer
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Add & Norm layer

Chunks (inferred from derived_from_chunk_file):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.

## **Attention Is All You Need**



**Niki Parmar** _[∗]_
Google Research
```
nikip@google.com

```


**Ashish Vaswani** _[∗]_
Google Brain
```
avaswani@google.com

```

**Llion Jones** _[∗]_
Google Research
```
 llion@google.com

```


**Noam Shazeer** _[∗]_
Google Brain
```
noam@google.com

```


**Jakob Uszkoreit** _[∗]_
Google Research
```
usz@google.com

```


**Aidan N. Gomez** _[∗†]_
University of Toronto
```
aidan…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: - The encoder contains self-attention layers. In a self-attention layer all of the keys, values
and queries come from the same place, in this case, the output of the previous layer in the
encoder. Each position in the encoder can attend to all positions in the previous layer of the
encoder.


    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to
all positions in the decoder up to and including that position. We need to prevent leftward
information flow in the decoder to preserve the auto-regressive property. We implement this
inside of scaled dot…
2026-01-02 12:29:25,963 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:29:36,899 - __main__ - INFO - Processing query: Explain how "masking cognitive heads" in VLMs leads to performance degradation on "downstream tasks" like "OK-VQA".
2026-01-02 12:29:36,899 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:29:36,901 - query_agent - INFO - RAG Tool invoked with user query: Explain how "masking cognitive heads" in VLMs leads to performance degradation on "downstream tasks" like "OK-VQA".
2026-01-02 12:29:37,165 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:29:37,166 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:29:37,167 - query_agent - INFO -   Subquery 1: masking cognitive heads VLMs performance degradation downstream tasks
2026-01-02 12:29:37,167 - query_agent - INFO -   Subquery 2: OK-VQA task performance impact masking cognitive heads
2026-01-02 12:29:37,167 - query_agent - INFO -   Subquery 3: VLMs cognitive heads masking effect on OK-VQA
2026-01-02 12:29:37,168 - query_agent - INFO - RAG internal retrieval query: masking cognitive heads VLMs performance degradation downstream tasks
2026-01-02 12:29:37,255 - query_agent - INFO - RAG retrieved 3 documents for subquery 'masking cognitive heads VLMs performance degradation downstream tasks'
2026-01-02 12:29:37,255 - query_agent - INFO - RAG internal retrieval query: OK-VQA task performance impact masking cognitive heads
2026-01-02 12:29:37,342 - query_agent - INFO - RAG retrieved 3 documents for subquery 'OK-VQA task performance impact masking cognitive heads'
2026-01-02 12:29:37,342 - query_agent - INFO - RAG internal retrieval query: VLMs cognitive heads masking effect on OK-VQA
2026-01-02 12:29:37,427 - query_agent - INFO - RAG retrieved 3 documents for subquery 'VLMs cognitive heads masking effect on OK-VQA'
2026-01-02 12:29:37,427 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:29:37,427 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_4
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:29:37,427 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_3
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:29:37,428 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:29:37,428 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:29:37,428 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=25283
2026-01-02 12:29:37,428 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:29:37,429 - query_agent - INFO - Graph Tool invoked with user query: Explain how "masking cognitive heads" in VLMs leads to performance degradation on "downstream tasks" like "OK-VQA".
2026-01-02 12:29:37,429 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:29:39,854 - query_agent - INFO - Resolving entities from graph for query: Explain how "masking cognitive heads" in VLMs leads to performance degradation on "downstream tasks" like "OK-VQA".
2026-01-02 12:29:40,072 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Downstream tasks (Task)
- OK-VQA (Task)
- OK-VQA Dataset (Dataset)
- OK-VQA Dataset (Concept)
- long-context performance degradation (Concept)
2026-01-02 12:29:40,286 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:30:02,585 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'FOREACH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 10, column 1 (offset: 455))
"WHERE d.source_type = 'chunk'"
 ^}
neo4j.exceptions.GqlError: {gql_status: 42I06} {gql_status_description: error: syntax error or access rule violation - invalid input. Invalid input 'WHERE', expected: an expression, 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'FOREACH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF>.} {message: 42I06: Invalid input 'WHERE', expected: an expression, 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'FOREACH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF>.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', '_position': {'offset': 455, 'column': 1, 'line': 10}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.CypherSyntaxError: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'FOREACH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 10, column 1 (offset: 455))
"WHERE d.source_type = 'chunk'"
 ^}
2026-01-02 12:30:02,600 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:30:08,938 - __main__ - INFO - Processing query: How does the "explicit Euler solver" in NAC facilitate the "adaptive temporal dynamics" required for "irregular time-series classification"?
2026-01-02 12:30:08,939 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:30:08,941 - query_agent - INFO - RAG Tool invoked with user query: How does the "explicit Euler solver" in NAC facilitate the "adaptive temporal dynamics" required for "irregular time-series classification"?
2026-01-02 12:30:09,202 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:30:09,203 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:30:09,204 - query_agent - INFO -   Subquery 1: NAC explicit Euler solver adaptive temporal dynamics
2026-01-02 12:30:09,204 - query_agent - INFO -   Subquery 2: irregular time-series classification using NAC
2026-01-02 12:30:09,204 - query_agent - INFO -   Subquery 3: adaptive temporal dynamics in NAC for time-series classification
2026-01-02 12:30:09,204 - query_agent - INFO -   Subquery 4: NAC Euler solver for irregular time-series
2026-01-02 12:30:09,204 - query_agent - INFO -   Subquery 5: explicit Euler method in NAC for adaptive dynamics
2026-01-02 12:30:09,205 - query_agent - INFO - RAG internal retrieval query: NAC explicit Euler solver adaptive temporal dynamics
2026-01-02 12:30:09,284 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC explicit Euler solver adaptive temporal dynamics'
2026-01-02 12:30:09,284 - query_agent - INFO - RAG internal retrieval query: irregular time-series classification using NAC
2026-01-02 12:30:09,364 - query_agent - INFO - RAG retrieved 3 documents for subquery 'irregular time-series classification using NAC'
2026-01-02 12:30:09,365 - query_agent - INFO - RAG internal retrieval query: adaptive temporal dynamics in NAC for time-series classification
2026-01-02 12:30:09,450 - query_agent - INFO - RAG retrieved 3 documents for subquery 'adaptive temporal dynamics in NAC for time-series classification'
2026-01-02 12:30:09,450 - query_agent - INFO - RAG internal retrieval query: NAC Euler solver for irregular time-series
2026-01-02 12:30:09,525 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC Euler solver for irregular time-series'
2026-01-02 12:30:09,525 - query_agent - INFO - RAG internal retrieval query: explicit Euler method in NAC for adaptive dynamics
2026-01-02 12:30:09,612 - query_agent - INFO - RAG retrieved 3 documents for subquery 'explicit Euler method in NAC for adaptive dynamics'
2026-01-02 12:30:09,612 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:30:09,613 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_1
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:30:09,613 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_13
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:30:09,613 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_2
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:30:09,613 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:30:09,613 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_11
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:30:09,614 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=25844
2026-01-02 12:30:09,614 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:30:09,614 - query_agent - INFO - Graph Tool invoked with user query: How does the "explicit Euler solver" in NAC facilitate the "adaptive temporal dynamics" required for "irregular time-series classification"?
2026-01-02 12:30:09,614 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:30:11,472 - query_agent - INFO - Resolving entities from graph for query: How does the "explicit Euler solver" in NAC facilitate the "adaptive temporal dynamics" required for "irregular time-series classification"?
2026-01-02 12:30:11,643 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- irregular time-series classification (Task)
- explicit Euler solver (Concept)
- explicit Euler solver (Algorithm)
- In-Domain Data (Concept)
- NAC (Model)
2026-01-02 12:30:11,804 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:30:33,744 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: Concept OR solver)} {position: line: 3, column: 55, offset: 159} for query: "cypher\nMATCH (solver), (nac:Model {id: 'NAC'}), (task:Task {id: 'irregular time-series classification'})\nWHERE solver.id = 'explicit Euler solver' AND (solver:`Concept OR solver`:Algorithm)\nMATCH p = shortestPath((solver)-[*..4]-(task))\nWHERE nac IN nodes(p)\nRETURN p\n"
2026-01-02 12:30:33,744 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Statement.CartesianProduct} {category: PERFORMANCE} {title: This query builds a cartesian product between disconnected patterns.} {description: If a part of a query contains multiple disconnected patterns, this will build a cartesian product between all those parts. This may produce a large amount of data and slow down query processing. While occasionally intended, it may often be possible to reformulate the query that avoids the use of this cross product, perhaps by adding a relationship between the different parts or by using OPTIONAL MATCH (identifier is: (nac))} {position: line: 2, column: 1, offset: 7} for query: "cypher\nMATCH (solver), (nac:Model {id: 'NAC'}), (task:Task {id: 'irregular time-series classification'})\nWHERE solver.id = 'explicit Euler solver' AND (solver:`Concept OR solver`:Algorithm)\nMATCH p = shortestPath((solver)-[*..4]-(task))\nWHERE nac IN nodes(p)\nRETURN p\n"
2026-01-02 12:30:33,745 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Statement.CartesianProduct} {category: PERFORMANCE} {title: This query builds a cartesian product between disconnected patterns.} {description: If a part of a query contains multiple disconnected patterns, this will build a cartesian product between all those parts. This may produce a large amount of data and slow down query processing. While occasionally intended, it may often be possible to reformulate the query that avoids the use of this cross product, perhaps by adding a relationship between the different parts or by using OPTIONAL MATCH (identifier is: (task))} {position: line: 2, column: 1, offset: 7} for query: "cypher\nMATCH (solver), (nac:Model {id: 'NAC'}), (task:Task {id: 'irregular time-series classification'})\nWHERE solver.id = 'explicit Euler solver' AND (solver:`Concept OR solver`:Algorithm)\nMATCH p = shortestPath((solver)-[*..4]-(task))\nWHERE nac IN nodes(p)\nRETURN p\n"
2026-01-02 12:30:33,746 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Statement.ExhaustiveShortestPath} {category: PERFORMANCE} {title: Exhaustive shortest path has been planned for your query that means that shortest path graph algorithm might not be used to find the shortest path. Hence an exhaustive enumeration of all paths might be used in order to find the requested shortest path.} {description: Using shortest path with an exhaustive search fallback might cause query slow down since shortest path graph algorithms might not work for this use case. It is recommended to introduce a WITH to separate the MATCH containing the shortest path from the existential predicates on that path.} {position: line: 4, column: 11, offset: 200} for query: "cypher\nMATCH (solver), (nac:Model {id: 'NAC'}), (task:Task {id: 'irregular time-series classification'})\nWHERE solver.id = 'explicit Euler solver' AND (solver:`Concept OR solver`:Algorithm)\nMATCH p = shortestPath((solver)-[*..4]-(task))\nWHERE nac IN nodes(p)\nRETURN p\n"
2026-01-02 12:30:35,289 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:30:35,289 - query_agent - INFO - cypher
MATCH (solver), (nac:Model {id: 'NAC'}), (task:Task {id: 'irregular time-series classification'})
WHERE solver.id = 'explicit Euler solver' AND (solver:`Concept OR solver`:Algorithm)
MATCH p = shortestPath((solver)-[*..4]-(task))
WHERE nac IN nodes(p)
RETURN p

2026-01-02 12:30:35,290 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:30:35,291 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:30:36,258 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'explicit Euler solver'}, 'MENTIONS', {'chunk_index': '3', 'chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '9d2969dea07b7778f828d6fa2ed11f60', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3', 'chunk_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3'}, 'MENTIONS', {'id': 'Score'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'In-Domain Data'}]}

Neighborhood of Concept 'explicit Euler solver':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '9d2969dea07b7778f828d6fa2ed11f60'}
{'rel': 'BUILDS_ON', 'n_labels': ['Concept'], 'n_id': 'Euler mode'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (resolved from Document.source_id):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_index: 3
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: _Figure 3._ Degradation Estimation Results.


compact architecture suitable for resource-constrained devices, thereby supporting localized safety.
We utilized three benchmark datasets: (i) PRONOSTIA
(Nectoux et al., 2012), (ii) XJTU-SY (Wang et al., 2018),
and (iii) HUST (Thuan & Hong, 2023). Training is performed on PRONOSTIA, while XJTU-SY and HUST are

used to assess cross-validation. We used the Score met
ric (Nectoux et al., 2012) to assess the performance. We
evaluate generalization using _Bearing 1_ from the first operating condition of each dataset. Figure 3 visualizes the
expected deg…
2026-01-02 12:30:36,537 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:30:49,512 - __main__ - INFO - Processing query: Derive the connection between "sparse attention patterns" in SWAA and the "computational cost" reduction compared to "full-causal-attention" models.
2026-01-02 12:30:49,513 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:30:49,515 - query_agent - INFO - RAG Tool invoked with user query: Derive the connection between "sparse attention patterns" in SWAA and the "computational cost" reduction compared to "full-causal-attention" models.
2026-01-02 12:30:49,991 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:30:49,994 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:30:49,995 - query_agent - INFO -   Subquery 1: SWAA sparse attention patterns computational cost reduction
2026-01-02 12:30:49,995 - query_agent - INFO -   Subquery 2: sparse attention vs full-causal-attention computational complexity
2026-01-02 12:30:49,996 - query_agent - INFO -   Subquery 3: SWAA attention mechanism efficiency
2026-01-02 12:30:49,997 - query_agent - INFO - RAG internal retrieval query: SWAA sparse attention patterns computational cost reduction
2026-01-02 12:30:50,099 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA sparse attention patterns computational cost reduction'
2026-01-02 12:30:50,099 - query_agent - INFO - RAG internal retrieval query: sparse attention vs full-causal-attention computational complexity
2026-01-02 12:30:50,190 - query_agent - INFO - RAG retrieved 3 documents for subquery 'sparse attention vs full-causal-attention computational complexity'
2026-01-02 12:30:50,191 - query_agent - INFO - RAG internal retrieval query: SWAA attention mechanism efficiency
2026-01-02 12:30:50,267 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA attention mechanism efficiency'
2026-01-02 12:30:50,267 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:30:50,267 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:30:50,267 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:30:50,268 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:30:50,268 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:30:50,268 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:30:50,268 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:30:50,268 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=41509
2026-01-02 12:30:50,268 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:30:50,269 - query_agent - INFO - Graph Tool invoked with user query: Derive the connection between "sparse attention patterns" in SWAA and the "computational cost" reduction compared to "full-causal-attention" models.
2026-01-02 12:30:50,269 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:30:52,216 - query_agent - INFO - Resolving entities from graph for query: Derive the connection between "sparse attention patterns" in SWAA and the "computational cost" reduction compared to "full-causal-attention" models.
2026-01-02 12:30:52,387 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- RNN sequence-to-sequence models (Model)
- In-Domain Data (Concept)
- Language models (Model)
- modern models (Model)
- Multimodal Models (Model)
2026-01-02 12:30:52,388 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:31:10,965 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:31:10,966 - query_agent - INFO - None
2026-01-02 12:31:10,966 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:31:10,966 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:31:11,981 - query_agent - INFO - Graph context returned to LLM:
No graph connections found (even after fallbacks).

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data
2026-01-02 12:31:12,204 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:31:22,829 - __main__ - INFO - Processing query: Explain the reasoning chain that leads from "human brain anatomy" inspiration to the definition of "eight cognitive functions" in the CogVision framework.
2026-01-02 12:31:22,830 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:31:22,832 - query_agent - INFO - RAG Tool invoked with user query: Explain the reasoning chain that leads from "human brain anatomy" inspiration to the definition of "eight cognitive functions" in the CogVision framework.
2026-01-02 12:31:23,095 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:31:23,096 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:31:23,096 - query_agent - INFO -   Subquery 1: CogVision framework definition eight cognitive functions
2026-01-02 12:31:23,097 - query_agent - INFO -   Subquery 2: CogVision eight cognitive functions human brain anatomy
2026-01-02 12:31:23,097 - query_agent - INFO -   Subquery 3: CogVision framework cognitive functions inspired by brain anatomy
2026-01-02 12:31:23,097 - query_agent - INFO - RAG internal retrieval query: CogVision framework definition eight cognitive functions
2026-01-02 12:31:23,170 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision framework definition eight cognitive functions'
2026-01-02 12:31:23,170 - query_agent - INFO - RAG internal retrieval query: CogVision eight cognitive functions human brain anatomy
2026-01-02 12:31:23,244 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision eight cognitive functions human brain anatomy'
2026-01-02 12:31:23,244 - query_agent - INFO - RAG internal retrieval query: CogVision framework cognitive functions inspired by brain anatomy
2026-01-02 12:31:23,329 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision framework cognitive functions inspired by brain anatomy'
2026-01-02 12:31:23,329 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 3
2026-01-02 12:31:23,329 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:31:23,330 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_8
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:31:23,330 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:31:23,330 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=3, total_chars=21068
2026-01-02 12:31:23,330 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:31:23,331 - query_agent - INFO - Graph Tool invoked with user query: Explain the reasoning chain that leads from "human brain anatomy" inspiration to the definition of "eight cognitive functions" in the CogVision framework.
2026-01-02 12:31:23,331 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:31:25,503 - query_agent - INFO - Resolving entities from graph for query: Explain the reasoning chain that leads from "human brain anatomy" inspiration to the definition of "eight cognitive functions" in the CogVision framework.
2026-01-02 12:31:25,707 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Human brain anatomy (Concept)
- Chain-of-of-thought (Concept)
- Chain-of-Thought (Concept)
- CogVision (Dataset)
- Chain of Thought (CoT) prompting (Concept)
2026-01-02 12:31:25,960 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:31:45,743 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:31:45,744 - query_agent - INFO - MATCH (hba:Concept {id: 'Human brain anatomy'})
MATCH (cv:Dataset {id: 'CogVision'})
MATCH (hba)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(cv)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:31:45,745 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:31:45,745 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:31:46,852 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Human brain anatomy'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain-of-of-thought'}]}

Neighborhood of Concept 'Human brain anatomy':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_1_5'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_1_6'}

Images (from graph):
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Human brain anatomy
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Human brain anatomy
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Human brain anatomy
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Human brain anatomy
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Human brain anatomy
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Human brain anatomy
- img_attention_functional_roles_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-13-0.png | related_to=Human brain anatomy

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES

**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**

**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**

1The University of Melbourne 2The University of Sydney
_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au
_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au
tongliang.liu@sydney.edu.au


ABSTRACT


Despite excelling on multimodal benc…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: In addition to masking, we also conduct activation patching, where the activations of cognitive heads
associated with one function are replaced by those from another function using two strategies: ran

6




```json
"img_attention_functional_roles_5_1": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png",
    "page": 5,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "…
2026-01-02 12:31:47,181 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:31:58,827 - __main__ - INFO - Processing query: How does "repurposing C. elegans NCPs" lead to the specific "ODE-based" formulation of attention logits in NAC?
2026-01-02 12:31:58,828 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:31:58,830 - query_agent - INFO - RAG Tool invoked with user query: How does "repurposing C. elegans NCPs" lead to the specific "ODE-based" formulation of attention logits in NAC?
2026-01-02 12:31:59,105 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:31:59,106 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:31:59,106 - query_agent - INFO -   Subquery 1: NAC attention logits ODE-based formulation
2026-01-02 12:31:59,106 - query_agent - INFO -   Subquery 2: C. elegans NCPs repurposing
2026-01-02 12:31:59,107 - query_agent - INFO -   Subquery 3: Neural Arithmetic Circuits attention mechanism
2026-01-02 12:31:59,107 - query_agent - INFO -   Subquery 4: C. elegans NCPs ODE formulation
2026-01-02 12:31:59,107 - query_agent - INFO -   Subquery 5: NAC logits calculation
2026-01-02 12:31:59,107 - query_agent - INFO - RAG internal retrieval query: NAC attention logits ODE-based formulation
2026-01-02 12:31:59,177 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC attention logits ODE-based formulation'
2026-01-02 12:31:59,177 - query_agent - INFO - RAG internal retrieval query: C. elegans NCPs repurposing
2026-01-02 12:31:59,252 - query_agent - INFO - RAG retrieved 3 documents for subquery 'C. elegans NCPs repurposing'
2026-01-02 12:31:59,252 - query_agent - INFO - RAG internal retrieval query: Neural Arithmetic Circuits attention mechanism
2026-01-02 12:31:59,328 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neural Arithmetic Circuits attention mechanism'
2026-01-02 12:31:59,328 - query_agent - INFO - RAG internal retrieval query: C. elegans NCPs ODE formulation
2026-01-02 12:31:59,407 - query_agent - INFO - RAG retrieved 3 documents for subquery 'C. elegans NCPs ODE formulation'
2026-01-02 12:31:59,407 - query_agent - INFO - RAG internal retrieval query: NAC logits calculation
2026-01-02 12:31:59,487 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC logits calculation'
2026-01-02 12:31:59,488 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 10
2026-01-02 12:31:59,488 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,488 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_1
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,488 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_13
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,488 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_10
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,488 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,488 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,489 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_2
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,489 - query_agent - INFO - RAG Unique Doc 8:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_6
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,489 - query_agent - INFO - RAG Unique Doc 9:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,489 - query_agent - INFO - RAG Unique Doc 10:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:31:59,489 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=10, total_chars=59521
2026-01-02 12:31:59,489 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:31:59,490 - query_agent - INFO - Graph Tool invoked with user query: How does "repurposing C. elegans NCPs" lead to the specific "ODE-based" formulation of attention logits in NAC?
2026-01-02 12:31:59,490 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:32:01,518 - query_agent - INFO - Resolving entities from graph for query: How does "repurposing C. elegans NCPs" lead to the specific "ODE-based" formulation of attention logits in NAC?
2026-01-02 12:32:01,697 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- ODE-based models (Model)
- Compute logits (Concept)
- In-Domain Data (Concept)
- Chain-of-of-thought (Concept)
- model-specific layer selection strategies (Concept)
2026-01-02 12:32:01,886 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:32:08,632 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:32:08,632 - query_agent - INFO - None
2026-01-02 12:32:08,633 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:32:08,634 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:32:09,644 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Compute logits'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Line plot'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'In-Domain Data'}]}

Neighborhood of Concept 'Compute logits':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_neuronal_attention_circuits_5_0'}

Images (from graph):
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Compute logits
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Compute logits
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Compute logits
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Compute logits
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Compute logits
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Compute logits
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_index: 5
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: The statistics for the CogVision dataset is shown in Table 8


16


Table 8: Dataset Statistics


**Metric** **Training** **Testing**


Main Questions 1,124 285
Sub-questions 4,603 1,141


**Cognitive Skills Distribution**


High-Level Vision Reception 1,262 (27.42%) 336 (29.45%)
Math Reasoning 570 (12.38%) 125 (10.96%)
Semantic Understanding 545 (11.84%) 152 (13.32%)
Inference 544 (11.82%) 126 (11.04%)
Decision-Making 454 (9.86%) 111 (9.73%)
Language Knowledge Recall 424 (9.21%) 102 (8.94%)
Vision Knowledge Recall 403 (8.76%) 96 (8.41%)
Low-Level Vision Reception 401 (8.71%) 92 (8.06%)


A.4 …

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_index: 7
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 25



```json
"img_attention_functional_roles_25_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-25-0.png",
    "page": 25,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "semantic_role": "illustrates",
    "caption": "A grid of eight correlation matrices displays the relationships between four distinct models (Qwen2.5VL-7B, Qwen2.5VL-3B, Intern3VL-8B, Intern3VL-2B) ac…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _|at −_ _a_ _[∗]_ _| ≤_ _Me_ _[−][ω][τ][ t]_ _._ (10)


_Remark:_ This bound highlights that exponential convergence holds uniformly across all admissible initial
conditions, with the constant _M_ capturing the worst-case
deviation.


**Corollary 3** (Sample complexity to _δ_ -accuracy) **.** _A natural_
_operational question is the time required to achieve a target_
_tolerance δ >_ 0 _. Solving_


_|a_ 0 _−_ _a_ _[∗]_ _|e_ _[−][ω][τ][ t]_ _≤_ _δ,_ (11)


_We obtain the threshold_




[1] ln _[|][a]_ [0] _[ −]_ _[a][∗][|]_

_ωτ_ _δ_



_t ≥_ [1]



_._ (12)
_δ_



_Remark:_ The convergence rat…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ```json
"img_neuronal_attention_circuits_5_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png",
    "page": 5,
    "section": "Abstract",
    "image_relevance": "high",
    "image_type": "architecture",
    "semantic_role": "defines",
    "caption": "The image presents two architectural diagrams: a Neuronal Attention Circuit (NAC) and a Multi-Head Neuronal Attention Circuit. The single-head NAC processes time-series Query, Key, and Value inputs through Sparse Topk-Pairwise, a Backbone module, a logit computation…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_index: 5
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _dadt_ _[≥]_ [0][. Thus trajectories cannot cross below] _[ m]_ [. Therefore,]

the interval [ _m, M_ ] is forward-invariant.


To see this explicitly under Euler discretization with step
size ∆ _t >_ 0,


_a_ ( _t_ + ∆ _t_ ) = _at_ + ∆ _t ·_ _[da]_ (36)

_dt_ _[.]_



At _a_ = _M_, _[da]_ _dt_ _[≤]_ [0 =] _[⇒]_ _[a]_ [(] _[t]_ [ + ∆] _[t]_ [)] _[ ≤]_ _[M]_ [. At] _[ a]_ [ =] _[ m]_ [,]

_dadt_ _[≥]_ [0 =] _[⇒]_ _[a]_ [(] _[t]_ [ + ∆] _[t]_ [)] _[ ≥]_ _[m]_ [. By induction over steps,]

_at ∈_ [ _m, M_ ] for all _t ∈_ [0 _, T_ ].



12


**Neuronal Attention Circuit (NAC) for Representation Le…
2026-01-02 12:32:09,871 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:32:22,817 - __main__ - INFO - Processing query: Connect the "vanishing gradient problem" in "DT-RNNs" to the motivation for developing "Continuous-time RNNs" and subsequently "NAC".
2026-01-02 12:32:22,818 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:32:22,820 - query_agent - INFO - RAG Tool invoked with user query: Connect the "vanishing gradient problem" in "DT-RNNs" to the motivation for developing "Continuous-time RNNs" and subsequently "NAC".
2026-01-02 12:32:23,088 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:32:23,089 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:32:23,090 - query_agent - INFO -   Subquery 1: vanishing gradient problem DT-RNNs
2026-01-02 12:32:23,090 - query_agent - INFO -   Subquery 2: Continuous-time RNNs motivation
2026-01-02 12:32:23,090 - query_agent - INFO -   Subquery 3: NAC (Neural Arithmetic Logic Unit) development motivation
2026-01-02 12:32:23,090 - query_agent - INFO -   Subquery 4: DT-RNNs limitations
2026-01-02 12:32:23,091 - query_agent - INFO -   Subquery 5: RNNs Continuous-time models NAC relationship
2026-01-02 12:32:23,091 - query_agent - INFO - RAG internal retrieval query: vanishing gradient problem DT-RNNs
2026-01-02 12:32:23,164 - query_agent - INFO - RAG retrieved 3 documents for subquery 'vanishing gradient problem DT-RNNs'
2026-01-02 12:32:23,164 - query_agent - INFO - RAG internal retrieval query: Continuous-time RNNs motivation
2026-01-02 12:32:23,238 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Continuous-time RNNs motivation'
2026-01-02 12:32:23,238 - query_agent - INFO - RAG internal retrieval query: NAC (Neural Arithmetic Logic Unit) development motivation
2026-01-02 12:32:23,319 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC (Neural Arithmetic Logic Unit) development motivation'
2026-01-02 12:32:23,319 - query_agent - INFO - RAG internal retrieval query: DT-RNNs limitations
2026-01-02 12:32:23,398 - query_agent - INFO - RAG retrieved 3 documents for subquery 'DT-RNNs limitations'
2026-01-02 12:32:23,398 - query_agent - INFO - RAG internal retrieval query: RNNs Continuous-time models NAC relationship
2026-01-02 12:32:23,476 - query_agent - INFO - RAG retrieved 3 documents for subquery 'RNNs Continuous-time models NAC relationship'
2026-01-02 12:32:23,476 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:32:23,476 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_13
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:32:23,476 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_1
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:32:23,476 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:32:23,476 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:32:23,477 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:32:23,477 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:32:23,477 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:32:23,477 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=41716
2026-01-02 12:32:23,477 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:32:23,478 - query_agent - INFO - Graph Tool invoked with user query: Connect the "vanishing gradient problem" in "DT-RNNs" to the motivation for developing "Continuous-time RNNs" and subsequently "NAC".
2026-01-02 12:32:23,478 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:32:25,290 - query_agent - INFO - Resolving entities from graph for query: Connect the "vanishing gradient problem" in "DT-RNNs" to the motivation for developing "Continuous-time RNNs" and subsequently "NAC".
2026-01-02 12:32:25,459 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- NAC (Model)
- lane-keeping for autonomous vehicles (Task)
- NAC-Euler (Concept)
- NAC-02s (Model)
2026-01-02 12:32:25,673 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:32:50,645 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:32:50,645 - query_agent - INFO - MATCH (dt:Model {id: "DT-RNNs"})
MATCH (v:Concept {id: "vanishing gradient problem"})
MATCH (ct:Model {id: "Continuous-time RNNs"})
MATCH (nac:Model {id: "NAC"})
MATCH p = (dt)<-[:APPLIED_TO]-(v)-[:ADDRESSES]->(ct)-[:BUILDS_ON|EXTENDS]->(nac)
RETURN p
2026-01-02 12:32:50,645 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:32:50,646 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:32:51,660 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Line plot'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'NAC-Euler'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (inferred from derived_from_chunk_file):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## **Neuronal Attention Circuit (NAC) for Representation Learning**

**Waleed Razzaq** [1] **Izis Kankaraway** [1] **Yun-Bo Zhao** [1 2]



**Abstract**

Attention improves representation learning over
RNNs, but its discrete nature limits continuoustime (CT) modeling. We introduce Neuronal Attention Circuit (NAC), a novel, biologically plausible CT-Attention mechanism that reformulates

attention logits computation as the solution to a
linear first-order ODE with nonlinear interlinked
gates derived from repurposing _C. elegans_ Neuronal Circuit Policies (NCPs) wiring mechanism.
NAC replaces de…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _|at −_ _a_ _[∗]_ _| ≤_ _Me_ _[−][ω][τ][ t]_ _._ (10)


_Remark:_ This bound highlights that exponential convergence holds uniformly across all admissible initial
conditions, with the constant _M_ capturing the worst-case
deviation.


**Corollary 3** (Sample complexity to _δ_ -accuracy) **.** _A natural_
_operational question is the time required to achieve a target_
_tolerance δ >_ 0 _. Solving_


_|a_ 0 _−_ _a_ _[∗]_ _|e_ _[−][ω][τ][ t]_ _≤_ _δ,_ (11)


_We obtain the threshold_




[1] ln _[|][a]_ [0] _[ −]_ _[a][∗][|]_

_ωτ_ _δ_



_t ≥_ [1]



_._ (12)
_δ_



_Remark:_ The convergence rat…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ```json
"img_neuronal_attention_circuits_5_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png",
    "page": 5,
    "section": "Abstract",
    "image_relevance": "high",
    "image_type": "architecture",
    "semantic_role": "defines",
    "caption": "The image presents two architectural diagrams: a Neuronal Attention Circuit (NAC) and a Multi-Head Neuronal Attention Circuit. The single-head NAC processes time-series Query, Key, and Value inputs through Sparse Topk-Pairwise, a Backbone module, a logit computation…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_index: 7
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 25



```json
"img_attention_functional_roles_25_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-25-0.png",
    "page": 25,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "semantic_role": "illustrates",
    "caption": "A grid of eight correlation matrices displays the relationships between four distinct models (Qwen2.5VL-7B, Qwen2.5VL-3B, Intern3VL-8B, Intern3VL-2B) ac…
2026-01-02 12:32:51,895 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:33:06,027 - __main__ - INFO - Processing query: How does the "training-inference mismatch" in SWA necessitate the specific combination of "fine-tuning" and "Interleaving Layers" in SWAA?
2026-01-02 12:33:06,028 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:33:06,030 - query_agent - INFO - RAG Tool invoked with user query: How does the "training-inference mismatch" in SWA necessitate the specific combination of "fine-tuning" and "Interleaving Layers" in SWAA?
2026-01-02 12:33:06,283 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:33:06,284 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:33:06,285 - query_agent - INFO -   Subquery 1: SWA training-inference mismatch
2026-01-02 12:33:06,285 - query_agent - INFO -   Subquery 2: SWAA fine-tuning method
2026-01-02 12:33:06,285 - query_agent - INFO -   Subquery 3: Interleaving Layers SWAA
2026-01-02 12:33:06,285 - query_agent - INFO -   Subquery 4: SWA vs SWAA training methods
2026-01-02 12:33:06,285 - query_agent - INFO -   Subquery 5: impact of training-inference mismatch on SWAA
2026-01-02 12:33:06,286 - query_agent - INFO - RAG internal retrieval query: SWA training-inference mismatch
2026-01-02 12:33:06,355 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWA training-inference mismatch'
2026-01-02 12:33:06,355 - query_agent - INFO - RAG internal retrieval query: SWAA fine-tuning method
2026-01-02 12:33:06,430 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA fine-tuning method'
2026-01-02 12:33:06,430 - query_agent - INFO - RAG internal retrieval query: Interleaving Layers SWAA
2026-01-02 12:33:06,507 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Interleaving Layers SWAA'
2026-01-02 12:33:06,507 - query_agent - INFO - RAG internal retrieval query: SWA vs SWAA training methods
2026-01-02 12:33:06,582 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWA vs SWAA training methods'
2026-01-02 12:33:06,582 - query_agent - INFO - RAG internal retrieval query: impact of training-inference mismatch on SWAA
2026-01-02 12:33:06,667 - query_agent - INFO - RAG retrieved 3 documents for subquery 'impact of training-inference mismatch on SWAA'
2026-01-02 12:33:06,668 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:33:06,668 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:33:06,668 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:33:06,668 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:33:06,669 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:33:06,669 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=28890
2026-01-02 12:33:06,669 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:33:06,670 - query_agent - INFO - Graph Tool invoked with user query: How does the "training-inference mismatch" in SWA necessitate the specific combination of "fine-tuning" and "Interleaving Layers" in SWAA?
2026-01-02 12:33:06,670 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:33:09,084 - query_agent - INFO - Resolving entities from graph for query: How does the "training-inference mismatch" in SWA necessitate the specific combination of "fine-tuning" and "Interleaving Layers" in SWAA?
2026-01-02 12:33:09,288 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- training–inference mismatch (Concept)
- SWA-aware fine-tuning (Algorithm)
- Fine-tuning with SWA (Algorithm)
- In-Domain Data (Concept)
- Interleaving Layers (Concept)
2026-01-02 12:33:09,500 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:33:35,543 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:33:35,544 - query_agent - INFO - cypher
MATCH (mismatch:Concept {id: 'training–inference mismatch'})
MATCH (swa_ft:Algorithm {id: 'SWA-aware fine-tuning'})
MATCH (interleaving:Concept {id: 'Interleaving Layers'})
MATCH (ft_swa:Algorithm {id: 'Fine-tuning with SWA'})
MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(mismatch)
  AND ((d)-[:MENTIONS]->(swa_ft) OR (d)-[:MENTIONS]->(ft_swa))
  AND (d)-[:MENTIONS]->(interleaving)
  AND d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10

2026-01-02 12:33:35,545 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:33:35,546 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:33:36,620 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Neighborhood of Concept 'training–inference mismatch':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd'}
{'rel': 'MITIGATES', 'n_labels': ['Algorithm'], 'n_id': 'Sliding Window Attention Adaptation'}
{'rel': 'MITIGATES', 'n_labels': ['Algorithm'], 'n_id': 'Fine-tuning with SWA'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data
2026-01-02 12:33:36,859 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:33:53,925 - __main__ - INFO - Processing query: Trace the impact of "positive intervention" on "functional heads" to the resulting improvement in "visual reasoning tasks" accuracy.
2026-01-02 12:33:53,926 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:33:53,927 - query_agent - INFO - RAG Tool invoked with user query: Trace the impact of "positive intervention" on "functional heads" to the resulting improvement in "visual reasoning tasks" accuracy.
2026-01-02 12:33:54,260 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:33:54,261 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:33:54,262 - query_agent - INFO -   Subquery 1: positive intervention impact on functional heads visual reasoning
2026-01-02 12:33:54,262 - query_agent - INFO -   Subquery 2: functional heads role in visual reasoning tasks
2026-01-02 12:33:54,262 - query_agent - INFO -   Subquery 3: effect of positive intervention on visual reasoning accuracy
2026-01-02 12:33:54,262 - query_agent - INFO -   Subquery 4: visual reasoning tasks improvement with positive intervention
2026-01-02 12:33:54,263 - query_agent - INFO -   Subquery 5: relation between functional heads and visual reasoning accuracy
2026-01-02 12:33:54,263 - query_agent - INFO - RAG internal retrieval query: positive intervention impact on functional heads visual reasoning
2026-01-02 12:33:54,356 - query_agent - INFO - RAG retrieved 3 documents for subquery 'positive intervention impact on functional heads visual reasoning'
2026-01-02 12:33:54,356 - query_agent - INFO - RAG internal retrieval query: functional heads role in visual reasoning tasks
2026-01-02 12:33:54,434 - query_agent - INFO - RAG retrieved 3 documents for subquery 'functional heads role in visual reasoning tasks'
2026-01-02 12:33:54,434 - query_agent - INFO - RAG internal retrieval query: effect of positive intervention on visual reasoning accuracy
2026-01-02 12:33:54,510 - query_agent - INFO - RAG retrieved 3 documents for subquery 'effect of positive intervention on visual reasoning accuracy'
2026-01-02 12:33:54,511 - query_agent - INFO - RAG internal retrieval query: visual reasoning tasks improvement with positive intervention
2026-01-02 12:33:54,590 - query_agent - INFO - RAG retrieved 3 documents for subquery 'visual reasoning tasks improvement with positive intervention'
2026-01-02 12:33:54,590 - query_agent - INFO - RAG internal retrieval query: relation between functional heads and visual reasoning accuracy
2026-01-02 12:33:54,665 - query_agent - INFO - RAG retrieved 3 documents for subquery 'relation between functional heads and visual reasoning accuracy'
2026-01-02 12:33:54,666 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:33:54,666 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:33:54,666 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:33:54,666 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_4
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:33:54,667 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:33:54,667 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:33:54,667 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=35876
2026-01-02 12:33:54,667 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:33:54,668 - query_agent - INFO - Graph Tool invoked with user query: Trace the impact of "positive intervention" on "functional heads" to the resulting improvement in "visual reasoning tasks" accuracy.
2026-01-02 12:33:54,668 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:33:56,803 - query_agent - INFO - Resolving entities from graph for query: Trace the impact of "positive intervention" on "functional heads" to the resulting improvement in "visual reasoning tasks" accuracy.
2026-01-02 12:33:57,014 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Positive Intervention (Concept)
- Positive Intervention Case (Concept)
- Positive Intervention Output (Concept)
- Accuracy (Concept)
- model accuracy (Concept)
2026-01-02 12:33:57,214 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:34:26,545 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:34:26,546 - query_agent - INFO - cypher
MATCH (pi:Concept {id: 'Positive Intervention'})
MATCH (fh:Concept {id: 'functional heads'})
MATCH (vrt:Task {id: 'visual reasoning tasks'})
MATCH (acc:Concept {id: 'Accuracy'})
MATCH path = (pi)-[*1..2]->(fh)-[*1..2]->(m:Model|Algorithm)-[:IMPROVES]->(acc)
WHERE (m)-[:APPLIED_TO]->(vrt)
RETURN path, vrt

2026-01-02 12:34:26,547 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:34:26,548 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:34:27,511 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Positive Intervention'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Positive Intervention Case'}]}

Neighborhood of Concept 'Positive Intervention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'd11ea42ea84f64f79324d9d9907a5e64'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '090e6ada644008ce80b83c8ee0406515'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Visual Question Answering (VQA)'}
{'rel': 'APPLIED_TO', 'n_labels': ['Dataset'], 'n_id': 'MathVista Dataset'}
{'rel': 'APPLIED_TO', 'n_labels': ['Dataset'], 'n_id': 'OK-VQA Dataset'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Cognitive heads'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'CogVision Dataset'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Downstream tasks'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'cognitive heads'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Model Output'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_27_3'}
{'rel': 'BUILDS_ON', 'n_labels': ['Publication'], 'n_id': 'Li et al., 2023a'}
{'rel': 'ADDRESSES', 'n_labels': ['Task'], 'n_id': 'Visual Reasoning'}

Images (from graph):
- img_attention_functional_roles_27_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-27-3.png | related_to=Positive Intervention
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Positive Intervention
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Positive Intervention
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Positive Intervention
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Positive Intervention
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Positive Intervention
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Positive Intervention
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Positive Intervention
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Positive Intervention
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Positive Intervention
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Positive Intervention
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Positive Intervention
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Positive Intervention
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Positive Intervention
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Positive Intervention

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES

**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**

**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**

1The University of Melbourne 2The University of Sydney
_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au
_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au
tongliang.liu@sydney.edu.au


ABSTRACT


Despite excelling on multimodal benc…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: In addition to masking, we also conduct activation patching, where the activations of cognitive heads
associated with one function are replaced by those from another function using two strategies: ran

6




```json
"img_attention_functional_roles_5_1": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png",
    "page": 5,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "…
2026-01-02 12:34:27,749 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:34:38,287 - __main__ - INFO - Processing query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:34:38,288 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:34:38,288 - query_agent - INFO - RAG Tool invoked with user query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:34:39,905 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:34:39,906 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:34:39,906 - query_agent - INFO -   Subquery 1: Neuronal Attention Circuit (NAC) attention logit computation modes
2026-01-02 12:34:39,906 - query_agent - INFO -   Subquery 2: NAC supported attention logit modes
2026-01-02 12:34:39,906 - query_agent - INFO -   Subquery 3: attention logit computation in Neuronal Attention Circuit
2026-01-02 12:34:39,906 - query_agent - INFO - RAG internal retrieval query: Neuronal Attention Circuit (NAC) attention logit computation modes
2026-01-02 12:34:40,099 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Attention Circuit (NAC) attention logit computation modes'
2026-01-02 12:34:40,101 - query_agent - INFO - RAG internal retrieval query: NAC supported attention logit modes
2026-01-02 12:34:40,216 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC supported attention logit modes'
2026-01-02 12:34:40,216 - query_agent - INFO - RAG internal retrieval query: attention logit computation in Neuronal Attention Circuit
2026-01-02 12:34:40,289 - query_agent - INFO - RAG retrieved 3 documents for subquery 'attention logit computation in Neuronal Attention Circuit'
2026-01-02 12:34:40,290 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:34:40,290 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:34:40,290 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:34:40,290 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:34:40,290 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:34:40,290 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:34:40,290 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:34:40,291 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=39665
2026-01-02 12:34:40,291 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:34:40,291 - query_agent - INFO - Graph Tool invoked with user query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:34:40,291 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:34:42,523 - query_agent - INFO - Resolving entities from graph for query: What are the three attention logit computation modes supported by the Neuronal Attention Circuit (NAC)?
2026-01-02 12:34:42,732 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Neuronal Attention Circuit (NAC) (Concept)
- Neuronal Attention Circuit (NAC) (Model)
- Multi-Head Neuronal Attention Circuit (Concept)
- Neuronal circuit (Concept)
- Neuronal Circuit Policies (NCPs) (Concept)
2026-01-02 12:34:42,933 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:35:06,546 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: Concept OR nac)} {position: line: 2, column: 60, offset: 71} for query: "MATCH (nac)\nWHERE nac.id = 'Neuronal Attention Circuit (NAC)' AND (nac:`Concept OR nac`:Model)\nMATCH (nac)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(mode:Concept)\nWHERE d.source_type = 'chunk'\nRETURN DISTINCT mode.id\nLIMIT 3"
2026-01-02 12:35:07,824 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:35:07,824 - query_agent - INFO - MATCH (nac)
WHERE nac.id = 'Neuronal Attention Circuit (NAC)' AND (nac:`Concept OR nac`:Model)
MATCH (nac)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(mode:Concept)
WHERE d.source_type = 'chunk'
RETURN DISTINCT mode.id
LIMIT 3
2026-01-02 12:35:07,824 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:35:07,825 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:35:08,925 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Neuronal Attention Circuit (NAC)'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Multi-Head Neuronal Attention Circuit'}]}

Neighborhood of Concept 'Neuronal Attention Circuit (NAC)':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_neuronal_attention_circuits_5_0'}

Images (from graph):
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Multi-Head Neuronal Attention Circuit
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Multi-Head Neuronal Attention Circuit

Chunks (inferred from derived_from_chunk_file):
- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## **Neuronal Attention Circuit (NAC) for Representation Learning**

**Waleed Razzaq** [1] **Izis Kankaraway** [1] **Yun-Bo Zhao** [1 2]



**Abstract**

Attention improves representation learning over
RNNs, but its discrete nature limits continuoustime (CT) modeling. We introduce Neuronal Attention Circuit (NAC), a novel, biologically plausible CT-Attention mechanism that reformulates

attention logits computation as the solution to a
linear first-order ODE with nonlinear interlinked
gates derived from repurposing _C. elegans_ Neuronal Circuit Policies (NCPs) wiring mechanism.
NAC replaces de…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: _|at −_ _a_ _[∗]_ _| ≤_ _Me_ _[−][ω][τ][ t]_ _._ (10)


_Remark:_ This bound highlights that exponential convergence holds uniformly across all admissible initial
conditions, with the constant _M_ capturing the worst-case
deviation.


**Corollary 3** (Sample complexity to _δ_ -accuracy) **.** _A natural_
_operational question is the time required to achieve a target_
_tolerance δ >_ 0 _. Solving_


_|a_ 0 _−_ _a_ _[∗]_ _|e_ _[−][ω][τ][ t]_ _≤_ _δ,_ (11)


_We obtain the threshold_




[1] ln _[|][a]_ [0] _[ −]_ _[a][∗][|]_

_ωτ_ _δ_



_t ≥_ [1]



_._ (12)
_δ_



_Remark:_ The convergence rat…

- neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl::neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ```json
"img_neuronal_attention_circuits_5_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png",
    "page": 5,
    "section": "Abstract",
    "image_relevance": "high",
    "image_type": "architecture",
    "semantic_role": "defines",
    "caption": "The image presents two architectural diagrams: a Neuronal Attention Circuit (NAC) and a Multi-Head Neuronal Attention Circuit. The single-head NAC processes time-series Query, Key, and Value inputs through Sparse Topk-Pairwise, a Backbone module, a logit computation…
2026-01-02 12:35:09,260 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:35:14,517 - __main__ - INFO - Processing query: What is the specific BLEU score achieved by the Transformer model on the WMT 2014 English-to-German translation task?
2026-01-02 12:35:14,517 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:35:14,518 - query_agent - INFO - RAG Tool invoked with user query: What is the specific BLEU score achieved by the Transformer model on the WMT 2014 English-to-German translation task?
2026-01-02 12:35:17,593 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:35:17,596 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:35:17,597 - query_agent - INFO -   Subquery 1: Transformer model BLEU score WMT 2014 English-to-German
2026-01-02 12:35:17,597 - query_agent - INFO -   Subquery 2: Transformer BLEU WMT14 En-De translation task
2026-01-02 12:35:17,598 - query_agent - INFO -   Subquery 3: WMT 2014 English-to-German Transformer model score
2026-01-02 12:35:17,599 - query_agent - INFO - RAG internal retrieval query: Transformer model BLEU score WMT 2014 English-to-German
2026-01-02 12:35:17,709 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer model BLEU score WMT 2014 English-to-German'
2026-01-02 12:35:17,710 - query_agent - INFO - RAG internal retrieval query: Transformer BLEU WMT14 En-De translation task
2026-01-02 12:35:17,791 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer BLEU WMT14 En-De translation task'
2026-01-02 12:35:17,791 - query_agent - INFO - RAG internal retrieval query: WMT 2014 English-to-German Transformer model score
2026-01-02 12:35:17,875 - query_agent - INFO - RAG retrieved 3 documents for subquery 'WMT 2014 English-to-German Transformer model score'
2026-01-02 12:35:17,875 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 3
2026-01-02 12:35:17,875 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_4
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:35:17,875 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_3
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:35:17,876 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:35:17,876 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=3, total_chars=20228
2026-01-02 12:35:17,876 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:35:17,876 - query_agent - INFO - Graph Tool invoked with user query: What is the specific BLEU score achieved by the Transformer model on the WMT 2014 English-to-German translation task?
2026-01-02 12:35:17,877 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:35:19,772 - query_agent - INFO - Resolving entities from graph for query: What is the specific BLEU score achieved by the Transformer model on the WMT 2014 English-to-German translation task?
2026-01-02 12:35:19,956 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- WMT 2014 English-to-German translation task (Task)
- WMT 2014 English-to-French translation task (Task)
- BLEU score (Concept)
- Translation tasks (Task)
- Transformer (Model)
2026-01-02 12:35:19,957 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:35:24,330 - query_agent - ERROR - Error in Graph retrieval: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'transformer': expected '(' (line 4, column 35 (offset: 195))
"MATCH (doc:Document)-[:MENTIONS]->transformer"
                                   ^}
neo4j.exceptions.GqlError: {gql_status: 42I06} {gql_status_description: error: syntax error or access rule violation - invalid input. Invalid input 'transformer', expected: '('.} {message: 42I06: Invalid input 'transformer', expected: '('.} {diagnostic_record: {'_classification': 'CLIENT_ERROR', '_position': {'offset': 195, 'column': 35, 'line': 4}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}} {raw_classification: CLIENT_ERROR}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\agents\6-query_agent.py", line 611, in graph_retrieval_tool
    result = chain.invoke(
        {
    ...<5 lines>...
        }
    )
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_classic\chains\base.py", line 167, in invoke
    self._call(inputs, run_manager=run_manager)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\chains\graph_qa\cypher.py", line 356, in _call
    context = self.graph.query(generated_cypher)[: self.top_k]
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\langchain_neo4j\graphs\neo4j_graph.py", line 230, in query
    data, _, _ = self._driver.execute_query(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        Query(text=query, timeout=self.timeout),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        database_=self._database,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
        parameters_=params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 978, in execute_query
    return session._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        access_mode,
        ^^^^^^^^^^^^
    ...<3 lines>...
        {},
        ^^^
    )
    ^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\session.py", line 588, in _run_transaction
    result = transaction_function(tx, *args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_work\query.py", line 144, in wrapped
    return f(*args, **kwargs)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\driver.py", line 1314, in _work
    res = tx.run(query, parameters)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\transaction.py", line 206, in run
    result._tx_ready_run(query, parameters)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 177, in _tx_ready_run
    self._run(query, parameters, None, None, None, None, None, None)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 236, in _run
    self._attach()
    ~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\work\result.py", line 430, in _attach
    self._connection.fetch_message()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 193, in inner
    func(*args, **kwargs)
    ~~~~^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt.py", line 863, in fetch_message
    res = self._process_message(tag, fields)
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Python Stuff\MAS-for-multimodal-knowledge-graph\.venv\Lib\site-packages\neo4j\_sync\io\_common.py", line 263, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.CypherSyntaxError: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'transformer': expected '(' (line 4, column 35 (offset: 195))
"MATCH (doc:Document)-[:MENTIONS]->transformer"
                                   ^}
2026-01-02 12:35:24,346 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:35:27,564 - __main__ - INFO - Processing query: How does the "Full Attention Decode" method in Sliding Window Attention Adaptation (SWAA) differ from standard SWA during the prefilling stage?
2026-01-02 12:35:27,565 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:35:27,567 - query_agent - INFO - RAG Tool invoked with user query: How does the "Full Attention Decode" method in Sliding Window Attention Adaptation (SWAA) differ from standard SWA during the prefilling stage?
2026-01-02 12:35:32,351 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:35:32,352 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:35:32,353 - query_agent - INFO -   Subquery 1: Sliding Window Attention Adaptation Full Attention Decode
2026-01-02 12:35:32,353 - query_agent - INFO -   Subquery 2: SWAA vs standard SWA prefilling stage
2026-01-02 12:35:32,353 - query_agent - INFO -   Subquery 3: Full Attention Decode method SWAA
2026-01-02 12:35:32,354 - query_agent - INFO -   Subquery 4: SWA prefilling stage comparison with SWAA
2026-01-02 12:35:32,354 - query_agent - INFO - RAG internal retrieval query: Sliding Window Attention Adaptation Full Attention Decode
2026-01-02 12:35:32,435 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Sliding Window Attention Adaptation Full Attention Decode'
2026-01-02 12:35:32,436 - query_agent - INFO - RAG internal retrieval query: SWAA vs standard SWA prefilling stage
2026-01-02 12:35:32,517 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA vs standard SWA prefilling stage'
2026-01-02 12:35:32,518 - query_agent - INFO - RAG internal retrieval query: Full Attention Decode method SWAA
2026-01-02 12:35:32,594 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Full Attention Decode method SWAA'
2026-01-02 12:35:32,594 - query_agent - INFO - RAG internal retrieval query: SWA prefilling stage comparison with SWAA
2026-01-02 12:35:32,674 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWA prefilling stage comparison with SWAA'
2026-01-02 12:35:32,674 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:35:32,674 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:35:32,674 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:35:32,674 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:35:32,675 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:35:32,675 - query_agent - INFO - RAG Unique Doc 5:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:35:32,675 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=36766
2026-01-02 12:35:32,675 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:35:32,676 - query_agent - INFO - Graph Tool invoked with user query: How does the "Full Attention Decode" method in Sliding Window Attention Adaptation (SWAA) differ from standard SWA during the prefilling stage?
2026-01-02 12:35:32,676 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:35:34,525 - query_agent - INFO - Resolving entities from graph for query: How does the "Full Attention Decode" method in Sliding Window Attention Adaptation (SWAA) differ from standard SWA during the prefilling stage?
2026-01-02 12:35:34,690 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Sliding Window Attention Adaptation (Algorithm)
- Full Attention Decode (Algorithm)
- Sliding Window Attention (Model)
- Sliding Window Attention (Concept)
- SWA adaptation (Algorithm)
2026-01-02 12:35:34,690 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:35:54,675 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:35:54,676 - query_agent - INFO - MATCH (fad:Algorithm {id: "Full Attention Decode"})-[r:COMPARED_WITH]-(swa:Model {id: "Sliding Window Attention"})
RETURN fad.id AS FullAttentionDecode, type(r) AS Relationship, swa.id AS StandardSWA
2026-01-02 12:35:54,677 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:35:54,678 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:35:55,587 - query_agent - INFO - Graph context returned to LLM:
No graph connections found (even after fallbacks).
2026-01-02 12:35:55,810 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:36:01,598 - __main__ - INFO - Processing query: What are the eight cognitive functions defined in the CogVision dataset for classifying attention heads?
2026-01-02 12:36:01,598 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:36:01,599 - query_agent - INFO - RAG Tool invoked with user query: What are the eight cognitive functions defined in the CogVision dataset for classifying attention heads?
2026-01-02 12:36:03,407 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:36:03,408 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:36:03,408 - query_agent - INFO -   Subquery 1: CogVision dataset cognitive functions for attention head classification
2026-01-02 12:36:03,409 - query_agent - INFO -   Subquery 2: CogVision dataset attention head classification cognitive functions
2026-01-02 12:36:03,409 - query_agent - INFO -   Subquery 3: CogVision cognitive functions definition
2026-01-02 12:36:03,409 - query_agent - INFO - RAG internal retrieval query: CogVision dataset cognitive functions for attention head classification
2026-01-02 12:36:03,499 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset cognitive functions for attention head classification'
2026-01-02 12:36:03,499 - query_agent - INFO - RAG internal retrieval query: CogVision dataset attention head classification cognitive functions
2026-01-02 12:36:03,575 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset attention head classification cognitive functions'
2026-01-02 12:36:03,575 - query_agent - INFO - RAG internal retrieval query: CogVision cognitive functions definition
2026-01-02 12:36:03,656 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision cognitive functions definition'
2026-01-02 12:36:03,656 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:36:03,656 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:36:03,656 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:36:03,657 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_8
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:36:03,657 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:36:03,657 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=27943
2026-01-02 12:36:03,657 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:36:03,658 - query_agent - INFO - Graph Tool invoked with user query: What are the eight cognitive functions defined in the CogVision dataset for classifying attention heads?
2026-01-02 12:36:03,658 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:36:05,779 - query_agent - INFO - Resolving entities from graph for query: What are the eight cognitive functions defined in the CogVision dataset for classifying attention heads?
2026-01-02 12:36:05,990 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Cognitive functions (Concept)
- CogVision Dataset (Concept)
- CogVision Dataset (Dataset)
- CogVision (Dataset)
- In-Domain Data (Concept)
2026-01-02 12:36:06,258 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:36:31,859 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:36:31,860 - query_agent - INFO - MATCH (cf_general:Concept {id: 'Cognitive functions'})
MATCH (cvd_entity)
WHERE cvd_entity.id IN ['CogVision Dataset', 'CogVision']
MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(cf_general) AND (d)-[:MENTIONS]->(cvd_entity)
MATCH (d)-[:MENTIONS]->(specific_cf:Concept)
WHERE specific_cf.id <> cf_general.id AND specific_cf.id <> cvd_entity.id
RETURN DISTINCT specific_cf.id
2026-01-02 12:36:31,860 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'specific_cf.id': 'Attention mechanism'}, {'specific_cf.id': 'Neural networks'}, {'specific_cf.id': 'Accuracy'}, {'specific_cf.id': 'Interpretability framework'}, {'specific_cf.id': 'Human reasoning'}, {'specific_cf.id': 'Chain of Thought (CoT) prompting'}, {'specific_cf.id': 'Cognitive organization of VLMs'}, {'specific_cf.id': 'Human-aligned perceptual and reasoning abilities'}, {'specific_cf.id': 'Human brain'}, {'specific_cf.id': 'Occipital lobe'}]
2026-01-02 12:36:32,076 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'specific_cf.id': 'Attention mechanism'}
{'specific_cf.id': 'Neural networks'}
{'specific_cf.id': 'Accuracy'}
{'specific_cf.id': 'Interpretability framework'}
{'specific_cf.id': 'Human reasoning'}
{'specific_cf.id': 'Chain of Thought (CoT) prompting'}
{'specific_cf.id': 'Cognitive organization of VLMs'}
{'specific_cf.id': 'Human-aligned perceptual and reasoning abilities'}
{'specific_cf.id': 'Human brain'}
{'specific_cf.id': 'Occipital lobe'}

Images (from graph):
- img_attention_functional_roles_25_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-25-1.png | related_to=Cognitive functions
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Cognitive functions
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Cognitive functions
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Cognitive functions
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Cognitive functions
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Cognitive functions
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Cognitive functions
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Cognitive functions
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Cognitive functions
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Cognitive functions
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Cognitive functions
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Cognitive functions
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Cognitive functions
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Cognitive functions
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Cognitive functions
2026-01-02 12:36:32,441 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:40:47,558 - __main__ - INFO - Processing query: What is the computational complexity of a self-attention layer compared to a recurrent layer as described in "Attention Is All You Need"?
2026-01-02 12:40:47,558 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:40:47,560 - query_agent - INFO - RAG Tool invoked with user query: What is the computational complexity of a self-attention layer compared to a recurrent layer as described in "Attention Is All You Need"?
2026-01-02 12:40:47,905 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:40:47,906 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:40:47,907 - query_agent - INFO -   Subquery 1: self-attention layer computational complexity 'Attention Is All You Need'
2026-01-02 12:40:47,907 - query_agent - INFO -   Subquery 2: recurrent layer computational complexity 'Attention Is All You Need'
2026-01-02 12:40:47,907 - query_agent - INFO -   Subquery 3: self-attention vs recurrent layer complexity analysis
2026-01-02 12:40:47,907 - query_agent - INFO - RAG internal retrieval query: self-attention layer computational complexity 'Attention Is All You Need'
2026-01-02 12:40:47,993 - query_agent - INFO - RAG retrieved 3 documents for subquery 'self-attention layer computational complexity 'Attention Is All You Need''
2026-01-02 12:40:47,993 - query_agent - INFO - RAG internal retrieval query: recurrent layer computational complexity 'Attention Is All You Need'
2026-01-02 12:40:48,080 - query_agent - INFO - RAG retrieved 3 documents for subquery 'recurrent layer computational complexity 'Attention Is All You Need''
2026-01-02 12:40:48,080 - query_agent - INFO - RAG internal retrieval query: self-attention vs recurrent layer complexity analysis
2026-01-02 12:40:48,161 - query_agent - INFO - RAG retrieved 3 documents for subquery 'self-attention vs recurrent layer complexity analysis'
2026-01-02 12:40:48,161 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:40:48,162 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:40:48,162 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:40:48,162 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:40:48,162 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:40:48,162 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:40:48,163 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=36348
2026-01-02 12:40:48,163 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:40:48,164 - query_agent - INFO - Graph Tool invoked with user query: What is the computational complexity of a self-attention layer compared to a recurrent layer as described in "Attention Is All You Need"?
2026-01-02 12:40:48,164 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:40:50,274 - query_agent - INFO - Resolving entities from graph for query: What is the computational complexity of a self-attention layer compared to a recurrent layer as described in "Attention Is All You Need"?
2026-01-02 12:40:50,450 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Solution A (Concept)
- computational complexity (Concept)
- Computational complexity (Concept)
- Layer number (Concept)
- Layer Number (Concept)
2026-01-02 12:40:50,635 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:41:06,353 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:41:06,354 - query_agent - INFO - MATCH (complexity:Concept {id: 'computational complexity'})
MATCH (publication:Publication {id: 'Attention Is All You Need'})
MATCH (complexity)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(publication)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:41:06,354 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:41:06,355 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:41:07,349 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Solution A'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Long-range dependencies'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '93ec065e0391e99e3dd12c28af8c5ff9', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'computational complexity'}]}

Neighborhood of Concept 'Solution A':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_1_0'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_1_5'}

Images (from graph):
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Solution A
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Solution A
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Solution A
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Solution A
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Solution A
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Solution A
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Solution A
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Solution A
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Solution A
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Solution A
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Solution A
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Solution A
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Solution A
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Solution A
- img_attention_functional_roles_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-13-0.png | related_to=Solution A

Chunks (resolved from Document.source_id):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: - The encoder contains self-attention layers. In a self-attention layer all of the keys, values
and queries come from the same place, in this case, the output of the previous layer in the
encoder. Each position in the encoder can attend to all positions in the previous layer of the
encoder.


    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to
all positions in the decoder up to and including that position. We need to prevent leftward
information flow in the decoder to preserve the auto-regressive property. We implement this
inside of scaled dot…
2026-01-02 12:41:07,596 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:41:15,506 - __main__ - INFO - Processing query: Which specific biological organism's nervous system inspired the wiring mechanism of the Neuronal Attention Circuit?
2026-01-02 12:41:15,507 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:41:15,508 - query_agent - INFO - RAG Tool invoked with user query: Which specific biological organism's nervous system inspired the wiring mechanism of the Neuronal Attention Circuit?
2026-01-02 12:41:15,768 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:41:15,769 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:41:15,769 - query_agent - INFO -   Subquery 1: Neuronal Attention Circuit biological inspiration
2026-01-02 12:41:15,769 - query_agent - INFO -   Subquery 2: Nervous system inspiration Neuronal Attention Circuit
2026-01-02 12:41:15,769 - query_agent - INFO -   Subquery 3: biological organism Neuronal Attention Circuit wiring mechanism
2026-01-02 12:41:15,770 - query_agent - INFO - RAG internal retrieval query: Neuronal Attention Circuit biological inspiration
2026-01-02 12:41:15,845 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Attention Circuit biological inspiration'
2026-01-02 12:41:15,845 - query_agent - INFO - RAG internal retrieval query: Nervous system inspiration Neuronal Attention Circuit
2026-01-02 12:41:15,917 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Nervous system inspiration Neuronal Attention Circuit'
2026-01-02 12:41:15,918 - query_agent - INFO - RAG internal retrieval query: biological organism Neuronal Attention Circuit wiring mechanism
2026-01-02 12:41:15,999 - query_agent - INFO - RAG retrieved 3 documents for subquery 'biological organism Neuronal Attention Circuit wiring mechanism'
2026-01-02 12:41:15,999 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:41:15,999 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:41:15,999 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_10
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:41:16,000 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:41:16,000 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:41:16,000 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=26811
2026-01-02 12:41:16,000 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:41:16,001 - query_agent - INFO - Graph Tool invoked with user query: Which specific biological organism's nervous system inspired the wiring mechanism of the Neuronal Attention Circuit?
2026-01-02 12:41:16,001 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:41:18,007 - query_agent - INFO - Resolving entities from graph for query: Which specific biological organism's nervous system inspired the wiring mechanism of the Neuronal Attention Circuit?
2026-01-02 12:41:18,191 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Attention mechanism (Model)
- Attention mechanism (Concept)
- Self-attention mechanism (Concept)
- self-attention mechanism (Concept)
- Neuronal Attention Circuit (NAC) (Model)
2026-01-02 12:41:18,379 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:41:26,030 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:41:26,031 - query_agent - INFO - MATCH (nac:Model {id: 'Neuronal Attention Circuit (NAC)'})-[:INSPIRED_BY]->(organismConcept:Concept)
RETURN organismConcept.id
2026-01-02 12:41:26,032 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'organismConcept.id': 'Neuronal Circuit Policies (NCPs)'}]
2026-01-02 12:41:26,225 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'organismConcept.id': 'Neuronal Circuit Policies (NCPs)'}

Images (from graph):
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Attention mechanism
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Attention mechanism
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Attention mechanism
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Attention mechanism
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Attention mechanism
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Attention mechanism
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Attention mechanism
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Attention mechanism
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Self-attention mechanism
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Self-attention mechanism
2026-01-02 12:41:26,556 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:41:33,010 - __main__ - INFO - Processing query: What is the "attention sink" phenomenon described in the context of the "Keep First k Tokens" method?
2026-01-02 12:41:33,010 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:41:33,013 - query_agent - INFO - RAG Tool invoked with user query: What is the "attention sink" phenomenon described in the context of the "Keep First k Tokens" method?
2026-01-02 12:41:33,242 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:41:33,245 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:41:33,245 - query_agent - INFO -   Subquery 1: "attention sink" "Keep First k Tokens"
2026-01-02 12:41:33,246 - query_agent - INFO -   Subquery 2: "Keep First k Tokens" method attention mechanism
2026-01-02 12:41:33,247 - query_agent - INFO -   Subquery 3: "attention sink" phenomenon explanation
2026-01-02 12:41:33,248 - query_agent - INFO - RAG internal retrieval query: "attention sink" "Keep First k Tokens"
2026-01-02 12:41:33,340 - query_agent - INFO - RAG retrieved 3 documents for subquery '"attention sink" "Keep First k Tokens"'
2026-01-02 12:41:33,340 - query_agent - INFO - RAG internal retrieval query: "Keep First k Tokens" method attention mechanism
2026-01-02 12:41:33,419 - query_agent - INFO - RAG retrieved 3 documents for subquery '"Keep First k Tokens" method attention mechanism'
2026-01-02 12:41:33,419 - query_agent - INFO - RAG internal retrieval query: "attention sink" phenomenon explanation
2026-01-02 12:41:33,509 - query_agent - INFO - RAG retrieved 3 documents for subquery '"attention sink" phenomenon explanation'
2026-01-02 12:41:33,509 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:41:33,510 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:41:33,510 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:41:33,510 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_10
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:41:33,510 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:41:33,510 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:41:33,511 - query_agent - INFO - RAG Unique Doc 6:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:41:33,511 - query_agent - INFO - RAG Unique Doc 7:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:41:33,511 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=50138
2026-01-02 12:41:33,511 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:41:33,512 - query_agent - INFO - Graph Tool invoked with user query: What is the "attention sink" phenomenon described in the context of the "Keep First k Tokens" method?
2026-01-02 12:41:33,512 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:41:35,659 - query_agent - INFO - Resolving entities from graph for query: What is the "attention sink" phenomenon described in the context of the "Keep First k Tokens" method?
2026-01-02 12:41:35,863 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Keep First k Tokens (Algorithm)
- In-Domain Data (Concept)
- Chain-of-of-thought (Concept)
- Context Understanding (Concept)
- Chain-of-Thought (Concept)
2026-01-02 12:41:36,079 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:41:42,968 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:41:42,969 - query_agent - INFO - MATCH (a:Algorithm {id: "Keep First k Tokens"})
MATCH (d:Document)-[:MENTIONS]->(a)
WHERE d.text CONTAINS "attention sink"
AND d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:41:42,970 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:41:42,971 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:41:44,071 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain-of-of-thought'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES

**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**

**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**

1The University of Melbourne 2The University of Sydney
_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au
_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au
tongliang.liu@sydney.edu.au


ABSTRACT


Despite excelling on multimodal benc…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_index: 3
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: pendix A.11 shows that masking the **math reasoning** heads leads to errors in arithmetic tasks, while
visual receptive functions remain largely unaffected. This confirms that these cognitive heads are
crucial for specific functions and highlights the robustness and generalizability of our method.


**Positive Intervention:** We calculate the activation directions of different functions using the CogVision dataset. For each function, the activation direction of a head at layer _l_ and index _h_ is computed

as:
dir _[h]_ _l_ [=][ E] _[i][∈D]_ correct � _x_ _[h]_ _l_ [(] _[i]_ [)] � _−_ E _i∈D_…
2026-01-02 12:41:44,441 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:41:53,200 - __main__ - INFO - Processing query: How many main questions and subquestions are contained within the final CogVision dataset after filtering?
2026-01-02 12:41:53,200 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:41:53,202 - query_agent - INFO - RAG Tool invoked with user query: How many main questions and subquestions are contained within the final CogVision dataset after filtering?
2026-01-02 12:41:53,435 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:41:53,437 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:41:53,438 - query_agent - INFO -   Subquery 1: CogVision dataset final questions count after filtering
2026-01-02 12:41:53,439 - query_agent - INFO -   Subquery 2: CogVision dataset main questions and subquestions count
2026-01-02 12:41:53,439 - query_agent - INFO -   Subquery 3: CogVision dataset statistics after filtering
2026-01-02 12:41:53,440 - query_agent - INFO - RAG internal retrieval query: CogVision dataset final questions count after filtering
2026-01-02 12:41:53,531 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset final questions count after filtering'
2026-01-02 12:41:53,532 - query_agent - INFO - RAG internal retrieval query: CogVision dataset main questions and subquestions count
2026-01-02 12:41:53,613 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset main questions and subquestions count'
2026-01-02 12:41:53,613 - query_agent - INFO - RAG internal retrieval query: CogVision dataset statistics after filtering
2026-01-02 12:41:53,699 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision dataset statistics after filtering'
2026-01-02 12:41:53,699 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:41:53,699 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:41:53,700 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_9
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:41:53,700 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_8
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:41:53,700 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:41:53,700 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=28266
2026-01-02 12:41:53,701 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:41:53,701 - query_agent - INFO - Graph Tool invoked with user query: How many main questions and subquestions are contained within the final CogVision dataset after filtering?
2026-01-02 12:41:53,701 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:41:55,769 - query_agent - INFO - Resolving entities from graph for query: How many main questions and subquestions are contained within the final CogVision dataset after filtering?
2026-01-02 12:41:55,939 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- CogVision Dataset (Concept)
- CogVision Dataset (Dataset)
- CogVision (Dataset)
- w/o Main Question (Concept)
- okvqa Dataset (Concept)
2026-01-02 12:41:56,131 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:42:05,261 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:42:05,262 - query_agent - INFO - None
2026-01-02 12:42:05,262 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:42:05,262 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:42:06,253 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'CogVision Dataset'}, 'APPLIED_TO', {'id': 'Chain of Thought (CoT) prompting'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'w/o Main Question'}]}

Neighborhood of Concept 'CogVision Dataset':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'd11ea42ea84f64f79324d9d9907a5e64'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'aed6cdc4707517e631fbdd3214804411'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '8b83039a78b7cb477ca7090ed45387fd'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Inference'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Math Reasoning'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Language Knowledge Recall'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Decision-Making'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Vision Knowledge Recall'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'multimodal reasoning'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'High-Level Vision Reception'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Semantic Understanding'}
{'rel': 'APPLIED_TO', 'n_labels': ['Task'], 'n_id': 'Low-Level Vision Reception'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Chain of Thought (CoT) prompting'}
{'rel': 'APPLIED_TO', 'n_labels': ['Model'], 'n_id': 'InternVL3-8B'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Intervention'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'Positive Intervention'}
{'rel': 'APPLIED_TO', 'n_labels': ['Concept'], 'n_id': 'annotation pipeline'}
{'rel': 'ADDRESSES', 'n_labels': ['Concept'], 'n_id': 'Hierarchical structure'}
{'rel': 'INSPIRED_BY', 'n_labels': ['Concept'], 'n_id': 'Human cognitive processes'}

Images (from graph):
- img_attention_functional_roles_22_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-22-0.png | related_to=w/o Main Question
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=w/o Main Question
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=w/o Main Question
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=w/o Main Question
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=w/o Main Question
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=w/o Main Question
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=w/o Main Question
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=w/o Main Question
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=w/o Main Question
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=w/o Main Question
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=w/o Main Question
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=w/o Main Question
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=w/o Main Question
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=w/o Main Question
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=w/o Main Question

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES

**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**

**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**

1The University of Melbourne 2The University of Sydney
_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au
_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au
tongliang.liu@sydney.edu.au


ABSTRACT


Despite excelling on multimodal benc…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: In addition to masking, we also conduct activation patching, where the activations of cognitive heads
associated with one function are replaced by those from another function using two strategies: ran

6




```json
"img_attention_functional_roles_5_1": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png",
    "page": 5,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "…
2026-01-02 12:42:06,546 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:42:13,987 - __main__ - INFO - Processing query: What are the two sub-layers present in each layer of the Transformer's encoder stack?
2026-01-02 12:42:13,987 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:42:13,989 - query_agent - INFO - RAG Tool invoked with user query: What are the two sub-layers present in each layer of the Transformer's encoder stack?
2026-01-02 12:42:14,259 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:42:14,260 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:42:14,260 - query_agent - INFO -   Subquery 1: Transformer encoder stack sub-layers
2026-01-02 12:42:14,261 - query_agent - INFO -   Subquery 2: encoder layer components
2026-01-02 12:42:14,261 - query_agent - INFO -   Subquery 3: Transformer encoder architecture
2026-01-02 12:42:14,261 - query_agent - INFO - RAG internal retrieval query: Transformer encoder stack sub-layers
2026-01-02 12:42:14,338 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer encoder stack sub-layers'
2026-01-02 12:42:14,338 - query_agent - INFO - RAG internal retrieval query: encoder layer components
2026-01-02 12:42:14,414 - query_agent - INFO - RAG retrieved 3 documents for subquery 'encoder layer components'
2026-01-02 12:42:14,415 - query_agent - INFO - RAG internal retrieval query: Transformer encoder architecture
2026-01-02 12:42:14,488 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer encoder architecture'
2026-01-02 12:42:14,488 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:42:14,488 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:42:14,488 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:42:14,488 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:42:14,489 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:42:14,489 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=29274
2026-01-02 12:42:14,489 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:42:14,489 - query_agent - INFO - Graph Tool invoked with user query: What are the two sub-layers present in each layer of the Transformer's encoder stack?
2026-01-02 12:42:14,490 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:42:16,798 - query_agent - INFO - Resolving entities from graph for query: What are the two sub-layers present in each layer of the Transformer's encoder stack?
2026-01-02 12:42:17,024 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Encoder (Model)
- layers (Concept)
- Encoder (Concept)
- In-Domain Data (Concept)
- Interleaving Layers (Concept)
2026-01-02 12:42:17,248 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:43:05,442 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:43:05,443 - query_agent - INFO - MATCH (l:Concept {id: 'layers'})
MATCH (e:Model {id: 'Encoder'})
MATCH (sublayer:Concept)
WHERE sublayer.id <> l.id AND sublayer.id <> e.id AND sublayer.id <> 'Encoder'
MATCH (d:Document)-[:MENTIONS]->(l)
MATCH (d)-[:MENTIONS]->(e)
MATCH (d)-[:MENTIONS]->(sublayer)
RETURN DISTINCT sublayer.id
LIMIT 2
2026-01-02 12:43:05,444 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:43:05,445 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:43:06,609 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'layers'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Transformer'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '93ec065e0391e99e3dd12c28af8c5ff9', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'Encoder'}]}

Neighborhood of Concept 'layers':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd'}
{'rel': 'USES', 'n_labels': ['Model'], 'n_id': 'Gemma2'}
{'rel': 'USES', 'n_labels': ['Model'], 'n_id': 'Gemma-3'}

Images (from graph):
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Encoder
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Encoder
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Encoder
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Encoder
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Encoder
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Encoder

Chunks (resolved from Document.source_id):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: - The encoder contains self-attention layers. In a self-attention layer all of the keys, values
and queries come from the same place, in this case, the output of the previous layer in the
encoder. Each position in the encoder can attend to all positions in the previous layer of the
encoder.


    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to
all positions in the decoder up to and including that position. We need to prevent leftward
information flow in the decoder to preserve the auto-regressive property. We implement this
inside of scaled dot…

- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: ## **Sliding Window Attention Adaptation**

Yijiong Yu [a], Jiale Liu [b], Qingyun Wu [b], Huazheng Wang [a], and Ji Pei [c]


aOregon State University, {yuyiji, huazheng.wang}@oregonstate.edu
bPenn State University, {jiale.liu, qingyun.wu}@psu.edu
cDeepSolution, research@deepsolution.chat



**Abstract**


The self-attention mechanism in Transformer
based Large Language Models (LLMs) scales
quadratically with input length, making longcontext inference expensive. Sliding window attention (SWA) reduces this cost to linear complexity, but naively enabling complete
SWA at inference-time for model…
2026-01-02 12:43:06,891 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:43:11,840 - __main__ - INFO - Processing query: Which specific metric was used to evaluate the Remaining Useful Life (RUL) estimation in the NAC experiments?
2026-01-02 12:43:11,841 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:43:11,843 - query_agent - INFO - RAG Tool invoked with user query: Which specific metric was used to evaluate the Remaining Useful Life (RUL) estimation in the NAC experiments?
2026-01-02 12:43:12,108 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:43:12,109 - query_agent - INFO - Generated 3 RAG subqueries:
2026-01-02 12:43:12,109 - query_agent - INFO -   Subquery 1: NAC experiments RUL estimation evaluation metric
2026-01-02 12:43:12,109 - query_agent - INFO -   Subquery 2: Remaining Useful Life estimation metric NAC
2026-01-02 12:43:12,109 - query_agent - INFO -   Subquery 3: RUL prediction evaluation metric in NAC experiments
2026-01-02 12:43:12,110 - query_agent - INFO - RAG internal retrieval query: NAC experiments RUL estimation evaluation metric
2026-01-02 12:43:12,185 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC experiments RUL estimation evaluation metric'
2026-01-02 12:43:12,185 - query_agent - INFO - RAG internal retrieval query: Remaining Useful Life estimation metric NAC
2026-01-02 12:43:12,262 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Remaining Useful Life estimation metric NAC'
2026-01-02 12:43:12,263 - query_agent - INFO - RAG internal retrieval query: RUL prediction evaluation metric in NAC experiments
2026-01-02 12:43:12,343 - query_agent - INFO - RAG retrieved 3 documents for subquery 'RUL prediction evaluation metric in NAC experiments'
2026-01-02 12:43:12,344 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:43:12,344 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_6
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:12,344 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:12,344 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_16
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:12,345 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_5
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:12,345 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=19305
2026-01-02 12:43:12,345 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:43:12,346 - query_agent - INFO - Graph Tool invoked with user query: Which specific metric was used to evaluate the Remaining Useful Life (RUL) estimation in the NAC experiments?
2026-01-02 12:43:12,346 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:43:14,557 - query_agent - INFO - Resolving entities from graph for query: Which specific metric was used to evaluate the Remaining Useful Life (RUL) estimation in the NAC experiments?
2026-01-02 12:43:14,763 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Remaining Useful Life (RUL) estimation (Task)
- In-Domain Data (Concept)
- Weight Estimation (Concept)
- Degradation Estimation (Task)
- Gradient estimation (Concept)
2026-01-02 12:43:14,961 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:43:25,907 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:43:25,907 - query_agent - INFO - MATCH (t:Task {id: 'Remaining Useful Life (RUL) estimation'})
MATCH (c:Concept)-[:APPLIED_TO]->(t)
RETURN c.id
2026-01-02 12:43:25,907 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'c.id': 'PRONOSTIA dataset'}, {'c.id': 'XJTU-SY dataset'}, {'c.id': 'HUST dataset'}]
2026-01-02 12:43:26,119 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'c.id': 'PRONOSTIA dataset'}
{'c.id': 'XJTU-SY dataset'}
{'c.id': 'HUST dataset'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data
2026-01-02 12:43:26,385 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:43:32,668 - __main__ - INFO - Processing query: How does the "Neuronal Attention Circuit" fundamentally redefine the calculation of attention logits compared to the standard "Scaled Dot-Product Attention"?
2026-01-02 12:43:32,668 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:43:32,670 - query_agent - INFO - RAG Tool invoked with user query: How does the "Neuronal Attention Circuit" fundamentally redefine the calculation of attention logits compared to the standard "Scaled Dot-Product Attention"?
2026-01-02 12:43:32,954 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:43:32,955 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:43:32,956 - query_agent - INFO -   Subquery 1: Neuronal Attention Circuit vs Scaled Dot-Product Attention
2026-01-02 12:43:32,956 - query_agent - INFO -   Subquery 2: Neuronal Attention Circuit attention logits calculation
2026-01-02 12:43:32,956 - query_agent - INFO -   Subquery 3: Scaled Dot-Product Attention mechanism
2026-01-02 12:43:32,956 - query_agent - INFO -   Subquery 4: attention logits Neuronal Attention Circuit
2026-01-02 12:43:32,956 - query_agent - INFO -   Subquery 5: comparison of Neuronal Attention Circuit and Scaled Dot-Product Attention
2026-01-02 12:43:32,957 - query_agent - INFO - RAG internal retrieval query: Neuronal Attention Circuit vs Scaled Dot-Product Attention
2026-01-02 12:43:33,035 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Attention Circuit vs Scaled Dot-Product Attention'
2026-01-02 12:43:33,035 - query_agent - INFO - RAG internal retrieval query: Neuronal Attention Circuit attention logits calculation
2026-01-02 12:43:33,114 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Neuronal Attention Circuit attention logits calculation'
2026-01-02 12:43:33,114 - query_agent - INFO - RAG internal retrieval query: Scaled Dot-Product Attention mechanism
2026-01-02 12:43:33,192 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Scaled Dot-Product Attention mechanism'
2026-01-02 12:43:33,192 - query_agent - INFO - RAG internal retrieval query: attention logits Neuronal Attention Circuit
2026-01-02 12:43:33,267 - query_agent - INFO - RAG retrieved 3 documents for subquery 'attention logits Neuronal Attention Circuit'
2026-01-02 12:43:33,267 - query_agent - INFO - RAG internal retrieval query: comparison of Neuronal Attention Circuit and Scaled Dot-Product Attention
2026-01-02 12:43:33,353 - query_agent - INFO - RAG retrieved 3 documents for subquery 'comparison of Neuronal Attention Circuit and Scaled Dot-Product Attention'
2026-01-02 12:43:33,353 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:43:33,353 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_8
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:33,353 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:33,354 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:33,354 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:43:33,354 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:43:33,354 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=33490
2026-01-02 12:43:33,354 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:43:33,355 - query_agent - INFO - Graph Tool invoked with user query: How does the "Neuronal Attention Circuit" fundamentally redefine the calculation of attention logits compared to the standard "Scaled Dot-Product Attention"?
2026-01-02 12:43:33,355 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:43:35,444 - query_agent - INFO - Resolving entities from graph for query: How does the "Neuronal Attention Circuit" fundamentally redefine the calculation of attention logits compared to the standard "Scaled Dot-Product Attention"?
2026-01-02 12:43:35,645 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Scaled Dot-Product Attention (Model)
- Scaled Dot-Product Attention (Concept)
- Neuronal Attention Circuit (NAC) (Concept)
- Neuronal Attention Circuit (NAC) (Model)
- Multi-Head Neuronal Attention Circuit (Concept)
2026-01-02 12:43:35,838 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:43:53,323 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: Concept OR n1)} {position: line: 3, column: 11, offset: 110} for query: "cypher\nMATCH (n1 {id:'Neuronal Attention Circuit (NAC)'}), (n2 {id:'Scaled Dot-Product Attention'})\nWHERE (n1:`Concept OR n1`:Model) AND (n2:`Concept OR n2`:Model)\nMATCH (n1)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(n2)\nWHERE d.source_type = 'chunk'\nRETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text\nLIMIT 10\n"
2026-01-02 12:43:53,323 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownLabelWarning} {category: UNRECOGNIZED} {title: The provided label is not in the database.} {description: One of the labels in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing label name is: Concept OR n2)} {position: line: 3, column: 42, offset: 141} for query: "cypher\nMATCH (n1 {id:'Neuronal Attention Circuit (NAC)'}), (n2 {id:'Scaled Dot-Product Attention'})\nWHERE (n1:`Concept OR n1`:Model) AND (n2:`Concept OR n2`:Model)\nMATCH (n1)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(n2)\nWHERE d.source_type = 'chunk'\nRETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text\nLIMIT 10\n"
2026-01-02 12:43:53,323 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Statement.CartesianProduct} {category: PERFORMANCE} {title: This query builds a cartesian product between disconnected patterns.} {description: If a part of a query contains multiple disconnected patterns, this will build a cartesian product between all those parts. This may produce a large amount of data and slow down query processing. While occasionally intended, it may often be possible to reformulate the query that avoids the use of this cross product, perhaps by adding a relationship between the different parts or by using OPTIONAL MATCH (identifier is: (n2))} {position: line: 2, column: 1, offset: 7} for query: "cypher\nMATCH (n1 {id:'Neuronal Attention Circuit (NAC)'}), (n2 {id:'Scaled Dot-Product Attention'})\nWHERE (n1:`Concept OR n1`:Model) AND (n2:`Concept OR n2`:Model)\nMATCH (n1)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(n2)\nWHERE d.source_type = 'chunk'\nRETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text\nLIMIT 10\n"
2026-01-02 12:43:54,535 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:43:54,536 - query_agent - INFO - cypher
MATCH (n1 {id:'Neuronal Attention Circuit (NAC)'}), (n2 {id:'Scaled Dot-Product Attention'})
WHERE (n1:`Concept OR n1`:Model) AND (n2:`Concept OR n2`:Model)
MATCH (n1)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(n2)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10

2026-01-02 12:43:54,537 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:43:54,538 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:43:55,590 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Scaled Dot-Product Attention'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'c35df05545627694d3b4bbf52619a5da', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'Attention mechanism'}, 'MENTIONS', {'derived_from_chunk_file': 'neuronal_attention_circuits_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de', 'text': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images', 'source_id': 'neuronal_attention_circuits_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Neuronal Attention Circuit (NAC)'}]}

Neighborhood of Concept 'Scaled Dot-Product Attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'c35df05545627694d3b4bbf52619a5da'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '4e87a758911b5ed6da32ce7e17b0bbf5'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_3_1'}
{'rel': 'INTRODUCED_BY', 'n_labels': ['Person'], 'n_id': 'Noam Shazeer'}
{'rel': 'INTRODUCED_BY', 'n_labels': ['Publication'], 'n_id': 'Vaswani et al., 2017'}
{'rel': 'BUILDS_ON', 'n_labels': ['Concept'], 'n_id': 'Multi-Head Attention'}

Images (from graph):
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Scaled Dot-Product Attention
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Scaled Dot-Product Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Scaled Dot-Product Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Scaled Dot-Product Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Scaled Dot-Product Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Scaled Dot-Product Attention
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Neuronal Attention Circuit (NAC)
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Neuronal Attention Circuit (NAC)

Chunks (resolved from Document.source_id):
- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.

## **Attention Is All You Need**



**Niki Parmar** _[∗]_
Google Research
```
nikip@google.com

```


**Ashish Vaswani** _[∗]_
Google Brain
```
avaswani@google.com

```

**Llion Jones** _[∗]_
Google Research
```
 llion@google.com

```


**Noam Shazeer** _[∗]_
Google Brain
```
noam@google.com

```


**Jakob Uszkoreit** _[∗]_
Google Research
```
usz@google.com

```


**Aidan N. Gomez** _[∗†]_
University of Toronto
```
aidan…
2026-01-02 12:43:55,951 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:44:08,525 - __main__ - INFO - Processing query: Critique the architectural decision to remove "recurrence" and "convolutions" in favor of "self-attention" as proposed in "Attention Is All You Need".
2026-01-02 12:44:08,525 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:44:08,527 - query_agent - INFO - RAG Tool invoked with user query: Critique the architectural decision to remove "recurrence" and "convolutions" in favor of "self-attention" as proposed in "Attention Is All You Need".
2026-01-02 12:44:08,813 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:44:08,814 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:44:08,814 - query_agent - INFO -   Subquery 1: Attention Is All You Need self-attention mechanism critique
2026-01-02 12:44:08,815 - query_agent - INFO -   Subquery 2: self-attention vs recurrence in neural networks
2026-01-02 12:44:08,815 - query_agent - INFO -   Subquery 3: convolutions vs self-attention in transformer models
2026-01-02 12:44:08,815 - query_agent - INFO -   Subquery 4: "Attention Is All You Need" architectural decisions
2026-01-02 12:44:08,815 - query_agent - INFO -   Subquery 5: transformer model self-attention implications
2026-01-02 12:44:08,816 - query_agent - INFO - RAG internal retrieval query: Attention Is All You Need self-attention mechanism critique
2026-01-02 12:44:08,887 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Attention Is All You Need self-attention mechanism critique'
2026-01-02 12:44:08,887 - query_agent - INFO - RAG internal retrieval query: self-attention vs recurrence in neural networks
2026-01-02 12:44:08,959 - query_agent - INFO - RAG retrieved 3 documents for subquery 'self-attention vs recurrence in neural networks'
2026-01-02 12:44:08,960 - query_agent - INFO - RAG internal retrieval query: convolutions vs self-attention in transformer models
2026-01-02 12:44:09,036 - query_agent - INFO - RAG retrieved 3 documents for subquery 'convolutions vs self-attention in transformer models'
2026-01-02 12:44:09,037 - query_agent - INFO - RAG internal retrieval query: "Attention Is All You Need" architectural decisions
2026-01-02 12:44:09,116 - query_agent - INFO - RAG retrieved 3 documents for subquery '"Attention Is All You Need" architectural decisions'
2026-01-02 12:44:09,116 - query_agent - INFO - RAG internal retrieval query: transformer model self-attention implications
2026-01-02 12:44:09,197 - query_agent - INFO - RAG retrieved 3 documents for subquery 'transformer model self-attention implications'
2026-01-02 12:44:09,197 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:44:09,197 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:44:09,198 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:44:09,198 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:44:09,198 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:44:09,198 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:44:09,199 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:44:09,199 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=42306
2026-01-02 12:44:09,199 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:44:09,200 - query_agent - INFO - Graph Tool invoked with user query: Critique the architectural decision to remove "recurrence" and "convolutions" in favor of "self-attention" as proposed in "Attention Is All You Need".
2026-01-02 12:44:09,200 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:44:11,211 - query_agent - INFO - Resolving entities from graph for query: Critique the architectural decision to remove "recurrence" and "convolutions" in favor of "self-attention" as proposed in "Attention Is All You Need".
2026-01-02 12:44:11,386 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- In-Domain Data (Concept)
- Self-attention mechanism (Concept)
- self-attention mechanism (Concept)
- Separable Convolutions (Concept)
- Dilated Convolutions (Concept)
2026-01-02 12:44:11,573 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:44:30,096 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:44:30,096 - query_agent - INFO - MATCH (selfAttention:Concept {id: "Self-attention mechanism"})
MATCH (pub:Publication {id: "Attention Is All You Need"})
MATCH (recurrence:Concept {id: "recurrence"})
MATCH (convolutions:Concept {id: "convolutions"})
MATCH (d:Document)
WHERE (d)-[:MENTIONS]->(selfAttention)
  AND (d)-[:MENTIONS]->(pub)
  AND ( (d)-[:MENTIONS]->(recurrence) OR (d)-[:MENTIONS]->(convolutions) )
  AND d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:44:30,097 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:44:30,098 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:44:31,019 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'In-Domain Data'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Long-range dependencies'}, 'ADDRESSES', {'id': 'Self-attention mechanism'}]}

Neighborhood of Concept 'In-Domain Data':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_26_0'}

Images (from graph):
- img_attention_functional_roles_26_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-26-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=In-Domain Data
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=In-Domain Data
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=In-Domain Data
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=In-Domain Data
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=In-Domain Data
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=In-Domain Data
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=In-Domain Data
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=In-Domain Data
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=In-Domain Data
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=In-Domain Data
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=In-Domain Data
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=In-Domain Data
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=In-Domain Data
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=In-Domain Data

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_7
  chunk_index: 7
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 25



```json
"img_attention_functional_roles_25_0": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-25-0.png",
    "page": 25,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "semantic_role": "illustrates",
    "caption": "A grid of eight correlation matrices displays the relationships between four distinct models (Qwen2.5VL-7B, Qwen2.5VL-3B, Intern3VL-8B, Intern3VL-2B) ac…
2026-01-02 12:44:31,193 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:44:50,530 - __main__ - INFO - Processing query: Analyze the systemic trade-offs between "accuracy" and "peak memory usage" when deploying "NAC-PW" versus "NAC-2k".
2026-01-02 12:44:50,531 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:44:50,533 - query_agent - INFO - RAG Tool invoked with user query: Analyze the systemic trade-offs between "accuracy" and "peak memory usage" when deploying "NAC-PW" versus "NAC-2k".
2026-01-02 12:44:50,854 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:44:50,855 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:44:50,855 - query_agent - INFO -   Subquery 1: NAC-PW vs NAC-2k accuracy peak memory usage trade-off
2026-01-02 12:44:50,855 - query_agent - INFO -   Subquery 2: NAC-PW accuracy and peak memory usage analysis
2026-01-02 12:44:50,855 - query_agent - INFO -   Subquery 3: NAC-2k accuracy and peak memory usage comparison
2026-01-02 12:44:50,856 - query_agent - INFO -   Subquery 4: Systemic trade-offs NAC-PW NAC-2k deployment
2026-01-02 12:44:50,856 - query_agent - INFO -   Subquery 5: NAC-PW NAC-2k memory accuracy optimization
2026-01-02 12:44:50,856 - query_agent - INFO - RAG internal retrieval query: NAC-PW vs NAC-2k accuracy peak memory usage trade-off
2026-01-02 12:44:50,955 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC-PW vs NAC-2k accuracy peak memory usage trade-off'
2026-01-02 12:44:50,955 - query_agent - INFO - RAG internal retrieval query: NAC-PW accuracy and peak memory usage analysis
2026-01-02 12:44:51,048 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC-PW accuracy and peak memory usage analysis'
2026-01-02 12:44:51,048 - query_agent - INFO - RAG internal retrieval query: NAC-2k accuracy and peak memory usage comparison
2026-01-02 12:44:51,175 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC-2k accuracy and peak memory usage comparison'
2026-01-02 12:44:51,176 - query_agent - INFO - RAG internal retrieval query: Systemic trade-offs NAC-PW NAC-2k deployment
2026-01-02 12:44:51,263 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Systemic trade-offs NAC-PW NAC-2k deployment'
2026-01-02 12:44:51,263 - query_agent - INFO - RAG internal retrieval query: NAC-PW NAC-2k memory accuracy optimization
2026-01-02 12:44:51,341 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC-PW NAC-2k memory accuracy optimization'
2026-01-02 12:44:51,341 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 3
2026-01-02 12:44:51,341 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:44:51,341 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_6
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:44:51,341 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:44:51,341 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=3, total_chars=15113
2026-01-02 12:44:51,342 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:44:51,342 - query_agent - INFO - Graph Tool invoked with user query: Analyze the systemic trade-offs between "accuracy" and "peak memory usage" when deploying "NAC-PW" versus "NAC-2k".
2026-01-02 12:44:51,342 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:44:53,343 - query_agent - INFO - Resolving entities from graph for query: Analyze the systemic trade-offs between "accuracy" and "peak memory usage" when deploying "NAC-PW" versus "NAC-2k".
2026-01-02 12:44:53,530 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- NAC-PW (Model)
- NAC-2k (Model)
- Accuracy (Concept)
- model accuracy (Concept)
- performance-efficiency trade-off (Concept)
2026-01-02 12:44:53,714 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:45:11,446 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:45:11,447 - query_agent - INFO - MATCH (nac_pw:Model {id: 'NAC-PW'})
MATCH (nac_2k:Model {id: 'NAC-2k'})
MATCH (accuracy_concept:Concept) WHERE accuracy_concept.id IN ['Accuracy', 'model accuracy']
MATCH (performance_tradeoff:Concept {id: 'performance-efficiency trade-off'})
MATCH (nac_pw)<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(nac_2k)
MATCH (d)-[:MENTIONS]->(accuracy_concept)
MATCH (d)-[:MENTIONS]->(performance_tradeoff)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:45:11,448 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:45:11,449 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:45:12,408 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Accuracy'}, 'MENTIONS', {'chunk_index': '1', 'chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': '93ec065e0391e99e3dd12c28af8c5ff9', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1', 'chunk_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1'}, 'MENTIONS', {'id': 'Transformer'}, 'MENTIONS', {'chunk_index': '0', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0'}, 'MENTIONS', {'id': 'model accuracy'}]}

Neighborhood of Concept 'Accuracy':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '1e019b3c12ec094edf7c08ed4366e1c7'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '93ec065e0391e99e3dd12c28af8c5ff9'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e53e1c2a9bc8acdfefcd9baa3b5e79de'}
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '2744b9576e4b8775554097f7f913b30d'}
{'rel': 'IMPROVES', 'n_labels': ['Algorithm'], 'n_id': 'Label Smoothing'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_neuronal_attention_circuits_13_0'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_sliding_window_attention_7_0'}
{'rel': 'SUPPORTS', 'n_labels': ['Concept'], 'n_id': 'Attention mechanism'}

Images (from graph):
- img_neuronal_attention_circuits_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-13-0.png | related_to=Accuracy
- img_sliding_window_attention_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/sliding_window_attention.pdf-7-0.png | related_to=Accuracy
- img_neuronal_attention_circuits_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-2-0.png | related_to=Accuracy
- img_neuronal_attention_circuits_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-5-0.png | related_to=Accuracy
- img_neuronal_attention_circuits_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-6-0.png | related_to=Accuracy
- img_neuronal_attention_circuits_15_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-0.png | related_to=Accuracy
- img_neuronal_attention_circuits_15_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/neuronal_attention_circuits.pdf-15-1.png | related_to=Accuracy
- img_sliding_window_attention_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/sliding_window_attention.pdf-2-0.png | related_to=Accuracy

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: ## **Sliding Window Attention Adaptation**

Yijiong Yu [a], Jiale Liu [b], Qingyun Wu [b], Huazheng Wang [a], and Ji Pei [c]


aOregon State University, {yuyiji, huazheng.wang}@oregonstate.edu
bPenn State University, {jiale.liu, qingyun.wu}@psu.edu
cDeepSolution, research@deepsolution.chat



**Abstract**


The self-attention mechanism in Transformer
based Large Language Models (LLMs) scales
quadratically with input length, making longcontext inference expensive. Sliding window attention (SWA) reduces this cost to linear complexity, but naively enabling complete
SWA at inference-time for model…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: - The encoder contains self-attention layers. In a self-attention layer all of the keys, values
and queries come from the same place, in this case, the output of the previous layer in the
encoder. Each position in the encoder can attend to all positions in the previous layer of the
encoder.


    - Similarly, self-attention layers in the decoder allow each position in the decoder to attend to
all positions in the decoder up to and including that position. We need to prevent leftward
information flow in the decoder to preserve the auto-regressive property. We implement this
inside of scaled dot…
2026-01-02 12:45:12,589 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:45:25,221 - __main__ - INFO - Processing query: Evaluate the architectural implications of "hybrid model structures" that interleave "linear attention" with traditional attention, as discussed in the context of SWAA.
2026-01-02 12:45:25,221 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:45:25,222 - query_agent - INFO - RAG Tool invoked with user query: Evaluate the architectural implications of "hybrid model structures" that interleave "linear attention" with traditional attention, as discussed in the context of SWAA.
2026-01-02 12:45:25,466 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:45:25,467 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:45:25,467 - query_agent - INFO -   Subquery 1: SWAA hybrid model structures linear attention
2026-01-02 12:45:25,468 - query_agent - INFO -   Subquery 2: interleaving linear attention traditional attention
2026-01-02 12:45:25,468 - query_agent - INFO -   Subquery 3: SWAA architectural implications hybrid models
2026-01-02 12:45:25,468 - query_agent - INFO -   Subquery 4: linear attention vs traditional attention SWAA
2026-01-02 12:45:25,468 - query_agent - INFO -   Subquery 5: hybrid attention mechanisms in SWAA
2026-01-02 12:45:25,468 - query_agent - INFO - RAG internal retrieval query: SWAA hybrid model structures linear attention
2026-01-02 12:45:25,538 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA hybrid model structures linear attention'
2026-01-02 12:45:25,538 - query_agent - INFO - RAG internal retrieval query: interleaving linear attention traditional attention
2026-01-02 12:45:25,611 - query_agent - INFO - RAG retrieved 3 documents for subquery 'interleaving linear attention traditional attention'
2026-01-02 12:45:25,611 - query_agent - INFO - RAG internal retrieval query: SWAA architectural implications hybrid models
2026-01-02 12:45:25,683 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA architectural implications hybrid models'
2026-01-02 12:45:25,684 - query_agent - INFO - RAG internal retrieval query: linear attention vs traditional attention SWAA
2026-01-02 12:45:25,761 - query_agent - INFO - RAG retrieved 3 documents for subquery 'linear attention vs traditional attention SWAA'
2026-01-02 12:45:25,761 - query_agent - INFO - RAG internal retrieval query: hybrid attention mechanisms in SWAA
2026-01-02 12:45:25,841 - query_agent - INFO - RAG retrieved 3 documents for subquery 'hybrid attention mechanisms in SWAA'
2026-01-02 12:45:25,842 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:45:25,842 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:45:25,842 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:45:25,842 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:45:25,842 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:45:25,843 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:45:25,843 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=36991
2026-01-02 12:45:25,843 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:45:25,844 - query_agent - INFO - Graph Tool invoked with user query: Evaluate the architectural implications of "hybrid model structures" that interleave "linear attention" with traditional attention, as discussed in the context of SWAA.
2026-01-02 12:45:25,844 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:45:27,846 - query_agent - INFO - Resolving entities from graph for query: Evaluate the architectural implications of "hybrid model structures" that interleave "linear attention" with traditional attention, as discussed in the context of SWAA.
2026-01-02 12:45:28,023 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- linear attention (Concept)
- Linear attention (Concept)
- Chain-of-of-thought (Concept)
- Out-of-Domain (Concept)
- Chain-of-Thought (Concept)
2026-01-02 12:45:28,210 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:45:45,294 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:45:45,295 - query_agent - INFO - MATCH (c:Concept)
WHERE c.id IN ['linear attention', 'Linear attention']
MATCH (c)<-[:MENTIONS]-(d:Document)
WHERE d.source_type = 'chunk'
  AND (
    toLower(d.text) CONTAINS 'hybrid model' OR
    toLower(d.text) CONTAINS 'hybrid structures' OR
    toLower(d.text) CONTAINS 'interleave' OR
    toLower(d.text) CONTAINS 'interleaving'
  )
  AND (
    toLower(d.text) CONTAINS 'traditional attention' OR
    toLower(d.text) CONTAINS 'standard attention' OR
    toLower(d.text) CONTAINS 'self-attention'
  )
  AND toLower(d.text) CONTAINS 'swaa'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index
LIMIT 10
2026-01-02 12:45:45,295 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:45:45,295 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:45:46,273 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'linear attention'}, 'BUILDS_ON', {'id': 'Jamba'}, 'MENTIONS', {'chunk_index': '2', 'chunk_file': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'source_type': 'chunk', 'id': 'aeb58d067782fbf07367eb644b06ca8b', 'text': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'source_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2', 'chunk_id': 'sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2'}, 'MENTIONS', {'id': 'Linear attention'}]}

Neighborhood of Concept 'linear attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': 'e69b46fe3faf4d7192a2bd3d0f5e3edd'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Jamba'}
{'rel': 'BUILDS_ON', 'n_labels': ['Model'], 'n_id': 'Nemotron-Flash'}

Chunks (resolved from Document.source_id):
- sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl::sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: sliding_window_attention_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'sliding_window_attention_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: Yushi Bai, Shangqing Tu, Jiajie Zhang, Hao Peng, Xiaozhi Wang, Xin Lv, Shulin Cao, Jiazheng Xu, Lei
Hou, Yuxiao Dong, Jie Tang, and Juanzi Li. 2024b.
[Longbench v2: Towards deeper understanding and](https://arxiv.org/abs/2412.15204)
[reasoning on realistic long-context multitasks.](https://arxiv.org/abs/2412.15204)


Iz Beltagy, Matthew E. Peters, and Arman Cohan. 2020.

[Longformer: The long-document transformer.](https://arxiv.org/abs/2004.05150)


[Tri Dao. 2024. Flashattention-2: Faster attention with](https://openreview.net/forum?id=mZn2Xyh9Ec)
[better parallelism and work partitioning.](…
2026-01-02 12:45:46,489 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:45:55,560 - __main__ - INFO - Processing query: How does the "interpretable functional organization" of attention heads in VLMs challenge the view of these models as "black boxes"?
2026-01-02 12:45:55,561 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:45:55,563 - query_agent - INFO - RAG Tool invoked with user query: How does the "interpretable functional organization" of attention heads in VLMs challenge the view of these models as "black boxes"?
2026-01-02 12:45:55,857 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:45:55,858 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:45:55,858 - query_agent - INFO -   Subquery 1: interpretable functional organization of attention heads in VLMs
2026-01-02 12:45:55,859 - query_agent - INFO -   Subquery 2: VLMs attention heads functional organization
2026-01-02 12:45:55,859 - query_agent - INFO -   Subquery 3: challenging black box view of VLMs with attention head analysis
2026-01-02 12:45:55,859 - query_agent - INFO -   Subquery 4: attention heads in VLMs and interpretability
2026-01-02 12:45:55,860 - query_agent - INFO -   Subquery 5: functional organization of VLMs and transparency
2026-01-02 12:45:55,860 - query_agent - INFO - RAG internal retrieval query: interpretable functional organization of attention heads in VLMs
2026-01-02 12:45:55,936 - query_agent - INFO - RAG retrieved 3 documents for subquery 'interpretable functional organization of attention heads in VLMs'
2026-01-02 12:45:55,937 - query_agent - INFO - RAG internal retrieval query: VLMs attention heads functional organization
2026-01-02 12:45:56,017 - query_agent - INFO - RAG retrieved 3 documents for subquery 'VLMs attention heads functional organization'
2026-01-02 12:45:56,018 - query_agent - INFO - RAG internal retrieval query: challenging black box view of VLMs with attention head analysis
2026-01-02 12:45:56,100 - query_agent - INFO - RAG retrieved 3 documents for subquery 'challenging black box view of VLMs with attention head analysis'
2026-01-02 12:45:56,100 - query_agent - INFO - RAG internal retrieval query: attention heads in VLMs and interpretability
2026-01-02 12:45:56,173 - query_agent - INFO - RAG retrieved 3 documents for subquery 'attention heads in VLMs and interpretability'
2026-01-02 12:45:56,174 - query_agent - INFO - RAG internal retrieval query: functional organization of VLMs and transparency
2026-01-02 12:45:56,252 - query_agent - INFO - RAG retrieved 3 documents for subquery 'functional organization of VLMs and transparency'
2026-01-02 12:45:56,252 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:45:56,253 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:45:56,253 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:45:56,253 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:45:56,253 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:45:56,253 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_4
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:45:56,254 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=37214
2026-01-02 12:45:56,254 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:45:56,255 - query_agent - INFO - Graph Tool invoked with user query: How does the "interpretable functional organization" of attention heads in VLMs challenge the view of these models as "black boxes"?
2026-01-02 12:45:56,255 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:45:58,108 - query_agent - INFO - Resolving entities from graph for query: How does the "interpretable functional organization" of attention heads in VLMs challenge the view of these models as "black boxes"?
2026-01-02 12:45:58,288 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Cognitive organization of VLMs (Concept)
- Chain-of-of-thought (Concept)
- Attention heads (Concept)
- attention heads (Concept)
- Evaluation of Evidence (Concept)
2026-01-02 12:45:58,468 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:49:50,422 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:49:50,423 - query_agent - INFO - MATCH (a:Concept {id:'Attention heads'})<-[:MENTIONS]-(d:Document)-[:MENTIONS]->(m:Model)
WHERE d.source_type = 'chunk'
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index LIMIT 10
2026-01-02 12:49:50,423 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}, {'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}]
2026-01-02 12:49:50,763 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}
{'d.source_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'd.chunk_id': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1', 'd.chunk_index': '1'}

Images (from graph):
- img_attention_functional_roles_20_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-20-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Chain-of-of-thought

Chunks (resolved from Document.source_id):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…
2026-01-02 12:49:51,130 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:50:03,025 - __main__ - INFO - Processing query: Discuss the role of "universal approximation" guarantees in validating the architectural design of NAC.
2026-01-02 12:50:03,025 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:50:03,026 - query_agent - INFO - RAG Tool invoked with user query: Discuss the role of "universal approximation" guarantees in validating the architectural design of NAC.
2026-01-02 12:50:03,351 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:50:03,352 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:50:03,352 - query_agent - INFO -   Subquery 1: universal approximation guarantees NAC
2026-01-02 12:50:03,352 - query_agent - INFO -   Subquery 2: NAC architecture validation
2026-01-02 12:50:03,353 - query_agent - INFO -   Subquery 3: universal approximation theorem neural networks
2026-01-02 12:50:03,353 - query_agent - INFO -   Subquery 4: NAC design principles
2026-01-02 12:50:03,353 - query_agent - INFO -   Subquery 5: role of universal approximation in NAC
2026-01-02 12:50:03,353 - query_agent - INFO - RAG internal retrieval query: universal approximation guarantees NAC
2026-01-02 12:50:03,426 - query_agent - INFO - RAG retrieved 3 documents for subquery 'universal approximation guarantees NAC'
2026-01-02 12:50:03,427 - query_agent - INFO - RAG internal retrieval query: NAC architecture validation
2026-01-02 12:50:03,496 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC architecture validation'
2026-01-02 12:50:03,496 - query_agent - INFO - RAG internal retrieval query: universal approximation theorem neural networks
2026-01-02 12:50:03,569 - query_agent - INFO - RAG retrieved 3 documents for subquery 'universal approximation theorem neural networks'
2026-01-02 12:50:03,569 - query_agent - INFO - RAG internal retrieval query: NAC design principles
2026-01-02 12:50:03,651 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC design principles'
2026-01-02 12:50:03,651 - query_agent - INFO - RAG internal retrieval query: role of universal approximation in NAC
2026-01-02 12:50:03,725 - query_agent - INFO - RAG retrieved 3 documents for subquery 'role of universal approximation in NAC'
2026-01-02 12:50:03,725 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:50:03,725 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:50:03,725 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_11
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:50:03,725 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_2
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:50:03,725 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_7
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:50:03,726 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:50:03,726 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:50:03,726 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:50:03,726 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=38915
2026-01-02 12:50:03,726 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:50:03,727 - query_agent - INFO - Graph Tool invoked with user query: Discuss the role of "universal approximation" guarantees in validating the architectural design of NAC.
2026-01-02 12:50:03,727 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:50:05,727 - query_agent - INFO - Resolving entities from graph for query: Discuss the role of "universal approximation" guarantees in validating the architectural design of NAC.
2026-01-02 12:50:05,902 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Chain-of-of-thought (Concept)
- Universal Approximation Theorem (UAT) (Concept)
- Chain-of-Thought (Concept)
- Evaluation of Evidence (Concept)
- Number of particles (Concept)
2026-01-02 12:50:06,090 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:50:15,783 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:50:15,783 - query_agent - INFO - None
2026-01-02 12:50:15,784 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:50:15,785 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:50:16,859 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Chain-of-of-thought'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Score'}, 'APPLIED_TO', {'id': 'NAC'}, 'SUPPORTS', {'id': 'Universal Approximation Theorem (UAT)'}]}

Neighborhood of Concept 'Chain-of-of-thought':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_20_0'}

Images (from graph):
- img_attention_functional_roles_20_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-20-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Chain-of-of-thought

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES

**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**

**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**

1The University of Melbourne 2The University of Sydney
_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au
_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au
tongliang.liu@sydney.edu.au


ABSTRACT


Despite excelling on multimodal benc…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_index: 3
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: pendix A.11 shows that masking the **math reasoning** heads leads to errors in arithmetic tasks, while
visual receptive functions remain largely unaffected. This confirms that these cognitive heads are
crucial for specific functions and highlights the robustness and generalizability of our method.


**Positive Intervention:** We calculate the activation directions of different functions using the CogVision dataset. For each function, the activation direction of a head at layer _l_ and index _h_ is computed

as:
dir _[h]_ _l_ [=][ E] _[i][∈D]_ correct � _x_ _[h]_ _l_ [(] _[i]_ [)] � _−_ E _i∈D_…
2026-01-02 12:50:17,068 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:50:32,757 - __main__ - INFO - Processing query: How does the "auto-regressive" property of the Transformer decoder influence the design of the "masked multi-head attention" mechanism?
2026-01-02 12:50:32,758 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:50:32,758 - query_agent - INFO - RAG Tool invoked with user query: How does the "auto-regressive" property of the Transformer decoder influence the design of the "masked multi-head attention" mechanism?
2026-01-02 12:50:32,993 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:50:32,995 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:50:32,996 - query_agent - INFO -   Subquery 1: Transformer decoder auto-regressive property
2026-01-02 12:50:32,997 - query_agent - INFO -   Subquery 2: masked multi-head attention mechanism Transformer
2026-01-02 12:50:32,998 - query_agent - INFO -   Subquery 3: auto-regressive decoding and masked attention
2026-01-02 12:50:32,998 - query_agent - INFO -   Subquery 4: Transformer masked multi-head attention design
2026-01-02 12:50:32,999 - query_agent - INFO - RAG internal retrieval query: Transformer decoder auto-regressive property
2026-01-02 12:50:33,092 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer decoder auto-regressive property'
2026-01-02 12:50:33,092 - query_agent - INFO - RAG internal retrieval query: masked multi-head attention mechanism Transformer
2026-01-02 12:50:33,168 - query_agent - INFO - RAG retrieved 3 documents for subquery 'masked multi-head attention mechanism Transformer'
2026-01-02 12:50:33,168 - query_agent - INFO - RAG internal retrieval query: auto-regressive decoding and masked attention
2026-01-02 12:50:33,246 - query_agent - INFO - RAG retrieved 3 documents for subquery 'auto-regressive decoding and masked attention'
2026-01-02 12:50:33,247 - query_agent - INFO - RAG internal retrieval query: Transformer masked multi-head attention design
2026-01-02 12:50:33,321 - query_agent - INFO - RAG retrieved 3 documents for subquery 'Transformer masked multi-head attention design'
2026-01-02 12:50:33,321 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 4
2026-01-02 12:50:33,321 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_2
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:50:33,321 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_0
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:50:33,321 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_is_all_you_need_raw_chunks_2k.jsonl
  Chunk ID: attention_is_all_you_need_raw_chunks_2k_1
  Metadata: {'source': 'attention_is_all_you_need_raw.md'}
2026-01-02 12:50:33,322 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_4
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:50:33,322 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=4, total_chars=29650
2026-01-02 12:50:33,322 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:50:33,323 - query_agent - INFO - Graph Tool invoked with user query: How does the "auto-regressive" property of the Transformer decoder influence the design of the "masked multi-head attention" mechanism?
2026-01-02 12:50:33,323 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:50:35,196 - query_agent - INFO - Resolving entities from graph for query: How does the "auto-regressive" property of the Transformer decoder influence the design of the "masked multi-head attention" mechanism?
2026-01-02 12:50:35,370 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Masked Multi-Head Attention (Concept)
- Chain-of-of-thought (Concept)
- Out-of-Domain (Concept)
- Chain-of-Thought (Concept)
- Number of particles (Concept)
2026-01-02 12:50:35,534 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:50:46,022 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:50:46,023 - query_agent - INFO - MATCH (c:Concept {id: "Masked Multi-Head Attention"})<-[:MENTIONS]-(d:Document)
WHERE d.text CONTAINS "auto-regressive"
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:50:46,024 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:50:46,024 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:50:47,010 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Masked Multi-Head Attention'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '36f927c2ec5951b1af0611a9728d214b', 'text': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Tokens'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain-of-of-thought'}]}

Neighborhood of Concept 'Masked Multi-Head Attention':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '36f927c2ec5951b1af0611a9728d214b'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_is_all_you_need_2_0'}

Images (from graph):
- img_attention_is_all_you_need_2_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-2-0.png | related_to=Masked Multi-Head Attention
- img_attention_is_all_you_need_3_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-0.png | related_to=Masked Multi-Head Attention
- img_attention_is_all_you_need_3_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-3-1.png | related_to=Masked Multi-Head Attention
- img_attention_is_all_you_need_12_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-12-0.png | related_to=Masked Multi-Head Attention
- img_attention_is_all_you_need_13_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-13-0.png | related_to=Masked Multi-Head Attention
- img_attention_is_all_you_need_14_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_is_all_you_need.pdf-14-0.png | related_to=Masked Multi-Head Attention
- img_attention_functional_roles_20_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-20-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Chain-of-of-thought

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES

**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**

**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**

1The University of Melbourne 2The University of Sydney
_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au
_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au
tongliang.liu@sydney.edu.au


ABSTRACT


Despite excelling on multimodal benc…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_index: 3
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: pendix A.11 shows that masking the **math reasoning** heads leads to errors in arithmetic tasks, while
visual receptive functions remain largely unaffected. This confirms that these cognitive heads are
crucial for specific functions and highlights the robustness and generalizability of our method.


**Positive Intervention:** We calculate the activation directions of different functions using the CogVision dataset. For each function, the activation direction of a head at layer _l_ and index _h_ is computed

as:
dir _[h]_ _l_ [=][ E] _[i][∈D]_ correct � _x_ _[h]_ _l_ [(] _[i]_ [)] � _−_ E _i∈D_…

- attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_is_all_you_need_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_is_all_you_need_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: Provided proper attribution is provided, Google hereby grants permission to
reproduce the tables and figures in this paper solely for use in journalistic or
scholarly works.

## **Attention Is All You Need**



**Niki Parmar** _[∗]_
Google Research
```
nikip@google.com

```


**Ashish Vaswani** _[∗]_
Google Brain
```
avaswani@google.com

```

**Llion Jones** _[∗]_
Google Research
```
 llion@google.com

```


**Noam Shazeer** _[∗]_
Google Brain
```
noam@google.com

```


**Jakob Uszkoreit** _[∗]_
Google Research
```
usz@google.com

```


**Aidan N. Gomez** _[∗†]_
University of Toronto
```
aidan…
2026-01-02 12:50:47,211 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:50:59,004 - __main__ - INFO - Processing query: Analyze the "performance-efficiency balance" of the SWAA toolkit and how it allows for flexible deployment strategies.
2026-01-02 12:50:59,004 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:50:59,005 - query_agent - INFO - RAG Tool invoked with user query: Analyze the "performance-efficiency balance" of the SWAA toolkit and how it allows for flexible deployment strategies.
2026-01-02 12:50:59,292 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:50:59,293 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:50:59,293 - query_agent - INFO -   Subquery 1: SWAA toolkit performance-efficiency balance
2026-01-02 12:50:59,293 - query_agent - INFO -   Subquery 2: SWAA deployment strategies flexibility
2026-01-02 12:50:59,294 - query_agent - INFO -   Subquery 3: performance-efficiency trade-off in SWAA
2026-01-02 12:50:59,294 - query_agent - INFO -   Subquery 4: SWAA toolkit flexible deployment options
2026-01-02 12:50:59,294 - query_agent - INFO -   Subquery 5: efficiency and performance balance in SWAA toolkit
2026-01-02 12:50:59,294 - query_agent - INFO - RAG internal retrieval query: SWAA toolkit performance-efficiency balance
2026-01-02 12:50:59,366 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA toolkit performance-efficiency balance'
2026-01-02 12:50:59,366 - query_agent - INFO - RAG internal retrieval query: SWAA deployment strategies flexibility
2026-01-02 12:50:59,444 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA deployment strategies flexibility'
2026-01-02 12:50:59,444 - query_agent - INFO - RAG internal retrieval query: performance-efficiency trade-off in SWAA
2026-01-02 12:50:59,518 - query_agent - INFO - RAG retrieved 3 documents for subquery 'performance-efficiency trade-off in SWAA'
2026-01-02 12:50:59,518 - query_agent - INFO - RAG internal retrieval query: SWAA toolkit flexible deployment options
2026-01-02 12:50:59,608 - query_agent - INFO - RAG retrieved 3 documents for subquery 'SWAA toolkit flexible deployment options'
2026-01-02 12:50:59,608 - query_agent - INFO - RAG internal retrieval query: efficiency and performance balance in SWAA toolkit
2026-01-02 12:50:59,690 - query_agent - INFO - RAG retrieved 3 documents for subquery 'efficiency and performance balance in SWAA toolkit'
2026-01-02 12:50:59,690 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 5
2026-01-02 12:50:59,691 - query_agent - INFO - RAG Unique Doc 1:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_3
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:50:59,691 - query_agent - INFO - RAG Unique Doc 2:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_2
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:50:59,691 - query_agent - INFO - RAG Unique Doc 3:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_1
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:50:59,691 - query_agent - INFO - RAG Unique Doc 4:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_0
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:50:59,691 - query_agent - INFO - RAG Unique Doc 5:
  Source: sliding_window_attention_annotated_chunks_2k.jsonl
  Chunk ID: sliding_window_attention_annotated_chunks_2k_4
  Metadata: {'source': 'sliding_window_attention_annotated.md'}
2026-01-02 12:50:59,692 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=5, total_chars=36766
2026-01-02 12:50:59,692 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:50:59,693 - query_agent - INFO - Graph Tool invoked with user query: Analyze the "performance-efficiency balance" of the SWAA toolkit and how it allows for flexible deployment strategies.
2026-01-02 12:50:59,693 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:51:01,727 - query_agent - INFO - Resolving entities from graph for query: Analyze the "performance-efficiency balance" of the SWAA toolkit and how it allows for flexible deployment strategies.
2026-01-02 12:51:01,903 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Performance-Efficiency Balance (Concept)
- Chain-of-of-thought (Concept)
- model-specific layer selection strategies (Concept)
- lane-keeping for autonomous vehicles (Task)
- gemma-3n-e4b-it (Model)
2026-01-02 12:51:02,078 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:51:13,807 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:51:13,808 - query_agent - INFO - MATCH (c:Concept {id:'Performance-Efficiency Balance'})<-[:MENTIONS]-(d:Document)
WHERE d.source_type = 'chunk'
  AND toLower(d.text) CONTAINS toLower('SWAA toolkit')
  AND toLower(d.text) CONTAINS toLower('flexible deployment strategies')
RETURN d.source_id, d.chunk_file, d.chunk_id, d.chunk_index, d.text
LIMIT 10
2026-01-02 12:51:13,809 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:51:13,809 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:51:14,851 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Performance-Efficiency Balance'}, 'SUPPORTS', {'id': 'Chain of Thought (CoT) prompting'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Chain-of-of-thought'}]}

Neighborhood of Concept 'Performance-Efficiency Balance':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '96cbda833066473ad1bb09119ce583e3'}
{'rel': 'SUPPORTS', 'n_labels': ['Concept'], 'n_id': 'Chain of Thought (CoT) prompting'}

Images (from graph):
- img_attention_functional_roles_20_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-20-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Chain-of-of-thought

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_2
  chunk_index: 2
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: In addition to masking, we also conduct activation patching, where the activations of cognitive heads
associated with one function are replaced by those from another function using two strategies: ran

6




```json
"img_attention_functional_roles_5_1": {
    "path": "E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png",
    "page": 5,
    "section": "- INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES",
    "image_relevance": "high",
    "image_type": "plot",
    "…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_5
  chunk_index: 5
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: The statistics for the CogVision dataset is shown in Table 8


16


Table 8: Dataset Statistics


**Metric** **Training** **Testing**


Main Questions 1,124 285
Sub-questions 4,603 1,141


**Cognitive Skills Distribution**


High-Level Vision Reception 1,262 (27.42%) 336 (29.45%)
Math Reasoning 570 (12.38%) 125 (10.96%)
Semantic Understanding 545 (11.84%) 152 (13.32%)
Inference 544 (11.82%) 126 (11.04%)
Decision-Making 454 (9.86%) 111 (9.73%)
Language Knowledge Recall 424 (9.21%) 102 (8.94%)
Vision Knowledge Recall 403 (8.76%) 96 (8.41%)
Low-Level Vision Reception 401 (8.71%) 92 (8.06%)


A.4 …
2026-01-02 12:51:15,074 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:51:26,514 - __main__ - INFO - Processing query: How does the "CogVision" framework's probing methodology reveal the "hierarchical organization" of cognitive processes in VLMs?
2026-01-02 12:51:26,515 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:51:26,517 - query_agent - INFO - RAG Tool invoked with user query: How does the "CogVision" framework's probing methodology reveal the "hierarchical organization" of cognitive processes in VLMs?
2026-01-02 12:51:26,802 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:51:26,803 - query_agent - INFO - Generated 4 RAG subqueries:
2026-01-02 12:51:26,804 - query_agent - INFO -   Subquery 1: CogVision framework probing methodology hierarchical organization
2026-01-02 12:51:26,804 - query_agent - INFO -   Subquery 2: VLMs cognitive processes hierarchical organization CogVision
2026-01-02 12:51:26,804 - query_agent - INFO -   Subquery 3: CogVision probing methodology for VLMs
2026-01-02 12:51:26,804 - query_agent - INFO -   Subquery 4: hierarchical organization of cognitive processes in vision language models CogVision
2026-01-02 12:51:26,805 - query_agent - INFO - RAG internal retrieval query: CogVision framework probing methodology hierarchical organization
2026-01-02 12:51:26,875 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision framework probing methodology hierarchical organization'
2026-01-02 12:51:26,875 - query_agent - INFO - RAG internal retrieval query: VLMs cognitive processes hierarchical organization CogVision
2026-01-02 12:51:26,952 - query_agent - INFO - RAG retrieved 3 documents for subquery 'VLMs cognitive processes hierarchical organization CogVision'
2026-01-02 12:51:26,952 - query_agent - INFO - RAG internal retrieval query: CogVision probing methodology for VLMs
2026-01-02 12:51:27,027 - query_agent - INFO - RAG retrieved 3 documents for subquery 'CogVision probing methodology for VLMs'
2026-01-02 12:51:27,027 - query_agent - INFO - RAG internal retrieval query: hierarchical organization of cognitive processes in vision language models CogVision
2026-01-02 12:51:27,113 - query_agent - INFO - RAG retrieved 3 documents for subquery 'hierarchical organization of cognitive processes in vision language models CogVision'
2026-01-02 12:51:27,114 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 6
2026-01-02 12:51:27,114 - query_agent - INFO - RAG Unique Doc 1:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_1
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:51:27,114 - query_agent - INFO - RAG Unique Doc 2:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_8
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:51:27,114 - query_agent - INFO - RAG Unique Doc 3:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_2
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:51:27,114 - query_agent - INFO - RAG Unique Doc 4:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_0
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:51:27,115 - query_agent - INFO - RAG Unique Doc 5:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_6
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:51:27,115 - query_agent - INFO - RAG Unique Doc 6:
  Source: attention_functional_roles_raw_chunks_2k.jsonl
  Chunk ID: attention_functional_roles_raw_chunks_2k_5
  Metadata: {'source': 'attention_functional_roles_raw.md'}
2026-01-02 12:51:27,115 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=6, total_chars=43317
2026-01-02 12:51:27,115 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:51:27,116 - query_agent - INFO - Graph Tool invoked with user query: How does the "CogVision" framework's probing methodology reveal the "hierarchical organization" of cognitive processes in VLMs?
2026-01-02 12:51:27,116 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:51:29,100 - query_agent - INFO - Resolving entities from graph for query: How does the "CogVision" framework's probing methodology reveal the "hierarchical organization" of cognitive processes in VLMs?
2026-01-02 12:51:29,276 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- cognitive processes (Concept)
- Human cognitive processes (Concept)
- CogVision (Dataset)
- Cognitive organization of VLMs (Concept)
- CogVision Dataset (Dataset)
2026-01-02 12:51:29,445 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:51:41,426 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Statement.CartesianProduct} {category: PERFORMANCE} {title: This query builds a cartesian product between disconnected patterns.} {description: If a part of a query contains multiple disconnected patterns, this will build a cartesian product between all those parts. This may produce a large amount of data and slow down query processing. While occasionally intended, it may often be possible to reformulate the query that avoids the use of this cross product, perhaps by adding a relationship between the different parts or by using OPTIONAL MATCH (identifier is: (c))} {position: line: 1, column: 1, offset: 0} for query: "MATCH (ds:Dataset {id: 'CogVision'}), (c:Concept {id: 'Cognitive organization of VLMs'})\nMATCH p = shortestPath((ds)-[*..4]-(c))\nRETURN p"
2026-01-02 12:51:45,038 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:51:45,039 - query_agent - INFO - MATCH (ds:Dataset {id: 'CogVision'}), (c:Concept {id: 'Cognitive organization of VLMs'})
MATCH p = shortestPath((ds)-[*..4]-(c))
RETURN p
2026-01-02 12:51:45,040 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[{'p': [{'id': 'CogVision'}, 'SUPPORTS', {'id': 'Cognitive organization of VLMs'}]}]
2026-01-02 12:51:45,263 - query_agent - INFO - Graph context returned to LLM:
Raw graph rows:
{'p': [{'id': 'CogVision'}, 'SUPPORTS', {'id': 'Cognitive organization of VLMs'}]}
2026-01-02 12:51:45,519 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:55:51,202 - __main__ - INFO - Processing query: Evaluate the "biologically plausible" claims of NAC in relation to the actual mechanisms of "synaptic transmission" and "neuronal dynamics".
2026-01-02 12:55:51,202 - __main__ - INFO - Invoking RAG retrieval tool...
2026-01-02 12:55:51,204 - query_agent - INFO - RAG Tool invoked with user query: Evaluate the "biologically plausible" claims of NAC in relation to the actual mechanisms of "synaptic transmission" and "neuronal dynamics".
2026-01-02 12:55:51,449 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-02 12:55:51,450 - query_agent - INFO - Generated 5 RAG subqueries:
2026-01-02 12:55:51,450 - query_agent - INFO -   Subquery 1: NAC biologically plausible claims
2026-01-02 12:55:51,450 - query_agent - INFO -   Subquery 2: synaptic transmission mechanisms
2026-01-02 12:55:51,451 - query_agent - INFO -   Subquery 3: neuronal dynamics and NAC
2026-01-02 12:55:51,451 - query_agent - INFO -   Subquery 4: biological plausibility of NAC in neural networks
2026-01-02 12:55:51,451 - query_agent - INFO -   Subquery 5: NAC and synaptic plasticity
2026-01-02 12:55:51,451 - query_agent - INFO - RAG internal retrieval query: NAC biologically plausible claims
2026-01-02 12:55:51,526 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC biologically plausible claims'
2026-01-02 12:55:51,526 - query_agent - INFO - RAG internal retrieval query: synaptic transmission mechanisms
2026-01-02 12:55:51,609 - query_agent - INFO - RAG retrieved 3 documents for subquery 'synaptic transmission mechanisms'
2026-01-02 12:55:51,609 - query_agent - INFO - RAG internal retrieval query: neuronal dynamics and NAC
2026-01-02 12:55:51,760 - query_agent - INFO - RAG retrieved 3 documents for subquery 'neuronal dynamics and NAC'
2026-01-02 12:55:51,760 - query_agent - INFO - RAG internal retrieval query: biological plausibility of NAC in neural networks
2026-01-02 12:55:51,849 - query_agent - INFO - RAG retrieved 3 documents for subquery 'biological plausibility of NAC in neural networks'
2026-01-02 12:55:51,849 - query_agent - INFO - RAG internal retrieval query: NAC and synaptic plasticity
2026-01-02 12:55:51,926 - query_agent - INFO - RAG retrieved 3 documents for subquery 'NAC and synaptic plasticity'
2026-01-02 12:55:51,927 - query_agent - INFO - Total unique documents after de-duplication across all subqueries: 7
2026-01-02 12:55:51,927 - query_agent - INFO - RAG Unique Doc 1:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_4
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:55:51,927 - query_agent - INFO - RAG Unique Doc 2:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_10
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:55:51,927 - query_agent - INFO - RAG Unique Doc 3:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_0
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:55:51,927 - query_agent - INFO - RAG Unique Doc 4:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_12
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:55:51,927 - query_agent - INFO - RAG Unique Doc 5:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_3
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:55:51,928 - query_agent - INFO - RAG Unique Doc 6:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_1
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:55:51,928 - query_agent - INFO - RAG Unique Doc 7:
  Source: neuronal_attention_circuits_raw_chunks_2k.jsonl
  Chunk ID: neuronal_attention_circuits_raw_chunks_2k_14
  Metadata: {'source': 'neuronal_attention_circuits_raw.md'}
2026-01-02 12:55:51,928 - query_agent - INFO - RAG context returned to LLM (multi-subquery, k=3, deduplicated): num_chunks=7, total_chars=43153
2026-01-02 12:55:51,928 - __main__ - INFO - Invoking Graph retrieval tool...
2026-01-02 12:55:51,929 - query_agent - INFO - Graph Tool invoked with user query: Evaluate the "biologically plausible" claims of NAC in relation to the actual mechanisms of "synaptic transmission" and "neuronal dynamics".
2026-01-02 12:55:51,929 - query_agent - INFO - Connecting to Neo4j at neo4j+s://d15b3f68.databases.neo4j.io...
2026-01-02 12:55:53,978 - query_agent - INFO - Resolving entities from graph for query: Evaluate the "biologically plausible" claims of NAC in relation to the actual mechanisms of "synaptic transmission" and "neuronal dynamics".
2026-01-02 12:55:54,144 - query_agent - INFO - Grounded entities to be provided to Cypher generator:
- Chain-of-of-thought (Concept)
- Out-of-Domain (Concept)
- Number of particles (Concept)
- Evaluation of Evidence (Concept)
- Chain-of-Thought (Concept)
2026-01-02 12:55:54,317 - query_agent - INFO - Initializing grounded GraphCypherQAChain...
2026-01-02 12:56:01,157 - query_agent - INFO - Generated Cypher query for graph retrieval:
2026-01-02 12:56:01,157 - query_agent - INFO - None
2026-01-02 12:56:01,159 - query_agent - INFO - Raw graph context rows returned from Neo4j:
[]
2026-01-02 12:56:01,159 - query_agent - INFO - Graph retrieval returned empty context; running fallback queries...
2026-01-02 12:56:02,062 - query_agent - INFO - Graph context returned to LLM:
Fallback graph context (LLM query returned empty rows):

Shortest paths (<=4 hops):
{'p': [{'id': 'Chain-of-of-thought'}, 'MENTIONS', {'derived_from_chunk_file': 'attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl', 'markdown_source': 'attention_functional_roles_raw_with_image_ids_with_captions.md', 'source_type': 'markdown', 'id': '475ee76307eeddcaaf3a61f94ac045af', 'text': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images', 'source_id': 'attention_functional_roles_raw_with_image_ids_with_captions.md::images'}, 'MENTIONS', {'id': 'Out-of-Domain'}]}

Neighborhood of Concept 'Chain-of-of-thought':
{'rel': 'MENTIONS', 'n_labels': ['Document'], 'n_id': '475ee76307eeddcaaf3a61f94ac045af'}
{'rel': 'DEPICTS', 'n_labels': ['Image'], 'n_id': 'img_attention_functional_roles_20_0'}

Images (from graph):
- img_attention_functional_roles_20_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-20-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_2 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-2.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_3 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-3.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_5 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-5.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_6 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-6.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_7 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-7.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_4 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-4.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_8 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-8.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_1_11 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-1-11.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_5_1 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-5-1.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_6_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-6-0.png | related_to=Chain-of-of-thought
- img_attention_functional_roles_7_0 | E:/Python Stuff/MAS-for-multimodal-knowledge-graph/markdown_outputs/images/attention_functional_roles.pdf-7-0.png | related_to=Chain-of-of-thought

Chunks (inferred from derived_from_chunk_file):
- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_0
  chunk_index: 0
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: ## - INVESTIGATING THE FUNCTIONAL ROLES OF ATTEN ### TION HEADS IN VISION LANGUAGE MODELS: EVI DENCE FOR REASONING MODULES

**Yanbei Jiang** **[1]** _[∗]_ **Xueqi Ma** **[1]** _[∗]_ **Shu Liu** **[1]** **Sarah Monazam Erfani** **[1]**

**Tongliang Liu** **[2]** **James Bailey** **[1]** **Jey Han Lau** **[1]** **Krista A. Ehinger** **[1]**

1The University of Melbourne 2The University of Sydney
_{_ yanbeij, xueqim, shu6 _}_ @student.unimelb.edu.au
_{_ sarah.erfani, baileyj, jeyhan.lau, kris.ehinger _}_ @unimelb.edu.au
tongliang.liu@sydney.edu.au


ABSTRACT


Despite excelling on multimodal benc…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_1
  chunk_index: 1
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: 2


example comprises a main question and answer, its subquestions and subanswers and an annotation
specifying the receptive or cognitive function required for each subquestion.


2.1 COGNITIVE FUNCTIONS


To systematically capture the cognitive processes involved in complex reasoning tasks, we consider eight functions related to complex multimodal reasoning. These functions are inspired by
established frameworks in cognitive science (Anderson, 2014; Diamond, 2013), which highlight the
importance of perception, working memory, and reasoning in human cognition.


The functions related to vision…

- attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl::attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_file: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_path: E:\Python Stuff\MAS-for-multimodal-knowledge-graph\chunking_outputs\attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k.jsonl
  chunk_id: attention_functional_roles_raw_with_image_ids_with_captions_chunks_5k_3
  chunk_index: 3
  metadata: {'source': 'attention_functional_roles_raw_with_image_ids_with_captions.md'}
  token_size_config: 5000
  resolved_via: derived_from_chunk_file + content_match
  excerpt: pendix A.11 shows that masking the **math reasoning** heads leads to errors in arithmetic tasks, while
visual receptive functions remain largely unaffected. This confirms that these cognitive heads are
crucial for specific functions and highlights the robustness and generalizability of our method.


**Positive Intervention:** We calculate the activation directions of different functions using the CogVision dataset. For each function, the activation direction of a head at layer _l_ and index _h_ is computed

as:
dir _[h]_ _l_ [=][ E] _[i][∈D]_ correct � _x_ _[h]_ _l_ [(] _[i]_ [)] � _−_ E _i∈D_…
2026-01-02 12:56:02,243 - __main__ - INFO - Synthesizing final answer from RAG and Graph contexts...
2026-01-02 12:56:13,688 - __main__ - INFO - Saved 60 results to E:\Python Stuff\MAS-for-multimodal-knowledge-graph\test\outputs\test_cases_20260102_125613.csv
